<!-- saved from url=(0014)about:internet -->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<title>DAE.as</title>
<link rel="stylesheet" type="text/css" href="../../../../../../SourceStyles.css"/>
</head>

<body><pre><span class="ActionScriptpackage">package</span> <span class="ActionScriptDefault_Text">org</span>.<span class="ActionScriptDefault_Text">papervision3d</span>.<span class="ActionScriptDefault_Text">objects</span>.<span class="ActionScriptDefault_Text">parsers</span>
<span class="ActionScriptBracket/Brace">{</span>
     <span class="ActionScriptReserved">import</span> <span class="ActionScriptDefault_Text">flash</span>.<span class="ActionScriptDefault_Text">events</span>.<span class="ActionScriptDefault_Text">Event</span>;
     <span class="ActionScriptReserved">import</span> <span class="ActionScriptDefault_Text">flash</span>.<span class="ActionScriptDefault_Text">events</span>.<span class="ActionScriptDefault_Text">ProgressEvent</span>;
     <span class="ActionScriptReserved">import</span> <span class="ActionScriptDefault_Text">flash</span>.<span class="ActionScriptDefault_Text">system</span>.<span class="ActionScriptDefault_Text">Capabilities</span>;
     <span class="ActionScriptReserved">import</span> <span class="ActionScriptDefault_Text">flash</span>.<span class="ActionScriptDefault_Text">utils</span>.<span class="ActionScriptDefault_Text">ByteArray</span>;
     <span class="ActionScriptReserved">import</span> <span class="ActionScriptDefault_Text">flash</span>.<span class="ActionScriptDefault_Text">utils</span>.<span class="ActionScriptDefault_Text">Dictionary</span>;
     <span class="ActionScriptReserved">import</span> <span class="ActionScriptDefault_Text">flash</span>.<span class="ActionScriptDefault_Text">utils</span>.<span class="ActionScriptDefault_Text">getTimer</span>;
     
     <span class="ActionScriptReserved">import</span> <span class="ActionScriptDefault_Text">org</span>.<span class="ActionScriptDefault_Text">ascollada</span>.<span class="ActionScriptDefault_Text">ASCollada</span>;
     <span class="ActionScriptReserved">import</span> <span class="ActionScriptDefault_Text">org</span>.<span class="ActionScriptDefault_Text">ascollada</span>.<span class="ActionScriptDefault_Text">core</span>.<span class="ActionScriptOperator">*</span>;
     <span class="ActionScriptReserved">import</span> <span class="ActionScriptDefault_Text">org</span>.<span class="ActionScriptDefault_Text">ascollada</span>.<span class="ActionScriptDefault_Text">fx</span>.<span class="ActionScriptOperator">*</span>;
     <span class="ActionScriptReserved">import</span> <span class="ActionScriptDefault_Text">org</span>.<span class="ActionScriptDefault_Text">ascollada</span>.<span class="ActionScriptDefault_Text">io</span>.<span class="ActionScriptDefault_Text">DaeReader</span>;
     <span class="ActionScriptReserved">import</span> <span class="ActionScriptDefault_Text">org</span>.<span class="ActionScriptDefault_Text">ascollada</span>.<span class="ActionScriptDefault_Text">namespaces</span>.<span class="ActionScriptOperator">*</span>;
     <span class="ActionScriptReserved">import</span> <span class="ActionScriptDefault_Text">org</span>.<span class="ActionScriptDefault_Text">ascollada</span>.<span class="ActionScriptDefault_Text">types</span>.<span class="ActionScriptOperator">*</span>;
     <span class="ActionScriptReserved">import</span> <span class="ActionScriptDefault_Text">org</span>.<span class="ActionScriptDefault_Text">papervision3d</span>.<span class="ActionScriptDefault_Text">Papervision3D</span>;
     <span class="ActionScriptReserved">import</span> <span class="ActionScriptDefault_Text">org</span>.<span class="ActionScriptDefault_Text">papervision3d</span>.<span class="ActionScriptDefault_Text">core</span>.<span class="ActionScriptDefault_Text">animation</span>.<span class="ActionScriptOperator">*</span>;
     <span class="ActionScriptReserved">import</span> <span class="ActionScriptDefault_Text">org</span>.<span class="ActionScriptDefault_Text">papervision3d</span>.<span class="ActionScriptDefault_Text">core</span>.<span class="ActionScriptDefault_Text">animation</span>.<span class="ActionScriptDefault_Text">channel</span>.<span class="ActionScriptOperator">*</span>;
     <span class="ActionScriptReserved">import</span> <span class="ActionScriptDefault_Text">org</span>.<span class="ActionScriptDefault_Text">papervision3d</span>.<span class="ActionScriptDefault_Text">core</span>.<span class="ActionScriptDefault_Text">controller</span>.<span class="ActionScriptDefault_Text">IObjectController</span>;
     <span class="ActionScriptReserved">import</span> <span class="ActionScriptDefault_Text">org</span>.<span class="ActionScriptDefault_Text">papervision3d</span>.<span class="ActionScriptDefault_Text">core</span>.<span class="ActionScriptDefault_Text">controller</span>.<span class="ActionScriptDefault_Text">SkinController</span>;
     <span class="ActionScriptReserved">import</span> <span class="ActionScriptDefault_Text">org</span>.<span class="ActionScriptDefault_Text">papervision3d</span>.<span class="ActionScriptDefault_Text">core</span>.<span class="ActionScriptDefault_Text">geom</span>.<span class="ActionScriptOperator">*</span>;
     <span class="ActionScriptReserved">import</span> <span class="ActionScriptDefault_Text">org</span>.<span class="ActionScriptDefault_Text">papervision3d</span>.<span class="ActionScriptDefault_Text">core</span>.<span class="ActionScriptDefault_Text">geom</span>.<span class="ActionScriptDefault_Text">renderables</span>.<span class="ActionScriptOperator">*</span>;
     <span class="ActionScriptReserved">import</span> <span class="ActionScriptDefault_Text">org</span>.<span class="ActionScriptDefault_Text">papervision3d</span>.<span class="ActionScriptDefault_Text">core</span>.<span class="ActionScriptDefault_Text">log</span>.<span class="ActionScriptDefault_Text">PaperLogger</span>;
     <span class="ActionScriptReserved">import</span> <span class="ActionScriptDefault_Text">org</span>.<span class="ActionScriptDefault_Text">papervision3d</span>.<span class="ActionScriptDefault_Text">core</span>.<span class="ActionScriptDefault_Text">material</span>.<span class="ActionScriptDefault_Text">AbstractLightShadeMaterial</span>;
     <span class="ActionScriptReserved">import</span> <span class="ActionScriptDefault_Text">org</span>.<span class="ActionScriptDefault_Text">papervision3d</span>.<span class="ActionScriptDefault_Text">core</span>.<span class="ActionScriptDefault_Text">math</span>.<span class="ActionScriptOperator">*</span>;
     <span class="ActionScriptReserved">import</span> <span class="ActionScriptDefault_Text">org</span>.<span class="ActionScriptDefault_Text">papervision3d</span>.<span class="ActionScriptDefault_Text">core</span>.<span class="ActionScriptDefault_Text">proto</span>.<span class="ActionScriptOperator">*</span>;
     <span class="ActionScriptReserved">import</span> <span class="ActionScriptDefault_Text">org</span>.<span class="ActionScriptDefault_Text">papervision3d</span>.<span class="ActionScriptDefault_Text">core</span>.<span class="ActionScriptDefault_Text">render</span>.<span class="ActionScriptDefault_Text">data</span>.<span class="ActionScriptDefault_Text">RenderSessionData</span>;
     <span class="ActionScriptReserved">import</span> <span class="ActionScriptDefault_Text">org</span>.<span class="ActionScriptDefault_Text">papervision3d</span>.<span class="ActionScriptDefault_Text">events</span>.<span class="ActionScriptDefault_Text">AnimationEvent</span>;
     <span class="ActionScriptReserved">import</span> <span class="ActionScriptDefault_Text">org</span>.<span class="ActionScriptDefault_Text">papervision3d</span>.<span class="ActionScriptDefault_Text">events</span>.<span class="ActionScriptDefault_Text">FileLoadEvent</span>;
     <span class="ActionScriptReserved">import</span> <span class="ActionScriptDefault_Text">org</span>.<span class="ActionScriptDefault_Text">papervision3d</span>.<span class="ActionScriptDefault_Text">materials</span>.<span class="ActionScriptOperator">*</span>;
     <span class="ActionScriptReserved">import</span> <span class="ActionScriptDefault_Text">org</span>.<span class="ActionScriptDefault_Text">papervision3d</span>.<span class="ActionScriptDefault_Text">materials</span>.<span class="ActionScriptDefault_Text">shaders</span>.<span class="ActionScriptDefault_Text">ShadedMaterial</span>;
     <span class="ActionScriptReserved">import</span> <span class="ActionScriptDefault_Text">org</span>.<span class="ActionScriptDefault_Text">papervision3d</span>.<span class="ActionScriptDefault_Text">materials</span>.<span class="ActionScriptDefault_Text">special</span>.<span class="ActionScriptOperator">*</span>;
     <span class="ActionScriptReserved">import</span> <span class="ActionScriptDefault_Text">org</span>.<span class="ActionScriptDefault_Text">papervision3d</span>.<span class="ActionScriptDefault_Text">materials</span>.<span class="ActionScriptDefault_Text">utils</span>.<span class="ActionScriptOperator">*</span>;
     <span class="ActionScriptReserved">import</span> <span class="ActionScriptDefault_Text">org</span>.<span class="ActionScriptDefault_Text">papervision3d</span>.<span class="ActionScriptDefault_Text">objects</span>.<span class="ActionScriptDefault_Text">DisplayObject3D</span>;
     <span class="ActionScriptReserved">import</span> <span class="ActionScriptDefault_Text">org</span>.<span class="ActionScriptDefault_Text">papervision3d</span>.<span class="ActionScriptDefault_Text">objects</span>.<span class="ActionScriptDefault_Text">special</span>.<span class="ActionScriptDefault_Text">Skin3D</span>;
    
    <span class="ActionScriptASDoc">/**
     * The DAE class represents a parsed COLLADA 1.4.1 file.
     * 
     * &lt;p&gt;Typical use case:&lt;/p&gt;
     * &lt;pre&gt;
     * var dae :DAE = new DAE();
     * 
     * dae.addEventListener(FileLoadEvent.LOAD_COMPLETE, myOnLoadCompleteHandler);
     * 
     * dae.load( &quot;path/to/collada&quot; );
     * &lt;/pre&gt;
     * 
     * &lt;p&gt;Its possible to pass you own materials via a MaterialsList:&lt;/p&gt;
     * &lt;pre&gt;
     * var materials :MaterialsList = new MaterialsList();
     * 
     * materials.addMaterial( new ColorMaterial(), &quot;MyMaterial&quot; );
     * 
     * var dae :DAE = new DAE();
     * 
     * dae.addEventListener(FileLoadEvent.LOAD_COMPLETE, myOnLoadCompleteHandler);
     * 
     * dae.load( &quot;path/to/collada&quot;, materials );
     * &lt;/pre&gt;
     * &lt;p&gt;Note that in above case you need the material names as specified in your 3D modelling application.
     * The material names can also be found by looking at the COLLADA file: find the xml elements 
     * &amp;lt;instance_material symbol=&quot;MyMaterialName&quot; target=&quot;SomeTarget&quot; /&amp;gt;. The material names are specified
     * by the symbol attribute of this element.&lt;/p&gt;
     * 
     * &lt;p&gt;A COLLADA file can contain animations. Animations take a long time to parse, hence 
     * animations are parsed asynchroniously. Listen for FileLoadEvent.ANIMATIONS_COMPLETE and 
     * FileLoadEvent.ANIMATIONS_PROGRESS:&lt;/p&gt;
     * &lt;pre&gt;
     * var dae :DAE = new DAE();
     * 
     * dae.addEventListener(FileLoadEvent.LOAD_COMPLETE, myOnLoadCompleteHandler);
     * dae.addEventListener(FileLoadEvent.ANIMATIONS_COMPLETE, myOnAnimationsCompleteHandler);
     * dae.addEventListener(FileLoadEvent.ANIMATIONS_PROGRESS, myOnAnimationsProgressHandler);
     * 
     * dae.load( &quot;path/to/collada&quot; );
     * &lt;/pre&gt;
     * 
     * @author Tim Knip
     */</span> 
    <span class="ActionScriptReserved">public</span> <span class="ActionScriptclass">class</span> <span class="ActionScriptDefault_Text">DAE</span> <span class="ActionScriptReserved">extends</span> <span class="ActionScriptDefault_Text">DisplayObject3D</span> <span class="ActionScriptReserved">implements</span> <span class="ActionScriptDefault_Text">IAnimationDataProvider</span>, <span class="ActionScriptDefault_Text">IAnimatable</span>
    <span class="ActionScriptBracket/Brace">{</span>
        <span class="ActionScriptReserved">use</span> <span class="ActionScriptReserved">namespace</span> <span class="ActionScriptDefault_Text">collada</span>;
        
        <span class="ActionScriptReserved">public</span> <span class="ActionScriptReserved">static</span> <span class="ActionScriptReserved">const</span> <span class="ActionScriptDefault_Text">ROOTNODE_NAME</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">String</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptString">&quot;COLLADA_Scene&quot;</span>;
        
        <span class="ActionScriptASDoc">/** Defines wether to set materials by target id or name - Might fix C4D**/</span>
        <span class="ActionScriptReserved">public</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">useMaterialTargetName</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">Boolean</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">false</span>;
        
        <span class="ActionScriptASDoc">/** Default line color for splines. */</span>
        <span class="ActionScriptReserved">public</span> <span class="ActionScriptReserved">static</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">DEFAULT_LINE_COLOR</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">uint</span> <span class="ActionScriptOperator">=</span> 0<span class="ActionScriptDefault_Text">xffff00</span>;
        
        <span class="ActionScriptASDoc">/** Default line width for splines */</span>
        <span class="ActionScriptReserved">public</span> <span class="ActionScriptReserved">static</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">DEFAULT_LINE_WIDTH</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">Number</span> <span class="ActionScriptOperator">=</span> 0;
        
        <span class="ActionScriptASDoc">/** Alternative file-extension for TGA images. Default is &quot;png&quot;. */</span>
        <span class="ActionScriptReserved">public</span> <span class="ActionScriptReserved">static</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">DEFAULT_TGA_ALTERNATIVE</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">String</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptString">&quot;png&quot;</span>;
        
        
        <span class="ActionScriptASDoc">/** change this to 0 if you&apos;re DAE is picking the wrong coordinates */</span>
        
        <span class="ActionScriptReserved">public</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">forceCoordSet</span> <span class="ActionScriptOperator">:</span> <span class="ActionScriptDefault_Text">int</span> <span class="ActionScriptOperator">=</span> 0;
        
        <span class="ActionScriptASDoc">/** The loaded XML. */</span>
        <span class="ActionScriptReserved">public</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">COLLADA</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">XML</span>;
    
        <span class="ActionScriptASDoc">/** The filename - if applicable. */</span>
        <span class="ActionScriptReserved">public</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">filename</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">String</span>;
        
        <span class="ActionScriptASDoc">/** The filetitle - if applicable. */</span>
        <span class="ActionScriptReserved">public</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">fileTitle</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">String</span>;
        
        <span class="ActionScriptASDoc">/** Base url. */</span>
        <span class="ActionScriptReserved">public</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">baseUrl</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">String</span>;
        
        <span class="ActionScriptASDoc">/** Path where the textures should be loaded from. */</span>
        <span class="ActionScriptReserved">public</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">texturePath</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">String</span>;
        
        <span class="ActionScriptASDoc">/** The COLLADA parser. */</span>
        <span class="ActionScriptReserved">public</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">parser</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">DaeReader</span>;
        
        <span class="ActionScriptASDoc">/** The DaeDocument. @see org.ascollada.core.DaeDocument */</span>
        <span class="ActionScriptReserved">public</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">document</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">DaeDocument</span>;
            
        <span class="ActionScriptASDoc">/** */</span>
        <span class="ActionScriptReserved">protected</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">_colladaID</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">Dictionary</span>;
        
        <span class="ActionScriptASDoc">/** */</span>
        <span class="ActionScriptReserved">protected</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">_colladaSID</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">Dictionary</span>;
        
        <span class="ActionScriptASDoc">/** */</span>
        <span class="ActionScriptReserved">protected</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">_colladaIDToObject</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">Object</span>;
        
        <span class="ActionScriptASDoc">/** */</span>
        <span class="ActionScriptReserved">protected</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">_colladaSIDToObject</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">Object</span>;
        
        <span class="ActionScriptASDoc">/** */</span>
        <span class="ActionScriptReserved">protected</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">_objectToNode</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">Object</span>;
        
        <span class="ActionScriptASDoc">/** */</span>
        <span class="ActionScriptReserved">protected</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">_channelsByTarget</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">Dictionary</span>;
        
        <span class="ActionScriptASDoc">/** */</span>
        <span class="ActionScriptReserved">protected</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">_geometries</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">Object</span>;
        
        <span class="ActionScriptASDoc">/** */</span>
        <span class="ActionScriptReserved">protected</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">_queuedMaterials</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">Array</span>;
        
        <span class="ActionScriptASDoc">/** */</span>
        <span class="ActionScriptReserved">protected</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">_textureSets</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">Object</span>;
        
        <span class="ActionScriptASDoc">/** */</span>
        <span class="ActionScriptReserved">protected</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">_channels</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">Array</span>;
        
        <span class="ActionScriptASDoc">/** */</span>
        <span class="ActionScriptReserved">protected</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">_skins</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">Dictionary</span>;
        
        <span class="ActionScriptASDoc">/** */</span>
        <span class="ActionScriptReserved">protected</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">_numSkins</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">uint</span>;
        
        <span class="ActionScriptASDoc">/** */</span>
        <span class="ActionScriptReserved">protected</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">_rootNode</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">DisplayObject3D</span>;
        
        <span class="ActionScriptASDoc">/** */</span>
        <span class="ActionScriptReserved">protected</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">_currentFrame</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">int</span> <span class="ActionScriptOperator">=</span> 0;
        
        <span class="ActionScriptASDoc">/** */</span>
        <span class="ActionScriptReserved">protected</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">_currentTime</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">int</span>;
        
        <span class="ActionScriptASDoc">/** */</span>
        <span class="ActionScriptReserved">protected</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">_totalFrames</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">int</span> <span class="ActionScriptOperator">=</span> 0;
        
        <span class="ActionScriptASDoc">/** */</span>
        <span class="ActionScriptReserved">protected</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">_startTime</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">Number</span>;
        
        <span class="ActionScriptASDoc">/** */</span>
        <span class="ActionScriptReserved">protected</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">_endTime</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">Number</span>;
        
        <span class="ActionScriptASDoc">/** */</span>
        <span class="ActionScriptReserved">protected</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">_isAnimated</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">Boolean</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">false</span>;
        
        <span class="ActionScriptASDoc">/** */</span>
        <span class="ActionScriptReserved">protected</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">_isPlaying</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">Boolean</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">false</span>;
        
        <span class="ActionScriptASDoc">/** */</span>
        <span class="ActionScriptReserved">protected</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">_autoPlay</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">Boolean</span>;
        
        <span class="ActionScriptASDoc">/** */</span>
        <span class="ActionScriptReserved">protected</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">_rightHanded</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">Boolean</span>;
        
        <span class="ActionScriptASDoc">/** */</span>
        <span class="ActionScriptReserved">protected</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">_controllers</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">Array</span>; 
        
        <span class="ActionScriptReserved">protected</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">_playerType</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">String</span>;
        
        <span class="ActionScriptReserved">protected</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">_loop</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">Boolean</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">false</span>;
        
        <span class="ActionScriptReserved">protected</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">_bindVertexInputs</span> <span class="ActionScriptOperator">:</span> <span class="ActionScriptDefault_Text">Dictionary</span>;
        
        
        
        <span class="ActionScriptASDoc">/**
         * Constructor.
         * 
         * @param    autoPlay    Whether to start the animation automatically.
         * @param    name    Optional name for the DAE.
         */</span> 
        <span class="ActionScriptReserved">public</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">DAE</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">autoPlay</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">Boolean</span><span class="ActionScriptOperator">=</span><span class="ActionScriptReserved">true</span>, <span class="ActionScriptDefault_Text">name</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">String</span><span class="ActionScriptOperator">=</span><span class="ActionScriptReserved">null</span>, <span class="ActionScriptDefault_Text">loop</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">Boolean</span><span class="ActionScriptOperator">=</span><span class="ActionScriptReserved">false</span><span class="ActionScriptBracket/Brace">)</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptReserved">super</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">name</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptDefault_Text">_autoPlay</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">autoPlay</span>;
            <span class="ActionScriptDefault_Text">_rightHanded</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">Papervision3D</span>.<span class="ActionScriptDefault_Text">useRIGHTHANDED</span>;
            <span class="ActionScriptDefault_Text">_loop</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">loop</span>;
            <span class="ActionScriptDefault_Text">_playerType</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">Capabilities</span>.<span class="ActionScriptDefault_Text">playerType</span>;
        <span class="ActionScriptBracket/Brace">}</span>
        
        <span class="ActionScriptASDoc">/**
         * Plays the animation.
         * 
         * @param     clip    Optional clip name.
         */</span> 
        <span class="ActionScriptReserved">public</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">play</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">clip</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">String</span><span class="ActionScriptOperator">=</span><span class="ActionScriptReserved">null</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">:</span><span class="ActionScriptReserved">void</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptDefault_Text">_currentFrame</span> <span class="ActionScriptOperator">=</span> 0;
            <span class="ActionScriptDefault_Text">_currentTime</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">getTimer</span><span class="ActionScriptBracket/Brace">()</span>;
            <span class="ActionScriptDefault_Text">_isPlaying</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">_isAnimated</span> <span class="ActionScriptOperator">&amp;&amp;</span> <span class="ActionScriptDefault_Text">_channels</span> <span class="ActionScriptOperator">&amp;&amp;</span> <span class="ActionScriptDefault_Text">_channels</span>.<span class="ActionScriptDefault_Text">length</span><span class="ActionScriptBracket/Brace">)</span>;
        <span class="ActionScriptBracket/Brace">}</span>
        
        <span class="ActionScriptASDoc">/**
         * Stops the animation.
         */</span> 
        <span class="ActionScriptReserved">public</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">stop</span><span class="ActionScriptBracket/Brace">()</span><span class="ActionScriptOperator">:</span><span class="ActionScriptReserved">void</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScripttrace">trace</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">&quot;STOP CALLED ON DAE&quot;</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptDefault_Text">_isPlaying</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">false</span>;    
            <span class="ActionScriptDefault_Text">dispatchEvent</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">AnimationEvent</span><span class="ActionScriptBracket/Brace">(A</span><span class="ActionScriptDefault_Text">nimationEvent</span>.<span class="ActionScriptDefault_Text">ANIMATION_COMPLETE</span>, <span class="ActionScriptDefault_Text">_currentFrame</span>, <span class="ActionScriptDefault_Text">_totalFrames</span><span class="ActionScriptBracket/Brace">))</span>;
        <span class="ActionScriptBracket/Brace">}</span>
        
        
        <span class="ActionScriptASDoc">/**
         * Gets the default FPS.
         */</span> 
        <span class="ActionScriptReserved">public</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptReserved">get</span> <span class="ActionScriptDefault_Text">fps</span><span class="ActionScriptBracket/Brace">()</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">uint</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptReserved">return</span> 20;
        <span class="ActionScriptBracket/Brace">}</span>
        
        <span class="ActionScriptASDoc">/**
         * Gets a animation channel by its name.
         * 
         * @param    name
         * 
         * @return the found channel.
         */</span> 
        <span class="ActionScriptReserved">public</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">getAnimationChannelByName</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">name</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">String</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">AbstractChannel3D</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptReserved">return</span> <span class="ActionScriptReserved">null</span>;    
        <span class="ActionScriptBracket/Brace">}</span>
        
        <span class="ActionScriptASDoc">/**
         * Gets all animation channels for a target. 
         * &lt;p&gt;NOTE: when target is null, all channels for this object are returned.&lt;/p&gt;
         * 
         * @param    target    The target to get the channels for.
         * 
         * @return    Array of AnimationChannel3D.
         */</span> 
        <span class="ActionScriptReserved">public</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">getAnimationChannels</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">target</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">DisplayObject3D</span><span class="ActionScriptOperator">=</span><span class="ActionScriptReserved">null</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">Array</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">channels</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">Array</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">Array</span><span class="ActionScriptBracket/Brace">()</span>;
            <span class="ActionScriptReserved">if</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">target</span> <span class="ActionScriptOperator">==</span> <span class="ActionScriptReserved">null</span><span class="ActionScriptBracket/Brace">)</span>
            <span class="ActionScriptBracket/Brace">{</span>
                <span class="ActionScriptReserved">for</span> <span class="ActionScriptReserved">each</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">array</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">Array</span> <span class="ActionScriptReserved">in</span> <span class="ActionScriptDefault_Text">_channelsByTarget</span><span class="ActionScriptBracket/Brace">)</span>
                    <span class="ActionScriptDefault_Text">channels</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">channels</span>.<span class="ActionScriptDefault_Text">concat</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">array</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptBracket/Brace">}</span>
            <span class="ActionScriptReserved">else</span> <span class="ActionScriptReserved">if</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">_channelsByTarget</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">target</span><span class="ActionScriptBracket/Brace">])</span>
            <span class="ActionScriptBracket/Brace">{</span>
                <span class="ActionScriptDefault_Text">channels</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">channels</span>.<span class="ActionScriptDefault_Text">concat</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">_channelsByTarget</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">target</span><span class="ActionScriptBracket/Brace">])</span>;
            <span class="ActionScriptBracket/Brace">}</span>
            <span class="ActionScriptReserved">else</span>
                <span class="ActionScriptReserved">return</span> <span class="ActionScriptReserved">null</span>;
                    
            <span class="ActionScriptReserved">return</span> <span class="ActionScriptDefault_Text">channels</span>;
        <span class="ActionScriptBracket/Brace">}</span>
        
        <span class="ActionScriptASDoc">/**
         * Gets animation channels by clip name.
         * 
         * @param    name    The clip name
         * 
         * @return    Array of AnimationChannel3D.
         */</span> 
        <span class="ActionScriptReserved">public</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">getAnimationChannelsByClip</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">name</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">String</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">Array</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptReserved">return</span> <span class="ActionScriptReserved">null</span>;    
        <span class="ActionScriptBracket/Brace">}</span>
        
        <span class="ActionScriptASDoc">/**
         * Loads the COLLADA.
         * 
         * @param    asset The url, an XML object or a ByteArray specifying the COLLADA file.
         * @param    materials    An optional materialsList.
         */</span> 
        <span class="ActionScriptReserved">public</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">load</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">asset</span><span class="ActionScriptOperator">:*</span>, <span class="ActionScriptDefault_Text">materials</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">MaterialsList</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">null</span>, <span class="ActionScriptDefault_Text">asynchronousParsing</span> <span class="ActionScriptOperator">:</span> <span class="ActionScriptDefault_Text">Boolean</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">false</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">:</span><span class="ActionScriptReserved">void</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptReserved">this</span>.<span class="ActionScriptDefault_Text">materials</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">materials</span> <span class="ActionScriptOperator">||</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">MaterialsList</span><span class="ActionScriptBracket/Brace">()</span>;
            
            <span class="ActionScriptDefault_Text">buildFileInfo</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">asset</span><span class="ActionScriptBracket/Brace">)</span>;
            
            <span class="ActionScriptDefault_Text">_bindVertexInputs</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">Dictionary</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptReserved">true</span><span class="ActionScriptBracket/Brace">)</span>;
            
            <span class="ActionScriptReserved">this</span>.<span class="ActionScriptDefault_Text">parser</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">DaeReader</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">asynchronousParsing</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptReserved">this</span>.<span class="ActionScriptDefault_Text">parser</span>.<span class="ActionScriptDefault_Text">addEventListener</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">Event</span>.<span class="ActionScriptDefault_Text">COMPLETE</span>, <span class="ActionScriptDefault_Text">onParseComplete</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptReserved">this</span>.<span class="ActionScriptDefault_Text">parser</span>.<span class="ActionScriptDefault_Text">addEventListener</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">ProgressEvent</span>.<span class="ActionScriptDefault_Text">PROGRESS</span>, <span class="ActionScriptDefault_Text">onParseProgress</span><span class="ActionScriptBracket/Brace">)</span>;
            
            <span class="ActionScriptReserved">if</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">asset</span> <span class="ActionScriptReserved">is</span> <span class="ActionScriptDefault_Text">XML</span><span class="ActionScriptBracket/Brace">)</span>
            <span class="ActionScriptBracket/Brace">{</span>
                <span class="ActionScriptReserved">this</span>.<span class="ActionScriptDefault_Text">COLLADA</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">asset</span> <span class="ActionScriptReserved">as</span> <span class="ActionScriptDefault_Text">XML</span>;
                <span class="ActionScriptReserved">this</span>.<span class="ActionScriptDefault_Text">parser</span>.<span class="ActionScriptDefault_Text">loadDocument</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">asset</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptBracket/Brace">}</span>
            <span class="ActionScriptReserved">else</span> <span class="ActionScriptReserved">if</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">asset</span> <span class="ActionScriptReserved">is</span> <span class="ActionScriptDefault_Text">ByteArray</span><span class="ActionScriptBracket/Brace">)</span>
            <span class="ActionScriptBracket/Brace">{</span>
                <span class="ActionScriptReserved">this</span>.<span class="ActionScriptDefault_Text">COLLADA</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">XML</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">ByteArray</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">asset</span><span class="ActionScriptBracket/Brace">))</span>;
                <span class="ActionScriptReserved">this</span>.<span class="ActionScriptDefault_Text">parser</span>.<span class="ActionScriptDefault_Text">loadDocument</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">asset</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptBracket/Brace">}</span>
            <span class="ActionScriptReserved">else</span> <span class="ActionScriptReserved">if</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">asset</span> <span class="ActionScriptReserved">is</span> <span class="ActionScriptDefault_Text">String</span><span class="ActionScriptBracket/Brace">)</span>
            <span class="ActionScriptBracket/Brace">{</span>
                <span class="ActionScriptReserved">this</span>.<span class="ActionScriptDefault_Text">filename</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">String</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">asset</span><span class="ActionScriptBracket/Brace">)</span>;
                <span class="ActionScriptReserved">this</span>.<span class="ActionScriptDefault_Text">parser</span>.<span class="ActionScriptDefault_Text">read</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptReserved">this</span>.<span class="ActionScriptDefault_Text">filename</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptBracket/Brace">}</span>
            <span class="ActionScriptReserved">else</span>
            <span class="ActionScriptBracket/Brace">{</span>
                <span class="ActionScriptReserved">throw</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">Error</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">&quot;load : unknown asset type!&quot;</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptBracket/Brace">}</span>
        <span class="ActionScriptBracket/Brace">}</span>
        
        <span class="ActionScriptASDoc">/**
         * Removes a child.
         * 
         * @param    child    The child to remove
         * 
         * @return    The removed child
         */</span> 
        <span class="ActionScriptReserved">override</span> <span class="ActionScriptReserved">public</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">removeChild</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">child</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">DisplayObject3D</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">DisplayObject3D</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">object</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">DisplayObject3D</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">getChildByName</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">child</span>.<span class="ActionScriptDefault_Text">name</span>, <span class="ActionScriptReserved">true</span><span class="ActionScriptBracket/Brace">)</span>;
            
            <span class="ActionScriptReserved">if</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">object</span><span class="ActionScriptBracket/Brace">)</span>
            <span class="ActionScriptBracket/Brace">{</span>
                <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">parent</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">DisplayObject3D</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">DisplayObject3D</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">object</span>.<span class="ActionScriptDefault_Text">parent</span><span class="ActionScriptBracket/Brace">)</span>;
                <span class="ActionScriptReserved">if</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">parent</span><span class="ActionScriptBracket/Brace">)</span>
                <span class="ActionScriptBracket/Brace">{</span>
                    <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">removed</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">DisplayObject3D</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">parent</span>.<span class="ActionScriptDefault_Text">removeChild</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">object</span><span class="ActionScriptBracket/Brace">)</span>;
                    <span class="ActionScriptReserved">if</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">removed</span><span class="ActionScriptBracket/Brace">)</span>
                        <span class="ActionScriptReserved">return</span> <span class="ActionScriptDefault_Text">removed</span>;
                <span class="ActionScriptBracket/Brace">}</span>
            <span class="ActionScriptBracket/Brace">}</span>
            <span class="ActionScriptReserved">return</span> <span class="ActionScriptReserved">null</span>;    
        <span class="ActionScriptBracket/Brace">}</span>
        
        
        
        <span class="ActionScriptASDoc">/**
         * Project.
         * 
         * @param    parent
         * @param    renderSessionData
         * 
         * @return    Number
         */</span> 
        <span class="ActionScriptReserved">public</span> <span class="ActionScriptReserved">override</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">project</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">parent</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">DisplayObject3D</span>, <span class="ActionScriptDefault_Text">renderSessionData</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">RenderSessionData</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">Number</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptComment">// update controllers
</span>            <span class="ActionScriptReserved">for</span> <span class="ActionScriptReserved">each</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">controller</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">IObjectController</span> <span class="ActionScriptReserved">in</span> <span class="ActionScriptDefault_Text">_controllers</span><span class="ActionScriptBracket/Brace">)</span>
            <span class="ActionScriptBracket/Brace">{</span>
                <span class="ActionScriptDefault_Text">controller</span>.<span class="ActionScriptDefault_Text">update</span><span class="ActionScriptBracket/Brace">()</span>;
            <span class="ActionScriptBracket/Brace">}</span>
            
            <span class="ActionScriptComment">// update animation
</span>            <span class="ActionScriptReserved">if</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">_isPlaying</span> <span class="ActionScriptOperator">&amp;&amp;</span> <span class="ActionScriptDefault_Text">_channels</span><span class="ActionScriptBracket/Brace">)</span>
            <span class="ActionScriptBracket/Brace">{</span>
                <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">secs</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">Number</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">_currentTime</span> <span class="ActionScriptOperator">/</span> 1000;
                <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">duration</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">Number</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">_endTime</span> <span class="ActionScriptOperator">-</span> <span class="ActionScriptDefault_Text">_startTime</span>;
                <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">elapsed</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">Number</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">getTimer</span><span class="ActionScriptBracket/Brace">()</span><span class="ActionScriptOperator">/</span>1000<span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptOperator">-</span> <span class="ActionScriptDefault_Text">secs</span>;
                
                <span class="ActionScriptReserved">if</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">elapsed</span> <span class="ActionScriptOperator">&gt;</span> <span class="ActionScriptDefault_Text">duration</span><span class="ActionScriptBracket/Brace">)</span>
                <span class="ActionScriptBracket/Brace">{</span>
                    <span class="ActionScriptDefault_Text">_currentTime</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">getTimer</span><span class="ActionScriptBracket/Brace">()</span>;
                    <span class="ActionScriptDefault_Text">secs</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">_currentTime</span> <span class="ActionScriptOperator">/</span> 1000;
                    <span class="ActionScriptDefault_Text">elapsed</span> <span class="ActionScriptOperator">=</span> 0;
                <span class="ActionScriptBracket/Brace">}</span>
                <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">time</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">Number</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">elapsed</span> <span class="ActionScriptOperator">/</span> <span class="ActionScriptDefault_Text">duration</span>;

                <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">time</span> <span class="ActionScriptOperator">==</span> 0 <span class="ActionScriptOperator">&amp;&amp;</span> <span class="ActionScriptOperator">!</span><span class="ActionScriptDefault_Text">_loop</span><span class="ActionScriptBracket/Brace">)</span>
                    <span class="ActionScriptDefault_Text">stop</span><span class="ActionScriptBracket/Brace">()</span>;
                <span class="ActionScriptReserved">else</span>
                <span class="ActionScriptBracket/Brace">{</span>
                    <span class="ActionScriptReserved">for</span> <span class="ActionScriptReserved">each</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">channel</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">AbstractChannel3D</span> <span class="ActionScriptReserved">in</span> <span class="ActionScriptDefault_Text">_channels</span><span class="ActionScriptBracket/Brace">)</span>
                        <span class="ActionScriptDefault_Text">channel</span>.<span class="ActionScriptDefault_Text">updateToTime</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">time</span><span class="ActionScriptBracket/Brace">)</span>;
                <span class="ActionScriptBracket/Brace">}</span>
            <span class="ActionScriptBracket/Brace">}</span>

            <span class="ActionScriptReserved">return</span> <span class="ActionScriptReserved">super</span>.<span class="ActionScriptDefault_Text">project</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">parent</span>, <span class="ActionScriptDefault_Text">renderSessionData</span><span class="ActionScriptBracket/Brace">)</span>;    
        <span class="ActionScriptBracket/Brace">}</span>
        
        <span class="ActionScriptASDoc">/**
         * Builds a animation channel for an object.
         * 
         * @param    matrixStackChannel    the target object&apos;s channel
         * @param    target    The target object
         * @param    channel    The DaeChannel
         */</span> 
        <span class="ActionScriptReserved">protected</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">buildAnimationChannel</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">target</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">DisplayObject3D</span>, <span class="ActionScriptDefault_Text">channel</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">DaeChannel</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">MatrixChannel3D</span>
        <span class="ActionScriptBracket/Brace">{</span>                
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">node</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">DaeNode</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">_objectToNode</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">target</span><span class="ActionScriptBracket/Brace">]</span>;
                    
            <span class="ActionScriptReserved">if</span><span class="ActionScriptBracket/Brace">(!</span><span class="ActionScriptDefault_Text">node</span><span class="ActionScriptBracket/Brace">)</span>
                <span class="ActionScriptReserved">throw</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">Error</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">&quot;Couldn&apos;t find the targeted object!&quot;</span><span class="ActionScriptBracket/Brace">)</span>;
                    
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">matrixChannel</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">MatrixChannel3D</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">MatrixChannel3D</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">target</span>, <span class="ActionScriptDefault_Text">channel</span>.<span class="ActionScriptDefault_Text">syntax</span>.<span class="ActionScriptDefault_Text">targetSID</span><span class="ActionScriptBracket/Brace">)</span>;
            
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">transform</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">DaeTransform</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">node</span>.<span class="ActionScriptDefault_Text">findMatrixBySID</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">channel</span>.<span class="ActionScriptDefault_Text">syntax</span>.<span class="ActionScriptDefault_Text">targetSID</span><span class="ActionScriptBracket/Brace">)</span>;
                    
            <span class="ActionScriptReserved">if</span><span class="ActionScriptBracket/Brace">(!</span><span class="ActionScriptDefault_Text">transform</span><span class="ActionScriptBracket/Brace">)</span>
            <span class="ActionScriptBracket/Brace">{</span>
                <span class="ActionScriptDefault_Text">PaperLogger</span>.<span class="ActionScriptDefault_Text">warning</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">&quot;Couldn&apos;t find the targeted object&apos;s transform: &quot;</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptDefault_Text">channel</span>.<span class="ActionScriptDefault_Text">syntax</span>.<span class="ActionScriptDefault_Text">targetSID</span><span class="ActionScriptBracket/Brace">)</span>;
                <span class="ActionScriptReserved">return</span> <span class="ActionScriptReserved">null</span>;
            <span class="ActionScriptBracket/Brace">}</span>
            
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">matrix</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">Matrix3D</span>;
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">matrixProp</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">String</span>;
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">arrayMember</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">String</span>;
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">data</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">Array</span>;
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">val</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">Number</span>;
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">i</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">int</span>;
                        
            <span class="ActionScriptReserved">if</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">channel</span>.<span class="ActionScriptDefault_Text">syntax</span>.<span class="ActionScriptDefault_Text">isArrayAccess</span><span class="ActionScriptBracket/Brace">)</span>
            <span class="ActionScriptBracket/Brace">{</span>
                <span class="ActionScriptDefault_Text">arrayMember</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">channel</span>.<span class="ActionScriptDefault_Text">syntax</span>.<span class="ActionScriptDefault_Text">arrayMember</span>.<span class="ActionScriptDefault_Text">join</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">&quot;&quot;</span><span class="ActionScriptBracket/Brace">)</span>;
                
                <span class="ActionScriptReserved">switch</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">arrayMember</span><span class="ActionScriptBracket/Brace">)</span>
                <span class="ActionScriptBracket/Brace">{</span>
                    <span class="ActionScriptReserved">case</span> <span class="ActionScriptString">&quot;(0)(0)&quot;</span><span class="ActionScriptOperator">:</span>
                        <span class="ActionScriptDefault_Text">matrixProp</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptString">&quot;n11&quot;</span>;
                        <span class="ActionScriptReserved">break</span>;
                    <span class="ActionScriptReserved">case</span> <span class="ActionScriptString">&quot;(1)(0)&quot;</span><span class="ActionScriptOperator">:</span>
                        <span class="ActionScriptDefault_Text">matrixProp</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptString">&quot;n12&quot;</span>;
                        <span class="ActionScriptReserved">break</span>;
                    <span class="ActionScriptReserved">case</span> <span class="ActionScriptString">&quot;(2)(0)&quot;</span><span class="ActionScriptOperator">:</span>
                        <span class="ActionScriptDefault_Text">matrixProp</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptString">&quot;n13&quot;</span>;
                        <span class="ActionScriptReserved">break</span>;
                    <span class="ActionScriptReserved">case</span> <span class="ActionScriptString">&quot;(3)(0)&quot;</span><span class="ActionScriptOperator">:</span>
                        <span class="ActionScriptDefault_Text">matrixProp</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptString">&quot;n14&quot;</span>;
                        <span class="ActionScriptReserved">break</span>;
                    <span class="ActionScriptReserved">case</span> <span class="ActionScriptString">&quot;(0)(1)&quot;</span><span class="ActionScriptOperator">:</span>
                        <span class="ActionScriptDefault_Text">matrixProp</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptString">&quot;n21&quot;</span>;
                        <span class="ActionScriptReserved">break</span>;
                    <span class="ActionScriptReserved">case</span> <span class="ActionScriptString">&quot;(1)(1)&quot;</span><span class="ActionScriptOperator">:</span>
                        <span class="ActionScriptDefault_Text">matrixProp</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptString">&quot;n22&quot;</span>;
                        <span class="ActionScriptReserved">break</span>;
                    <span class="ActionScriptReserved">case</span> <span class="ActionScriptString">&quot;(2)(1)&quot;</span><span class="ActionScriptOperator">:</span>
                        <span class="ActionScriptDefault_Text">matrixProp</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptString">&quot;n23&quot;</span>;
                        <span class="ActionScriptReserved">break</span>;
                    <span class="ActionScriptReserved">case</span> <span class="ActionScriptString">&quot;(3)(1)&quot;</span><span class="ActionScriptOperator">:</span>
                        <span class="ActionScriptDefault_Text">matrixProp</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptString">&quot;n24&quot;</span>;
                        <span class="ActionScriptReserved">break</span>;
                    <span class="ActionScriptReserved">case</span> <span class="ActionScriptString">&quot;(0)(2)&quot;</span><span class="ActionScriptOperator">:</span>
                        <span class="ActionScriptDefault_Text">matrixProp</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptString">&quot;n31&quot;</span>;
                        <span class="ActionScriptReserved">break</span>;
                    <span class="ActionScriptReserved">case</span> <span class="ActionScriptString">&quot;(1)(2)&quot;</span><span class="ActionScriptOperator">:</span>
                        <span class="ActionScriptDefault_Text">matrixProp</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptString">&quot;n32&quot;</span>;
                        <span class="ActionScriptReserved">break</span>;
                    <span class="ActionScriptReserved">case</span> <span class="ActionScriptString">&quot;(2)(2)&quot;</span><span class="ActionScriptOperator">:</span>
                        <span class="ActionScriptDefault_Text">matrixProp</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptString">&quot;n33&quot;</span>;
                        <span class="ActionScriptReserved">break</span>;
                    <span class="ActionScriptReserved">case</span> <span class="ActionScriptString">&quot;(3)(2)&quot;</span><span class="ActionScriptOperator">:</span>
                        <span class="ActionScriptDefault_Text">matrixProp</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptString">&quot;n34&quot;</span>;
                        <span class="ActionScriptReserved">break</span>;
                    <span class="ActionScriptReserved">case</span> <span class="ActionScriptString">&quot;(0)(3)&quot;</span><span class="ActionScriptOperator">:</span>
                        <span class="ActionScriptDefault_Text">matrixProp</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptString">&quot;n41&quot;</span>;
                        <span class="ActionScriptReserved">break</span>;
                    <span class="ActionScriptReserved">case</span> <span class="ActionScriptString">&quot;(1)(3)&quot;</span><span class="ActionScriptOperator">:</span>
                        <span class="ActionScriptDefault_Text">matrixProp</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptString">&quot;n42&quot;</span>;
                        <span class="ActionScriptReserved">break</span>;
                    <span class="ActionScriptReserved">case</span> <span class="ActionScriptString">&quot;(2)(3)&quot;</span><span class="ActionScriptOperator">:</span>
                        <span class="ActionScriptDefault_Text">matrixProp</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptString">&quot;n43&quot;</span>;
                        <span class="ActionScriptReserved">break</span>;
                    <span class="ActionScriptReserved">case</span> <span class="ActionScriptString">&quot;(3)(3)&quot;</span><span class="ActionScriptOperator">:</span>
                        <span class="ActionScriptDefault_Text">matrixProp</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptString">&quot;n44&quot;</span>;
                        <span class="ActionScriptReserved">break</span>;
                    <span class="ActionScriptReserved">default</span><span class="ActionScriptOperator">:</span>
                        <span class="ActionScriptReserved">throw</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">Error</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">arrayMember</span><span class="ActionScriptBracket/Brace">)</span>;
                <span class="ActionScriptBracket/Brace">}</span>
            <span class="ActionScriptBracket/Brace">}</span>
                    
            <span class="ActionScriptReserved">switch</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">transform</span>.<span class="ActionScriptDefault_Text">type</span><span class="ActionScriptBracket/Brace">)</span>
            <span class="ActionScriptBracket/Brace">{</span>
                <span class="ActionScriptReserved">case</span> <span class="ActionScriptString">&quot;matrix&quot;</span><span class="ActionScriptOperator">:</span>
                    <span class="ActionScriptReserved">if</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">channel</span>.<span class="ActionScriptDefault_Text">syntax</span>.<span class="ActionScriptDefault_Text">isFullAccess</span><span class="ActionScriptBracket/Brace">)</span>
                    <span class="ActionScriptBracket/Brace">{</span>
                        <span class="ActionScriptReserved">for</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">i</span> <span class="ActionScriptOperator">=</span> 0; <span class="ActionScriptDefault_Text">i</span> <span class="ActionScriptOperator">&lt;</span> <span class="ActionScriptDefault_Text">channel</span>.<span class="ActionScriptDefault_Text">input</span>.<span class="ActionScriptDefault_Text">length</span>; <span class="ActionScriptDefault_Text">i</span><span class="ActionScriptOperator">++</span><span class="ActionScriptBracket/Brace">)</span>
                        <span class="ActionScriptBracket/Brace">{</span>
                            <span class="ActionScriptDefault_Text">data</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">channel</span>.<span class="ActionScriptDefault_Text">output</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">i</span><span class="ActionScriptBracket/Brace">]</span>;
                            <span class="ActionScriptDefault_Text">matrix</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">Matrix3D</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">data</span><span class="ActionScriptBracket/Brace">)</span>;
                            <span class="ActionScriptDefault_Text">matrixChannel</span>.<span class="ActionScriptDefault_Text">addKeyFrame</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">AnimationKeyFrame3D</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">&quot;keyframe_&quot;</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptDefault_Text">i</span>, <span class="ActionScriptDefault_Text">channel</span>.<span class="ActionScriptDefault_Text">input</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">i</span><span class="ActionScriptBracket/Brace">]</span>, <span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">matrix</span><span class="ActionScriptBracket/Brace">]))</span>;
                        <span class="ActionScriptBracket/Brace">}</span>
                    <span class="ActionScriptBracket/Brace">}</span>
                    <span class="ActionScriptReserved">else</span> <span class="ActionScriptReserved">if</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">channel</span>.<span class="ActionScriptDefault_Text">syntax</span>.<span class="ActionScriptDefault_Text">isArrayAccess</span><span class="ActionScriptBracket/Brace">)</span>
                    <span class="ActionScriptBracket/Brace">{</span>
                        <span class="ActionScriptDefault_Text">matrix</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">Matrix3D</span>.<span class="ActionScriptDefault_Text">clone</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">target</span>.<span class="ActionScriptDefault_Text">transform</span><span class="ActionScriptBracket/Brace">)</span>;
                        
                        <span class="ActionScriptReserved">for</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">i</span> <span class="ActionScriptOperator">=</span> 0; <span class="ActionScriptDefault_Text">i</span> <span class="ActionScriptOperator">&lt;</span> <span class="ActionScriptDefault_Text">channel</span>.<span class="ActionScriptDefault_Text">input</span>.<span class="ActionScriptDefault_Text">length</span>; <span class="ActionScriptDefault_Text">i</span><span class="ActionScriptOperator">++</span><span class="ActionScriptBracket/Brace">)</span>
                        <span class="ActionScriptBracket/Brace">{</span>
                            <span class="ActionScriptDefault_Text">matrix</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">matrixProp</span><span class="ActionScriptBracket/Brace">]</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">channel</span>.<span class="ActionScriptDefault_Text">output</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">i</span><span class="ActionScriptBracket/Brace">]</span>;
                            <span class="ActionScriptDefault_Text">matrixChannel</span>.<span class="ActionScriptDefault_Text">addKeyFrame</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">AnimationKeyFrame3D</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">&quot;keyframe_&quot;</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptDefault_Text">i</span>, <span class="ActionScriptDefault_Text">channel</span>.<span class="ActionScriptDefault_Text">input</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">i</span><span class="ActionScriptBracket/Brace">]</span>, <span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">matrix</span><span class="ActionScriptBracket/Brace">]))</span>;
                        <span class="ActionScriptBracket/Brace">}</span>
                    <span class="ActionScriptBracket/Brace">}</span>
                    <span class="ActionScriptReserved">else</span>
                    <span class="ActionScriptBracket/Brace">{</span>
                        <span class="ActionScriptReserved">throw</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">Error</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">&quot;Don&apos;t know how to handle this channel: &quot;</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptDefault_Text">channel</span>.<span class="ActionScriptDefault_Text">syntax</span><span class="ActionScriptBracket/Brace">)</span>;
                    <span class="ActionScriptBracket/Brace">}</span>
                    <span class="ActionScriptReserved">break</span>;
                <span class="ActionScriptReserved">case</span> <span class="ActionScriptString">&quot;rotate&quot;</span><span class="ActionScriptOperator">:</span>
                    <span class="ActionScriptReserved">if</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">channel</span>.<span class="ActionScriptDefault_Text">syntax</span>.<span class="ActionScriptDefault_Text">isFullAccess</span><span class="ActionScriptBracket/Brace">)</span>
                    <span class="ActionScriptBracket/Brace">{</span>
                        <span class="ActionScriptReserved">for</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">i</span> <span class="ActionScriptOperator">=</span> 0; <span class="ActionScriptDefault_Text">i</span> <span class="ActionScriptOperator">&lt;</span> <span class="ActionScriptDefault_Text">channel</span>.<span class="ActionScriptDefault_Text">input</span>.<span class="ActionScriptDefault_Text">length</span>; <span class="ActionScriptDefault_Text">i</span><span class="ActionScriptOperator">++</span><span class="ActionScriptBracket/Brace">)</span>
                        <span class="ActionScriptBracket/Brace">{</span>
                            <span class="ActionScriptDefault_Text">data</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">channel</span>.<span class="ActionScriptDefault_Text">output</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">i</span><span class="ActionScriptBracket/Brace">]</span>;
                            <span class="ActionScriptDefault_Text">matrix</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">Matrix3D</span>.<span class="ActionScriptDefault_Text">rotationMatrix</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">data</span><span class="ActionScriptBracket/Brace">[</span>0<span class="ActionScriptBracket/Brace">]</span>, <span class="ActionScriptDefault_Text">data</span><span class="ActionScriptBracket/Brace">[</span>1<span class="ActionScriptBracket/Brace">]</span>, <span class="ActionScriptDefault_Text">data</span><span class="ActionScriptBracket/Brace">[</span>2<span class="ActionScriptBracket/Brace">]</span>, <span class="ActionScriptDefault_Text">data</span><span class="ActionScriptBracket/Brace">[</span>3<span class="ActionScriptBracket/Brace">]</span> <span class="ActionScriptOperator">*</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">Math</span>.<span class="ActionScriptDefault_Text">PI</span><span class="ActionScriptOperator">/</span>180<span class="ActionScriptBracket/Brace">))</span>;
                            <span class="ActionScriptDefault_Text">matrixChannel</span>.<span class="ActionScriptDefault_Text">addKeyFrame</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">AnimationKeyFrame3D</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">&quot;keyframe_&quot;</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptDefault_Text">i</span>, <span class="ActionScriptDefault_Text">channel</span>.<span class="ActionScriptDefault_Text">input</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">i</span><span class="ActionScriptBracket/Brace">]</span>, <span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">matrix</span><span class="ActionScriptBracket/Brace">]))</span>;
                        <span class="ActionScriptBracket/Brace">}</span>
                    <span class="ActionScriptBracket/Brace">}</span>
                    <span class="ActionScriptReserved">else</span> <span class="ActionScriptReserved">if</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">channel</span>.<span class="ActionScriptDefault_Text">syntax</span>.<span class="ActionScriptDefault_Text">isDotAccess</span><span class="ActionScriptBracket/Brace">)</span>
                    <span class="ActionScriptBracket/Brace">{</span>
                        <span class="ActionScriptReserved">switch</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">channel</span>.<span class="ActionScriptDefault_Text">syntax</span>.<span class="ActionScriptDefault_Text">member</span><span class="ActionScriptBracket/Brace">)</span>
                        <span class="ActionScriptBracket/Brace">{</span>
                            <span class="ActionScriptReserved">case</span> <span class="ActionScriptString">&quot;ANGLE&quot;</span><span class="ActionScriptOperator">:</span>
                                <span class="ActionScriptReserved">for</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">i</span> <span class="ActionScriptOperator">=</span> 0; <span class="ActionScriptDefault_Text">i</span> <span class="ActionScriptOperator">&lt;</span> <span class="ActionScriptDefault_Text">channel</span>.<span class="ActionScriptDefault_Text">input</span>.<span class="ActionScriptDefault_Text">length</span>; <span class="ActionScriptDefault_Text">i</span><span class="ActionScriptOperator">++</span><span class="ActionScriptBracket/Brace">)</span>
                                <span class="ActionScriptBracket/Brace">{</span>
                                    <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">angle</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">Number</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">channel</span>.<span class="ActionScriptDefault_Text">output</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">i</span><span class="ActionScriptBracket/Brace">]</span> <span class="ActionScriptOperator">*</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">Math</span>.<span class="ActionScriptDefault_Text">PI</span><span class="ActionScriptOperator">/</span>180<span class="ActionScriptBracket/Brace">)</span>;
                                    <span class="ActionScriptDefault_Text">matrix</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">Matrix3D</span>.<span class="ActionScriptDefault_Text">rotationMatrix</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">transform</span>.<span class="ActionScriptDefault_Text">values</span><span class="ActionScriptBracket/Brace">[</span>0<span class="ActionScriptBracket/Brace">]</span>, <span class="ActionScriptDefault_Text">transform</span>.<span class="ActionScriptDefault_Text">values</span><span class="ActionScriptBracket/Brace">[</span>1<span class="ActionScriptBracket/Brace">]</span>, <span class="ActionScriptDefault_Text">transform</span>.<span class="ActionScriptDefault_Text">values</span><span class="ActionScriptBracket/Brace">[</span>2<span class="ActionScriptBracket/Brace">]</span>, <span class="ActionScriptDefault_Text">angle</span><span class="ActionScriptBracket/Brace">)</span>;
                                    <span class="ActionScriptDefault_Text">matrixChannel</span>.<span class="ActionScriptDefault_Text">addKeyFrame</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">AnimationKeyFrame3D</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">&quot;keyframe_&quot;</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptDefault_Text">i</span>, <span class="ActionScriptDefault_Text">channel</span>.<span class="ActionScriptDefault_Text">input</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">i</span><span class="ActionScriptBracket/Brace">]</span>, <span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">matrix</span><span class="ActionScriptBracket/Brace">]))</span>;
                                <span class="ActionScriptBracket/Brace">}</span>
                                <span class="ActionScriptReserved">break</span>;
                            <span class="ActionScriptReserved">default</span><span class="ActionScriptOperator">:</span>
                                <span class="ActionScriptReserved">throw</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">Error</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">&quot;Don&apos;t know how to handle this channel: &quot;</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptDefault_Text">channel</span>.<span class="ActionScriptDefault_Text">syntax</span><span class="ActionScriptBracket/Brace">)</span>;
                        <span class="ActionScriptBracket/Brace">}</span>
                    <span class="ActionScriptBracket/Brace">}</span>
                    <span class="ActionScriptReserved">else</span>
                    <span class="ActionScriptBracket/Brace">{</span>
                        <span class="ActionScriptReserved">throw</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">Error</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">&quot;Don&apos;t know how to handle this channel: &quot;</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptDefault_Text">channel</span>.<span class="ActionScriptDefault_Text">syntax</span><span class="ActionScriptBracket/Brace">)</span>;
                    <span class="ActionScriptBracket/Brace">}</span>    
                    <span class="ActionScriptReserved">break</span>;
                <span class="ActionScriptReserved">case</span> <span class="ActionScriptString">&quot;scale&quot;</span><span class="ActionScriptOperator">:</span>
                    <span class="ActionScriptReserved">if</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">channel</span>.<span class="ActionScriptDefault_Text">syntax</span>.<span class="ActionScriptDefault_Text">isFullAccess</span><span class="ActionScriptBracket/Brace">)</span>
                    <span class="ActionScriptBracket/Brace">{</span>
                        <span class="ActionScriptReserved">for</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">i</span> <span class="ActionScriptOperator">=</span> 0; <span class="ActionScriptDefault_Text">i</span> <span class="ActionScriptOperator">&lt;</span> <span class="ActionScriptDefault_Text">channel</span>.<span class="ActionScriptDefault_Text">input</span>.<span class="ActionScriptDefault_Text">length</span>; <span class="ActionScriptDefault_Text">i</span><span class="ActionScriptOperator">++</span><span class="ActionScriptBracket/Brace">)</span>
                        <span class="ActionScriptBracket/Brace">{</span>
                            <span class="ActionScriptDefault_Text">data</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">channel</span>.<span class="ActionScriptDefault_Text">output</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">i</span><span class="ActionScriptBracket/Brace">]</span>;
                            <span class="ActionScriptDefault_Text">matrix</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">Matrix3D</span>.<span class="ActionScriptDefault_Text">scaleMatrix</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">data</span><span class="ActionScriptBracket/Brace">[</span>0<span class="ActionScriptBracket/Brace">]</span>, <span class="ActionScriptDefault_Text">data</span><span class="ActionScriptBracket/Brace">[</span>1<span class="ActionScriptBracket/Brace">]</span>, <span class="ActionScriptDefault_Text">data</span><span class="ActionScriptBracket/Brace">[</span>2<span class="ActionScriptBracket/Brace">])</span>;
                            <span class="ActionScriptDefault_Text">matrixChannel</span>.<span class="ActionScriptDefault_Text">addKeyFrame</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">AnimationKeyFrame3D</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">&quot;keyframe_&quot;</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptDefault_Text">i</span>, <span class="ActionScriptDefault_Text">channel</span>.<span class="ActionScriptDefault_Text">input</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">i</span><span class="ActionScriptBracket/Brace">]</span>, <span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">matrix</span><span class="ActionScriptBracket/Brace">]))</span>;
                        <span class="ActionScriptBracket/Brace">}</span>
                    <span class="ActionScriptBracket/Brace">}</span>
                    <span class="ActionScriptReserved">else</span> <span class="ActionScriptReserved">if</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">channel</span>.<span class="ActionScriptDefault_Text">syntax</span>.<span class="ActionScriptDefault_Text">isDotAccess</span><span class="ActionScriptBracket/Brace">)</span>
                    <span class="ActionScriptBracket/Brace">{</span>
                        <span class="ActionScriptReserved">for</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">i</span> <span class="ActionScriptOperator">=</span> 0; <span class="ActionScriptDefault_Text">i</span> <span class="ActionScriptOperator">&lt;</span> <span class="ActionScriptDefault_Text">channel</span>.<span class="ActionScriptDefault_Text">input</span>.<span class="ActionScriptDefault_Text">length</span>; <span class="ActionScriptDefault_Text">i</span><span class="ActionScriptOperator">++</span><span class="ActionScriptBracket/Brace">)</span>
                        <span class="ActionScriptBracket/Brace">{</span>
                            <span class="ActionScriptDefault_Text">val</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">channel</span>.<span class="ActionScriptDefault_Text">output</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">i</span><span class="ActionScriptBracket/Brace">]</span>;
                            <span class="ActionScriptReserved">switch</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">channel</span>.<span class="ActionScriptDefault_Text">syntax</span>.<span class="ActionScriptDefault_Text">member</span><span class="ActionScriptBracket/Brace">)</span>
                            <span class="ActionScriptBracket/Brace">{</span>
                                <span class="ActionScriptReserved">case</span> <span class="ActionScriptString">&quot;X&quot;</span><span class="ActionScriptOperator">:</span>
                                    <span class="ActionScriptDefault_Text">matrix</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">Matrix3D</span>.<span class="ActionScriptDefault_Text">scaleMatrix</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">val</span>, 0, 0<span class="ActionScriptBracket/Brace">)</span>;
                                    <span class="ActionScriptDefault_Text">matrixChannel</span>.<span class="ActionScriptDefault_Text">addKeyFrame</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">AnimationKeyFrame3D</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">&quot;keyframe_&quot;</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptDefault_Text">i</span>, <span class="ActionScriptDefault_Text">channel</span>.<span class="ActionScriptDefault_Text">input</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">i</span><span class="ActionScriptBracket/Brace">]</span>, <span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">matrix</span><span class="ActionScriptBracket/Brace">]))</span>;
                                    <span class="ActionScriptReserved">break</span>;
                                <span class="ActionScriptReserved">case</span> <span class="ActionScriptString">&quot;Y&quot;</span><span class="ActionScriptOperator">:</span>
                                    <span class="ActionScriptDefault_Text">matrix</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">Matrix3D</span>.<span class="ActionScriptDefault_Text">scaleMatrix</span><span class="ActionScriptBracket/Brace">(</span>0, <span class="ActionScriptDefault_Text">val</span>, 0<span class="ActionScriptBracket/Brace">)</span>;
                                    <span class="ActionScriptDefault_Text">matrixChannel</span>.<span class="ActionScriptDefault_Text">addKeyFrame</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">AnimationKeyFrame3D</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">&quot;keyframe_&quot;</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptDefault_Text">i</span>, <span class="ActionScriptDefault_Text">channel</span>.<span class="ActionScriptDefault_Text">input</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">i</span><span class="ActionScriptBracket/Brace">]</span>, <span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">matrix</span><span class="ActionScriptBracket/Brace">]))</span>;
                                    <span class="ActionScriptReserved">break</span>;
                                <span class="ActionScriptReserved">case</span> <span class="ActionScriptString">&quot;Z&quot;</span><span class="ActionScriptOperator">:</span>
                                    <span class="ActionScriptDefault_Text">matrix</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">Matrix3D</span>.<span class="ActionScriptDefault_Text">scaleMatrix</span><span class="ActionScriptBracket/Brace">(</span>0, 0, <span class="ActionScriptDefault_Text">val</span><span class="ActionScriptBracket/Brace">)</span>;
                                    <span class="ActionScriptDefault_Text">matrixChannel</span>.<span class="ActionScriptDefault_Text">addKeyFrame</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">AnimationKeyFrame3D</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">&quot;keyframe_&quot;</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptDefault_Text">i</span>, <span class="ActionScriptDefault_Text">channel</span>.<span class="ActionScriptDefault_Text">input</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">i</span><span class="ActionScriptBracket/Brace">]</span>, <span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">matrix</span><span class="ActionScriptBracket/Brace">]))</span>;
                                    <span class="ActionScriptReserved">break</span>;
                                <span class="ActionScriptReserved">default</span><span class="ActionScriptOperator">:</span>
                                    <span class="ActionScriptReserved">break</span>;        
                            <span class="ActionScriptBracket/Brace">}</span>
                        <span class="ActionScriptBracket/Brace">}</span>
                    <span class="ActionScriptBracket/Brace">}</span>
                    <span class="ActionScriptReserved">else</span>
                    <span class="ActionScriptBracket/Brace">{</span>
                        <span class="ActionScriptReserved">throw</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">Error</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">&quot;Don&apos;t know how to handle this channel: &quot;</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptDefault_Text">channel</span>.<span class="ActionScriptDefault_Text">syntax</span><span class="ActionScriptBracket/Brace">)</span>;
                    <span class="ActionScriptBracket/Brace">}</span>
                    <span class="ActionScriptReserved">break</span>;
                <span class="ActionScriptReserved">case</span> <span class="ActionScriptString">&quot;translate&quot;</span><span class="ActionScriptOperator">:</span>
                    <span class="ActionScriptReserved">if</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">channel</span>.<span class="ActionScriptDefault_Text">syntax</span>.<span class="ActionScriptDefault_Text">isFullAccess</span><span class="ActionScriptBracket/Brace">)</span>
                    <span class="ActionScriptBracket/Brace">{</span>
                        <span class="ActionScriptReserved">for</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">i</span> <span class="ActionScriptOperator">=</span> 0; <span class="ActionScriptDefault_Text">i</span> <span class="ActionScriptOperator">&lt;</span> <span class="ActionScriptDefault_Text">channel</span>.<span class="ActionScriptDefault_Text">input</span>.<span class="ActionScriptDefault_Text">length</span>; <span class="ActionScriptDefault_Text">i</span><span class="ActionScriptOperator">++</span><span class="ActionScriptBracket/Brace">)</span>
                        <span class="ActionScriptBracket/Brace">{</span>
                            <span class="ActionScriptDefault_Text">data</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">channel</span>.<span class="ActionScriptDefault_Text">output</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">i</span><span class="ActionScriptBracket/Brace">]</span>;
                            <span class="ActionScriptDefault_Text">matrix</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">Matrix3D</span>.<span class="ActionScriptDefault_Text">translationMatrix</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">data</span><span class="ActionScriptBracket/Brace">[</span>0<span class="ActionScriptBracket/Brace">]</span>, <span class="ActionScriptDefault_Text">data</span><span class="ActionScriptBracket/Brace">[</span>1<span class="ActionScriptBracket/Brace">]</span>, <span class="ActionScriptDefault_Text">data</span><span class="ActionScriptBracket/Brace">[</span>2<span class="ActionScriptBracket/Brace">])</span>;
                            <span class="ActionScriptDefault_Text">matrixChannel</span>.<span class="ActionScriptDefault_Text">addKeyFrame</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">AnimationKeyFrame3D</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">&quot;keyframe_&quot;</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptDefault_Text">i</span>, <span class="ActionScriptDefault_Text">channel</span>.<span class="ActionScriptDefault_Text">input</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">i</span><span class="ActionScriptBracket/Brace">]</span>, <span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">matrix</span><span class="ActionScriptBracket/Brace">]))</span>;
                        <span class="ActionScriptBracket/Brace">}</span>
                    <span class="ActionScriptBracket/Brace">}</span>    
                    <span class="ActionScriptReserved">else</span> <span class="ActionScriptReserved">if</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">channel</span>.<span class="ActionScriptDefault_Text">syntax</span>.<span class="ActionScriptDefault_Text">isDotAccess</span><span class="ActionScriptBracket/Brace">)</span>
                    <span class="ActionScriptBracket/Brace">{</span>
                        <span class="ActionScriptReserved">for</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">i</span> <span class="ActionScriptOperator">=</span> 0; <span class="ActionScriptDefault_Text">i</span> <span class="ActionScriptOperator">&lt;</span> <span class="ActionScriptDefault_Text">channel</span>.<span class="ActionScriptDefault_Text">input</span>.<span class="ActionScriptDefault_Text">length</span>; <span class="ActionScriptDefault_Text">i</span><span class="ActionScriptOperator">++</span><span class="ActionScriptBracket/Brace">)</span>
                        <span class="ActionScriptBracket/Brace">{</span>
                            <span class="ActionScriptDefault_Text">val</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">channel</span>.<span class="ActionScriptDefault_Text">output</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">i</span><span class="ActionScriptBracket/Brace">]</span>;
                            <span class="ActionScriptReserved">switch</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">channel</span>.<span class="ActionScriptDefault_Text">syntax</span>.<span class="ActionScriptDefault_Text">member</span><span class="ActionScriptBracket/Brace">)</span>
                            <span class="ActionScriptBracket/Brace">{</span>
                                <span class="ActionScriptReserved">case</span> <span class="ActionScriptString">&quot;X&quot;</span><span class="ActionScriptOperator">:</span>
                                    <span class="ActionScriptDefault_Text">matrix</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">Matrix3D</span>.<span class="ActionScriptDefault_Text">translationMatrix</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">val</span>, 0, 0<span class="ActionScriptBracket/Brace">)</span>;
                                    <span class="ActionScriptDefault_Text">matrixChannel</span>.<span class="ActionScriptDefault_Text">addKeyFrame</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">AnimationKeyFrame3D</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">&quot;keyframe_&quot;</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptDefault_Text">i</span>, <span class="ActionScriptDefault_Text">channel</span>.<span class="ActionScriptDefault_Text">input</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">i</span><span class="ActionScriptBracket/Brace">]</span>, <span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">matrix</span><span class="ActionScriptBracket/Brace">]))</span>;
                                    <span class="ActionScriptReserved">break</span>;
                                <span class="ActionScriptReserved">case</span> <span class="ActionScriptString">&quot;Y&quot;</span><span class="ActionScriptOperator">:</span>
                                    <span class="ActionScriptDefault_Text">matrix</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">Matrix3D</span>.<span class="ActionScriptDefault_Text">translationMatrix</span><span class="ActionScriptBracket/Brace">(</span>0, <span class="ActionScriptDefault_Text">val</span>, 0<span class="ActionScriptBracket/Brace">)</span>;
                                    <span class="ActionScriptDefault_Text">matrixChannel</span>.<span class="ActionScriptDefault_Text">addKeyFrame</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">AnimationKeyFrame3D</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">&quot;keyframe_&quot;</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptDefault_Text">i</span>, <span class="ActionScriptDefault_Text">channel</span>.<span class="ActionScriptDefault_Text">input</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">i</span><span class="ActionScriptBracket/Brace">]</span>, <span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">matrix</span><span class="ActionScriptBracket/Brace">]))</span>;
                                    <span class="ActionScriptReserved">break</span>;
                                <span class="ActionScriptReserved">case</span> <span class="ActionScriptString">&quot;Z&quot;</span><span class="ActionScriptOperator">:</span>
                                    <span class="ActionScriptDefault_Text">matrix</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">Matrix3D</span>.<span class="ActionScriptDefault_Text">translationMatrix</span><span class="ActionScriptBracket/Brace">(</span>0, 0, <span class="ActionScriptDefault_Text">val</span><span class="ActionScriptBracket/Brace">)</span>;
                                    <span class="ActionScriptDefault_Text">matrixChannel</span>.<span class="ActionScriptDefault_Text">addKeyFrame</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">AnimationKeyFrame3D</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">&quot;keyframe_&quot;</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptDefault_Text">i</span>, <span class="ActionScriptDefault_Text">channel</span>.<span class="ActionScriptDefault_Text">input</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">i</span><span class="ActionScriptBracket/Brace">]</span>, <span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">matrix</span><span class="ActionScriptBracket/Brace">]))</span>;
                                    <span class="ActionScriptReserved">break</span>;
                                <span class="ActionScriptReserved">default</span><span class="ActionScriptOperator">:</span>
                                    <span class="ActionScriptReserved">break</span>;        
                            <span class="ActionScriptBracket/Brace">}</span>
                        <span class="ActionScriptBracket/Brace">}</span>
                    <span class="ActionScriptBracket/Brace">}</span>
                    <span class="ActionScriptReserved">else</span>
                    <span class="ActionScriptBracket/Brace">{</span>
                        <span class="ActionScriptReserved">throw</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">Error</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">&quot;Don&apos;t know how to handle this channel: &quot;</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptDefault_Text">channel</span>.<span class="ActionScriptDefault_Text">syntax</span><span class="ActionScriptBracket/Brace">)</span>;
                    <span class="ActionScriptBracket/Brace">}</span>        
                    <span class="ActionScriptReserved">break</span>;
                <span class="ActionScriptReserved">default</span><span class="ActionScriptOperator">:</span>
                    <span class="ActionScriptReserved">throw</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">Error</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">&quot;Unknown transform type!&quot;</span><span class="ActionScriptBracket/Brace">)</span>;    
            <span class="ActionScriptBracket/Brace">}</span>
                
            <span class="ActionScriptReserved">return</span> <span class="ActionScriptDefault_Text">matrixChannel</span>;
        <span class="ActionScriptBracket/Brace">}</span>
        
        <span class="ActionScriptASDoc">/**
         * Build all animation channels.
         */</span> 
        <span class="ActionScriptReserved">protected</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">buildAnimationChannels</span><span class="ActionScriptBracket/Brace">()</span><span class="ActionScriptOperator">:</span><span class="ActionScriptReserved">void</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">target</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">DisplayObject3D</span>;
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">channel</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">DaeChannel</span>;
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">channelsByObject</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">Dictionary</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">Dictionary</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptReserved">true</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">i</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">int</span>;
            
            <span class="ActionScriptDefault_Text">_channelsByTarget</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">Dictionary</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptReserved">true</span><span class="ActionScriptBracket/Brace">)</span>;
            
            <span class="ActionScriptReserved">for</span> <span class="ActionScriptReserved">each</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">animation</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">DaeAnimation</span> <span class="ActionScriptReserved">in</span> <span class="ActionScriptReserved">this</span>.<span class="ActionScriptDefault_Text">document</span>.<span class="ActionScriptDefault_Text">animations</span><span class="ActionScriptBracket/Brace">)</span>
            <span class="ActionScriptBracket/Brace">{</span>
                <span class="ActionScriptReserved">for</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">i</span> <span class="ActionScriptOperator">=</span> 0; <span class="ActionScriptDefault_Text">i</span> <span class="ActionScriptOperator">&lt;</span> <span class="ActionScriptDefault_Text">animation</span>.<span class="ActionScriptDefault_Text">channels</span>.<span class="ActionScriptDefault_Text">length</span>; <span class="ActionScriptDefault_Text">i</span><span class="ActionScriptOperator">++</span><span class="ActionScriptBracket/Brace">)</span>
                <span class="ActionScriptBracket/Brace">{</span>
                    <span class="ActionScriptDefault_Text">channel</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">animation</span>.<span class="ActionScriptDefault_Text">channels</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">i</span><span class="ActionScriptBracket/Brace">]</span>;
                    
                    <span class="ActionScriptDefault_Text">target</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">_colladaIDToObject</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">channel</span>.<span class="ActionScriptDefault_Text">syntax</span>.<span class="ActionScriptDefault_Text">targetID</span><span class="ActionScriptBracket/Brace">]</span>;
                    <span class="ActionScriptReserved">if</span><span class="ActionScriptBracket/Brace">(!</span><span class="ActionScriptDefault_Text">target</span><span class="ActionScriptBracket/Brace">)</span>
                        <span class="ActionScriptReserved">throw</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">Error</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">&quot;damn&quot;</span><span class="ActionScriptBracket/Brace">)</span>;
                        
                    <span class="ActionScriptReserved">if</span><span class="ActionScriptBracket/Brace">(!</span><span class="ActionScriptDefault_Text">channelsByObject</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">target</span><span class="ActionScriptBracket/Brace">])</span>
                        <span class="ActionScriptDefault_Text">channelsByObject</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">target</span><span class="ActionScriptBracket/Brace">]</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">Array</span><span class="ActionScriptBracket/Brace">()</span>;
                    
                    <span class="ActionScriptDefault_Text">channelsByObject</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">target</span><span class="ActionScriptBracket/Brace">]</span>.<span class="ActionScriptDefault_Text">push</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">channel</span><span class="ActionScriptBracket/Brace">)</span>;
                <span class="ActionScriptBracket/Brace">}</span>
            <span class="ActionScriptBracket/Brace">}</span>
            
            <span class="ActionScriptReserved">for</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">object</span><span class="ActionScriptOperator">:*</span> <span class="ActionScriptReserved">in</span> <span class="ActionScriptDefault_Text">channelsByObject</span><span class="ActionScriptBracket/Brace">)</span>
            <span class="ActionScriptBracket/Brace">{</span>
                <span class="ActionScriptDefault_Text">target</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">object</span> <span class="ActionScriptReserved">as</span> <span class="ActionScriptDefault_Text">DisplayObject3D</span>;
                            
                <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">channels</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">Array</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">channelsByObject</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">object</span><span class="ActionScriptBracket/Brace">]</span>;
                <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">node</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">DaeNode</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">_objectToNode</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">target</span><span class="ActionScriptBracket/Brace">]</span>;
                    
                <span class="ActionScriptReserved">if</span><span class="ActionScriptBracket/Brace">(!</span><span class="ActionScriptDefault_Text">node</span><span class="ActionScriptBracket/Brace">)</span>
                    <span class="ActionScriptReserved">throw</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">Error</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">&quot;Couldn&apos;t find the targeted object with name &apos;&quot;</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptDefault_Text">node</span>.<span class="ActionScriptDefault_Text">name</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptString">&quot;&apos;&quot;</span><span class="ActionScriptBracket/Brace">)</span>;
                    
                <span class="ActionScriptDefault_Text">node</span>.<span class="ActionScriptDefault_Text">channels</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">channels</span>;
                
                <span class="ActionScriptReserved">if</span><span class="ActionScriptBracket/Brace">(!</span><span class="ActionScriptDefault_Text">channels</span>.<span class="ActionScriptDefault_Text">length</span><span class="ActionScriptBracket/Brace">)</span>
                    <span class="ActionScriptReserved">continue</span>;
                
                <span class="ActionScriptDefault_Text">channel</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">channels</span><span class="ActionScriptBracket/Brace">[</span>0<span class="ActionScriptBracket/Brace">]</span>;
                
                <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">transform</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">DaeTransform</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">node</span>.<span class="ActionScriptDefault_Text">findMatrixBySID</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">channel</span>.<span class="ActionScriptDefault_Text">syntax</span>.<span class="ActionScriptDefault_Text">targetSID</span><span class="ActionScriptBracket/Brace">)</span>;
                
                <span class="ActionScriptReserved">if</span><span class="ActionScriptBracket/Brace">(!</span><span class="ActionScriptDefault_Text">transform</span><span class="ActionScriptBracket/Brace">)</span>
                <span class="ActionScriptBracket/Brace">{</span>
                    <span class="ActionScriptDefault_Text">PaperLogger</span>.<span class="ActionScriptDefault_Text">warning</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">&quot;Could not find a transform with SID=&quot;</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptDefault_Text">channel</span>.<span class="ActionScriptDefault_Text">syntax</span>.<span class="ActionScriptDefault_Text">targetSID</span><span class="ActionScriptBracket/Brace">)</span>;
                    <span class="ActionScriptReserved">continue</span>;
                <span class="ActionScriptBracket/Brace">}</span>
    
                <span class="ActionScriptComment">// the object has a single &lt;matrix&gt; channel
</span>                <span class="ActionScriptReserved">if</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">channels</span>.<span class="ActionScriptDefault_Text">length</span> <span class="ActionScriptOperator">==</span> 1 <span class="ActionScriptOperator">&amp;&amp;</span> <span class="ActionScriptDefault_Text">transform</span>.<span class="ActionScriptDefault_Text">type</span> <span class="ActionScriptOperator">==</span> <span class="ActionScriptDefault_Text">ASCollada</span>.<span class="ActionScriptDefault_Text">DAE_MATRIX_ELEMENT</span><span class="ActionScriptBracket/Brace">)</span>
                <span class="ActionScriptBracket/Brace">{</span>
                    <span class="ActionScriptDefault_Text">_channelsByTarget</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">target</span><span class="ActionScriptBracket/Brace">]</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">buildAnimationChannel</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">target</span>, <span class="ActionScriptDefault_Text">channel</span><span class="ActionScriptBracket/Brace">)]</span>;
                    <span class="ActionScriptReserved">continue</span>;
                <span class="ActionScriptBracket/Brace">}</span>
                
                <span class="ActionScriptComment">// the object has multiple channels, lets bake &apos;m into a single channel
</span>                <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">allTimes</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">Array</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">Array</span><span class="ActionScriptBracket/Brace">()</span>;
                <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">times</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">Array</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">Array</span><span class="ActionScriptBracket/Brace">()</span>;
                <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">lastTime</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">Number</span>;
                
                <span class="ActionScriptComment">// fetch all times for all channels
</span>                <span class="ActionScriptReserved">for</span> <span class="ActionScriptReserved">each</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">channel</span> <span class="ActionScriptReserved">in</span> <span class="ActionScriptDefault_Text">channels</span><span class="ActionScriptBracket/Brace">)</span>
                    <span class="ActionScriptDefault_Text">allTimes</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">allTimes</span>.<span class="ActionScriptDefault_Text">concat</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">channel</span>.<span class="ActionScriptDefault_Text">input</span><span class="ActionScriptBracket/Brace">)</span>;
                <span class="ActionScriptDefault_Text">allTimes</span>.<span class="ActionScriptDefault_Text">sort</span><span class="ActionScriptBracket/Brace">(A</span><span class="ActionScriptDefault_Text">rray</span>.<span class="ActionScriptDefault_Text">NUMERIC</span><span class="ActionScriptBracket/Brace">)</span>;
                
                <span class="ActionScriptComment">// make array with unique times
</span>                <span class="ActionScriptReserved">for</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">i</span> <span class="ActionScriptOperator">=</span> 0; <span class="ActionScriptDefault_Text">i</span> <span class="ActionScriptOperator">&lt;</span> <span class="ActionScriptDefault_Text">allTimes</span>.<span class="ActionScriptDefault_Text">length</span>; <span class="ActionScriptDefault_Text">i</span><span class="ActionScriptOperator">++</span><span class="ActionScriptBracket/Brace">)</span>
                <span class="ActionScriptBracket/Brace">{</span>
                    <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">t</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">Number</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">allTimes</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">i</span><span class="ActionScriptBracket/Brace">]</span>;
                    <span class="ActionScriptReserved">if</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">i</span> <span class="ActionScriptOperator">==</span> 0<span class="ActionScriptBracket/Brace">)</span>
                        <span class="ActionScriptDefault_Text">times</span>.<span class="ActionScriptDefault_Text">push</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">t</span><span class="ActionScriptBracket/Brace">)</span>;
                    <span class="ActionScriptReserved">else</span> <span class="ActionScriptReserved">if</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">t</span> <span class="ActionScriptOperator">-</span> <span class="ActionScriptDefault_Text">lastTime</span> <span class="ActionScriptOperator">&gt;</span> 0.01<span class="ActionScriptBracket/Brace">)</span>
                        <span class="ActionScriptDefault_Text">times</span>.<span class="ActionScriptDefault_Text">push</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">t</span><span class="ActionScriptBracket/Brace">)</span>;
                    <span class="ActionScriptDefault_Text">lastTime</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">t</span>;    
                <span class="ActionScriptBracket/Brace">}</span>
                
                <span class="ActionScriptComment">// build the MatrixChannel3D&apos;s for this object
</span>                <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">mcs</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">Object</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">Object</span><span class="ActionScriptBracket/Brace">()</span>;
                <span class="ActionScriptReserved">for</span> <span class="ActionScriptReserved">each</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">channel</span> <span class="ActionScriptReserved">in</span> <span class="ActionScriptDefault_Text">channels</span><span class="ActionScriptBracket/Brace">)</span>
                <span class="ActionScriptBracket/Brace">{</span>
                    <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">animationChannel</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">MatrixChannel3D</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">buildAnimationChannel</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">target</span>, <span class="ActionScriptDefault_Text">channel</span><span class="ActionScriptBracket/Brace">)</span>;
                    <span class="ActionScriptReserved">if</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">animationChannel</span><span class="ActionScriptBracket/Brace">)</span> 
                        <span class="ActionScriptDefault_Text">mcs</span><span class="ActionScriptBracket/Brace">[</span> <span class="ActionScriptDefault_Text">channel</span>.<span class="ActionScriptDefault_Text">syntax</span>.<span class="ActionScriptDefault_Text">targetSID</span> <span class="ActionScriptBracket/Brace">]</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">buildAnimationChannel</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">target</span>, <span class="ActionScriptDefault_Text">channel</span><span class="ActionScriptBracket/Brace">)</span>;
                <span class="ActionScriptBracket/Brace">}</span>
                    
                <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">bakedChannel</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">MatrixChannel3D</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">MatrixChannel3D</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">target</span><span class="ActionScriptBracket/Brace">)</span>;
                
                <span class="ActionScriptComment">// build a baked channel
</span>                <span class="ActionScriptReserved">for</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">i</span> <span class="ActionScriptOperator">=</span> 0; <span class="ActionScriptDefault_Text">i</span> <span class="ActionScriptOperator">&lt;</span> <span class="ActionScriptDefault_Text">times</span>.<span class="ActionScriptDefault_Text">length</span>; <span class="ActionScriptDefault_Text">i</span><span class="ActionScriptOperator">++</span><span class="ActionScriptBracket/Brace">)</span>
                <span class="ActionScriptBracket/Brace">{</span>
                    <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">keyframeTime</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">Number</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">times</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">i</span><span class="ActionScriptBracket/Brace">]</span>;
                    <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">bakedMatrix</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">Matrix3D</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">Matrix3D</span>.<span class="ActionScriptDefault_Text">IDENTITY</span>;
                    
                    <span class="ActionScriptComment">// loop over the DaeNode&apos;s transform-stack
</span>                    <span class="ActionScriptReserved">for</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">j</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">int</span> <span class="ActionScriptOperator">=</span> 0; <span class="ActionScriptDefault_Text">j</span> <span class="ActionScriptOperator">&lt;</span> <span class="ActionScriptDefault_Text">node</span>.<span class="ActionScriptDefault_Text">transforms</span>.<span class="ActionScriptDefault_Text">length</span>; <span class="ActionScriptDefault_Text">j</span><span class="ActionScriptOperator">++</span><span class="ActionScriptBracket/Brace">)</span>
                    <span class="ActionScriptBracket/Brace">{</span>
                        <span class="ActionScriptDefault_Text">transform</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">node</span>.<span class="ActionScriptDefault_Text">transforms</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">j</span><span class="ActionScriptBracket/Brace">]</span>;
                        
                        <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">matrixChannel</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">MatrixChannel3D</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">mcs</span><span class="ActionScriptBracket/Brace">[</span> <span class="ActionScriptDefault_Text">transform</span>.<span class="ActionScriptDefault_Text">sid</span> <span class="ActionScriptBracket/Brace">]</span>;
                        
                        <span class="ActionScriptReserved">if</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">matrixChannel</span><span class="ActionScriptBracket/Brace">)</span>
                        <span class="ActionScriptBracket/Brace">{</span>
                            <span class="ActionScriptComment">// this transform is animated, so lets determine the matrix for the current keyframeTime
</span>                            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">time</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">Number</span>;
                            <span class="ActionScriptReserved">if</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">keyframeTime</span> <span class="ActionScriptOperator">&lt;</span> <span class="ActionScriptDefault_Text">matrixChannel</span>.<span class="ActionScriptDefault_Text">startTime</span><span class="ActionScriptBracket/Brace">)</span>
                                <span class="ActionScriptDefault_Text">time</span> <span class="ActionScriptOperator">=</span> 0;
                            <span class="ActionScriptReserved">else</span> <span class="ActionScriptReserved">if</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">keyframeTime</span> <span class="ActionScriptOperator">&gt;</span> <span class="ActionScriptDefault_Text">matrixChannel</span>.<span class="ActionScriptDefault_Text">endTime</span><span class="ActionScriptBracket/Brace">)</span>
                                <span class="ActionScriptDefault_Text">time</span> <span class="ActionScriptOperator">=</span> 1;
                            <span class="ActionScriptReserved">else</span>
                                <span class="ActionScriptDefault_Text">time</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">keyframeTime</span> <span class="ActionScriptOperator">/</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">matrixChannel</span>.<span class="ActionScriptDefault_Text">endTime</span> <span class="ActionScriptOperator">-</span> <span class="ActionScriptDefault_Text">matrixChannel</span>.<span class="ActionScriptDefault_Text">startTime</span><span class="ActionScriptBracket/Brace">)</span>;
                                
                            <span class="ActionScriptComment">// update the channel by time, so the matrix for the current keyframe is setup
</span>                            <span class="ActionScriptDefault_Text">matrixChannel</span>.<span class="ActionScriptDefault_Text">updateToTime</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">time</span><span class="ActionScriptBracket/Brace">)</span>;
                            
                            <span class="ActionScriptComment">// bake the matrix
</span>                            <span class="ActionScriptDefault_Text">bakedMatrix</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">Matrix3D</span>.<span class="ActionScriptDefault_Text">multiply</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">bakedMatrix</span>, <span class="ActionScriptDefault_Text">target</span>.<span class="ActionScriptDefault_Text">transform</span><span class="ActionScriptBracket/Brace">)</span>;
                        <span class="ActionScriptBracket/Brace">}</span>
                        <span class="ActionScriptReserved">else</span>
                        <span class="ActionScriptBracket/Brace">{</span>
                            <span class="ActionScriptComment">// this transform isn&apos;t animated, simply bake the transform into the matrix
</span>                            <span class="ActionScriptDefault_Text">bakedMatrix</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">Matrix3D</span>.<span class="ActionScriptDefault_Text">multiply</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">bakedMatrix</span>, <span class="ActionScriptDefault_Text">buildMatrixFromTransform</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">transform</span><span class="ActionScriptBracket/Brace">))</span>;
                        <span class="ActionScriptBracket/Brace">}</span>
                    <span class="ActionScriptBracket/Brace">}</span>
                    
                    <span class="ActionScriptComment">// now we can add the baked matrix as a new keyframe
</span>                    <span class="ActionScriptDefault_Text">bakedChannel</span>.<span class="ActionScriptDefault_Text">addKeyFrame</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">AnimationKeyFrame3D</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">&quot;frame_&quot;</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptDefault_Text">i</span>, <span class="ActionScriptDefault_Text">keyframeTime</span>, <span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">bakedMatrix</span><span class="ActionScriptBracket/Brace">]))</span>;
                <span class="ActionScriptBracket/Brace">}</span>
                
                <span class="ActionScriptDefault_Text">_channelsByTarget</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">target</span><span class="ActionScriptBracket/Brace">]</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">bakedChannel</span><span class="ActionScriptBracket/Brace">]</span>;
            <span class="ActionScriptBracket/Brace">}</span>
        <span class="ActionScriptBracket/Brace">}</span>
        
        <span class="ActionScriptASDoc">/**
         * Build a color from RGB values.
         * 
         * @param    rgb
         *  
         * @return
         */</span>
        <span class="ActionScriptReserved">protected</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">buildColor</span><span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptDefault_Text">rgb</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">Array</span> <span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">uint</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">r</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">uint</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">rgb</span><span class="ActionScriptBracket/Brace">[</span>0<span class="ActionScriptBracket/Brace">]</span> <span class="ActionScriptOperator">*</span> 0<span class="ActionScriptDefault_Text">xff</span>;
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">g</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">uint</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">rgb</span><span class="ActionScriptBracket/Brace">[</span>1<span class="ActionScriptBracket/Brace">]</span> <span class="ActionScriptOperator">*</span> 0<span class="ActionScriptDefault_Text">xff</span>;
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">b</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">uint</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">rgb</span><span class="ActionScriptBracket/Brace">[</span>2<span class="ActionScriptBracket/Brace">]</span> <span class="ActionScriptOperator">*</span> 0<span class="ActionScriptDefault_Text">xff</span>;
            <span class="ActionScriptReserved">return</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">r</span><span class="ActionScriptOperator">&lt;&lt;</span>16<span class="ActionScriptOperator">|</span><span class="ActionScriptDefault_Text">g</span><span class="ActionScriptOperator">&lt;&lt;</span>8<span class="ActionScriptOperator">|</span><span class="ActionScriptDefault_Text">b</span><span class="ActionScriptBracket/Brace">)</span>;
        <span class="ActionScriptBracket/Brace">}</span>
        
        <span class="ActionScriptASDoc">/**
         * Creates the faces for a COLLADA primitive. @see org.ascollada.core.DaePrimitive
         * 
         * @param     primitive
         * @param    geometry
         * @param    voffset
         * 
         * @return     The created faces.
         */</span> 
        <span class="ActionScriptReserved">protected</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">buildFaces</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">primitive</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">DaePrimitive</span>, <span class="ActionScriptDefault_Text">geometry</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">GeometryObject3D</span>, <span class="ActionScriptDefault_Text">voffset</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">uint</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">:</span><span class="ActionScriptReserved">void</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">faces</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">Array</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">Array</span><span class="ActionScriptBracket/Brace">()</span>;
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">material</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">MaterialObject3D</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">this</span>.<span class="ActionScriptDefault_Text">materials</span>.<span class="ActionScriptDefault_Text">getMaterialByName</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">primitive</span>.<span class="ActionScriptDefault_Text">material</span><span class="ActionScriptBracket/Brace">)</span>;
            
            <span class="ActionScriptDefault_Text">material</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">material</span> <span class="ActionScriptOperator">||</span> <span class="ActionScriptDefault_Text">MaterialObject3D</span>.<span class="ActionScriptDefault_Text">DEFAULT</span>;
            
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">instanceMaterial</span> <span class="ActionScriptOperator">:</span> <span class="ActionScriptDefault_Text">DaeInstanceMaterial</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">_bindVertexInputs</span><span class="ActionScriptBracket/Brace">[</span> <span class="ActionScriptDefault_Text">material</span> <span class="ActionScriptBracket/Brace">]</span>;
            
            <span class="ActionScriptComment">// retreive correct texcoord-set for the material.
</span>            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">setID</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">int</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">this</span>.<span class="ActionScriptDefault_Text">forceCoordSet</span>;
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">textureSet</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">String</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">_textureSets</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">primitive</span>.<span class="ActionScriptDefault_Text">material</span><span class="ActionScriptBracket/Brace">]</span>;
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">geom</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">DaeGeometry</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">primitive</span>.<span class="ActionScriptDefault_Text">mesh</span>.<span class="ActionScriptDefault_Text">geometry</span>;
            
            <span class="ActionScriptReserved">if</span><span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptDefault_Text">textureSet</span> <span class="ActionScriptOperator">&amp;&amp;</span> <span class="ActionScriptDefault_Text">textureSet</span>.<span class="ActionScriptDefault_Text">length</span> <span class="ActionScriptOperator">&amp;&amp;</span> <span class="ActionScriptDefault_Text">geom</span> <span class="ActionScriptBracket/Brace">)</span>
            <span class="ActionScriptBracket/Brace">{</span>
                <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">instGeom</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">DaeInstanceGeometry</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">this</span>.<span class="ActionScriptDefault_Text">document</span>.<span class="ActionScriptDefault_Text">getDaeInstanceGeometry</span><span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptDefault_Text">geom</span>.<span class="ActionScriptDefault_Text">id</span> <span class="ActionScriptBracket/Brace">)</span>;
                <span class="ActionScriptReserved">if</span><span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptDefault_Text">instGeom</span> <span class="ActionScriptBracket/Brace">)</span>
                <span class="ActionScriptBracket/Brace">{</span>
                    <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">vinput</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">DaeBindVertexInput</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">instGeom</span>.<span class="ActionScriptDefault_Text">findBindVertexInput</span><span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptDefault_Text">primitive</span>.<span class="ActionScriptDefault_Text">material</span>, <span class="ActionScriptDefault_Text">textureSet</span> <span class="ActionScriptBracket/Brace">)</span>;
                    <span class="ActionScriptReserved">if</span><span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptDefault_Text">vinput</span> <span class="ActionScriptBracket/Brace">)</span>
                    <span class="ActionScriptBracket/Brace">{</span>
                        <span class="ActionScriptDefault_Text">PaperLogger</span>.<span class="ActionScriptDefault_Text">info</span><span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptString">&quot;using input set #&quot;</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptDefault_Text">vinput</span>.<span class="ActionScriptDefault_Text">input_set</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptString">&quot; for material &quot;</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptDefault_Text">primitive</span>.<span class="ActionScriptDefault_Text">material</span> <span class="ActionScriptBracket/Brace">)</span>;
                        <span class="ActionScriptDefault_Text">setID</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">vinput</span>.<span class="ActionScriptDefault_Text">input_set</span>;
                    <span class="ActionScriptBracket/Brace">}</span>
                <span class="ActionScriptBracket/Brace">}</span>
            <span class="ActionScriptBracket/Brace">}</span>
            
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">texCoordSet</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">Array</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">primitive</span>.<span class="ActionScriptDefault_Text">getTexCoords</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">setID</span><span class="ActionScriptBracket/Brace">)</span>; 
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">texcoords</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">Array</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">Array</span><span class="ActionScriptBracket/Brace">()</span>;
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">i</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">int</span>, <span class="ActionScriptDefault_Text">j</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">int</span> <span class="ActionScriptOperator">=</span> 0, <span class="ActionScriptDefault_Text">k</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">int</span>;

            <span class="ActionScriptComment">// texture coords
</span>            <span class="ActionScriptReserved">for</span><span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptDefault_Text">i</span> <span class="ActionScriptOperator">=</span> 0; <span class="ActionScriptDefault_Text">i</span> <span class="ActionScriptOperator">&lt;</span> <span class="ActionScriptDefault_Text">texCoordSet</span>.<span class="ActionScriptDefault_Text">length</span>; <span class="ActionScriptDefault_Text">i</span><span class="ActionScriptOperator">++</span> <span class="ActionScriptBracket/Brace">)</span> 
                <span class="ActionScriptDefault_Text">texcoords</span>.<span class="ActionScriptDefault_Text">push</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">NumberUV</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">texCoordSet</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">i</span><span class="ActionScriptBracket/Brace">][</span>0<span class="ActionScriptBracket/Brace">]</span>, <span class="ActionScriptDefault_Text">texCoordSet</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">i</span><span class="ActionScriptBracket/Brace">][</span>1<span class="ActionScriptBracket/Brace">]))</span>;
            
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">hasUV</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">Boolean</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">texcoords</span>.<span class="ActionScriptDefault_Text">length</span> <span class="ActionScriptOperator">==</span> <span class="ActionScriptDefault_Text">primitive</span>.<span class="ActionScriptDefault_Text">vertices</span>.<span class="ActionScriptDefault_Text">length</span><span class="ActionScriptBracket/Brace">)</span>;

            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">idx</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">Array</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">Array</span><span class="ActionScriptBracket/Brace">()</span>;
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">v</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">Array</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">Array</span><span class="ActionScriptBracket/Brace">()</span>;
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">uv</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">Array</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">Array</span><span class="ActionScriptBracket/Brace">()</span>;
        
            <span class="ActionScriptReserved">switch</span><span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptDefault_Text">primitive</span>.<span class="ActionScriptDefault_Text">type</span> <span class="ActionScriptBracket/Brace">)</span> 
            <span class="ActionScriptBracket/Brace">{</span>
                <span class="ActionScriptComment">// Each line described by the mesh has two vertices. The first line is formed 
</span>                <span class="ActionScriptComment">// from first and second vertices. The second line is formed from the third and fourth 
</span>                <span class="ActionScriptComment">// vertices and so on.
</span>                <span class="ActionScriptReserved">case</span> <span class="ActionScriptDefault_Text">ASCollada</span>.<span class="ActionScriptDefault_Text">DAE_LINES_ELEMENT</span><span class="ActionScriptOperator">:</span>
                    <span class="ActionScriptReserved">for</span><span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptDefault_Text">i</span> <span class="ActionScriptOperator">=</span> 0; <span class="ActionScriptDefault_Text">i</span> <span class="ActionScriptOperator">&lt;</span> <span class="ActionScriptDefault_Text">primitive</span>.<span class="ActionScriptDefault_Text">vertices</span>.<span class="ActionScriptDefault_Text">length</span>; <span class="ActionScriptDefault_Text">i</span> <span class="ActionScriptOperator">+=</span> 2 <span class="ActionScriptBracket/Brace">)</span> 
                    <span class="ActionScriptBracket/Brace">{</span>
                        <span class="ActionScriptDefault_Text">v</span><span class="ActionScriptBracket/Brace">[</span>0<span class="ActionScriptBracket/Brace">]</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">geometry</span>.<span class="ActionScriptDefault_Text">vertices</span><span class="ActionScriptBracket/Brace">[</span> <span class="ActionScriptDefault_Text">primitive</span>.<span class="ActionScriptDefault_Text">vertices</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">i</span><span class="ActionScriptBracket/Brace">]</span> <span class="ActionScriptBracket/Brace">]</span>;
                        <span class="ActionScriptDefault_Text">v</span><span class="ActionScriptBracket/Brace">[</span>1<span class="ActionScriptBracket/Brace">]</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">geometry</span>.<span class="ActionScriptDefault_Text">vertices</span><span class="ActionScriptBracket/Brace">[</span> <span class="ActionScriptDefault_Text">primitive</span>.<span class="ActionScriptDefault_Text">vertices</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">i</span><span class="ActionScriptOperator">+</span>1<span class="ActionScriptBracket/Brace">]</span> <span class="ActionScriptBracket/Brace">]</span>;
                        <span class="ActionScriptDefault_Text">uv</span><span class="ActionScriptBracket/Brace">[</span>0<span class="ActionScriptBracket/Brace">]</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">hasUV</span> <span class="ActionScriptOperator">?</span> <span class="ActionScriptDefault_Text">texcoords</span><span class="ActionScriptBracket/Brace">[</span>  <span class="ActionScriptDefault_Text">i</span>  <span class="ActionScriptBracket/Brace">]</span> <span class="ActionScriptOperator">:</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">NumberUV</span><span class="ActionScriptBracket/Brace">()</span>;
                        <span class="ActionScriptDefault_Text">uv</span><span class="ActionScriptBracket/Brace">[</span>1<span class="ActionScriptBracket/Brace">]</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">hasUV</span> <span class="ActionScriptOperator">?</span> <span class="ActionScriptDefault_Text">texcoords</span><span class="ActionScriptBracket/Brace">[</span> <span class="ActionScriptDefault_Text">i</span><span class="ActionScriptOperator">+</span>1 <span class="ActionScriptBracket/Brace">]</span> <span class="ActionScriptOperator">:</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">NumberUV</span><span class="ActionScriptBracket/Brace">()</span>;
                        <span class="ActionScriptComment">//geometry.faces.push( new Triangle3D(instance, [v[0], v[1], v[1]], material, [uv[0], uv[1], uv[1]]) );
</span>                    <span class="ActionScriptBracket/Brace">}</span>
                    <span class="ActionScriptReserved">break</span>;
                    
                <span class="ActionScriptComment">// simple triangles
</span>                <span class="ActionScriptReserved">case</span> <span class="ActionScriptDefault_Text">ASCollada</span>.<span class="ActionScriptDefault_Text">DAE_TRIANGLES_ELEMENT</span><span class="ActionScriptOperator">:</span>
                    <span class="ActionScriptReserved">for</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">i</span> <span class="ActionScriptOperator">=</span> 0, <span class="ActionScriptDefault_Text">j</span> <span class="ActionScriptOperator">=</span> 0; <span class="ActionScriptDefault_Text">i</span> <span class="ActionScriptOperator">&lt;</span> <span class="ActionScriptDefault_Text">primitive</span>.<span class="ActionScriptDefault_Text">vertices</span>.<span class="ActionScriptDefault_Text">length</span>; <span class="ActionScriptDefault_Text">i</span> <span class="ActionScriptOperator">+=</span> 3, <span class="ActionScriptDefault_Text">j</span><span class="ActionScriptOperator">++</span><span class="ActionScriptBracket/Brace">)</span> 
                    <span class="ActionScriptBracket/Brace">{</span>
                        <span class="ActionScriptDefault_Text">idx</span><span class="ActionScriptBracket/Brace">[</span>0<span class="ActionScriptBracket/Brace">]</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">voffset</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptDefault_Text">primitive</span>.<span class="ActionScriptDefault_Text">vertices</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">i</span><span class="ActionScriptBracket/Brace">]</span>;
                        <span class="ActionScriptDefault_Text">idx</span><span class="ActionScriptBracket/Brace">[</span>1<span class="ActionScriptBracket/Brace">]</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">voffset</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptDefault_Text">primitive</span>.<span class="ActionScriptDefault_Text">vertices</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">i</span><span class="ActionScriptOperator">+</span>1<span class="ActionScriptBracket/Brace">]</span>;
                        <span class="ActionScriptDefault_Text">idx</span><span class="ActionScriptBracket/Brace">[</span>2<span class="ActionScriptBracket/Brace">]</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">voffset</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptDefault_Text">primitive</span>.<span class="ActionScriptDefault_Text">vertices</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">i</span><span class="ActionScriptOperator">+</span>2<span class="ActionScriptBracket/Brace">]</span>;
                        
                        <span class="ActionScriptDefault_Text">v</span><span class="ActionScriptBracket/Brace">[</span>0<span class="ActionScriptBracket/Brace">]</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">geometry</span>.<span class="ActionScriptDefault_Text">vertices</span><span class="ActionScriptBracket/Brace">[</span> <span class="ActionScriptDefault_Text">idx</span><span class="ActionScriptBracket/Brace">[</span>0<span class="ActionScriptBracket/Brace">]</span> <span class="ActionScriptBracket/Brace">]</span>;
                        <span class="ActionScriptDefault_Text">v</span><span class="ActionScriptBracket/Brace">[</span>1<span class="ActionScriptBracket/Brace">]</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">geometry</span>.<span class="ActionScriptDefault_Text">vertices</span><span class="ActionScriptBracket/Brace">[</span> <span class="ActionScriptDefault_Text">idx</span><span class="ActionScriptBracket/Brace">[</span>1<span class="ActionScriptBracket/Brace">]</span> <span class="ActionScriptBracket/Brace">]</span>;
                        <span class="ActionScriptDefault_Text">v</span><span class="ActionScriptBracket/Brace">[</span>2<span class="ActionScriptBracket/Brace">]</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">geometry</span>.<span class="ActionScriptDefault_Text">vertices</span><span class="ActionScriptBracket/Brace">[</span> <span class="ActionScriptDefault_Text">idx</span><span class="ActionScriptBracket/Brace">[</span>2<span class="ActionScriptBracket/Brace">]</span> <span class="ActionScriptBracket/Brace">]</span>;
                        
                        <span class="ActionScriptDefault_Text">uv</span><span class="ActionScriptBracket/Brace">[</span>0<span class="ActionScriptBracket/Brace">]</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">hasUV</span> <span class="ActionScriptOperator">?</span> <span class="ActionScriptDefault_Text">texcoords</span><span class="ActionScriptBracket/Brace">[</span> <span class="ActionScriptDefault_Text">i</span><span class="ActionScriptOperator">+</span>0 <span class="ActionScriptBracket/Brace">]</span> <span class="ActionScriptOperator">:</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">NumberUV</span><span class="ActionScriptBracket/Brace">()</span>;
                        <span class="ActionScriptDefault_Text">uv</span><span class="ActionScriptBracket/Brace">[</span>1<span class="ActionScriptBracket/Brace">]</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">hasUV</span> <span class="ActionScriptOperator">?</span> <span class="ActionScriptDefault_Text">texcoords</span><span class="ActionScriptBracket/Brace">[</span> <span class="ActionScriptDefault_Text">i</span><span class="ActionScriptOperator">+</span>1 <span class="ActionScriptBracket/Brace">]</span> <span class="ActionScriptOperator">:</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">NumberUV</span><span class="ActionScriptBracket/Brace">()</span>;
                        <span class="ActionScriptDefault_Text">uv</span><span class="ActionScriptBracket/Brace">[</span>2<span class="ActionScriptBracket/Brace">]</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">hasUV</span> <span class="ActionScriptOperator">?</span> <span class="ActionScriptDefault_Text">texcoords</span><span class="ActionScriptBracket/Brace">[</span> <span class="ActionScriptDefault_Text">i</span><span class="ActionScriptOperator">+</span>2 <span class="ActionScriptBracket/Brace">]</span> <span class="ActionScriptOperator">:</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">NumberUV</span><span class="ActionScriptBracket/Brace">()</span>;
                
                        <span class="ActionScriptDefault_Text">geometry</span>.<span class="ActionScriptDefault_Text">faces</span>.<span class="ActionScriptDefault_Text">push</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">Triangle3D</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptReserved">null</span>, <span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">v</span><span class="ActionScriptBracket/Brace">[</span>0<span class="ActionScriptBracket/Brace">]</span>, <span class="ActionScriptDefault_Text">v</span><span class="ActionScriptBracket/Brace">[</span>1<span class="ActionScriptBracket/Brace">]</span>, <span class="ActionScriptDefault_Text">v</span><span class="ActionScriptBracket/Brace">[</span>2<span class="ActionScriptBracket/Brace">]]</span>, <span class="ActionScriptDefault_Text">material</span>, <span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">uv</span><span class="ActionScriptBracket/Brace">[</span>0<span class="ActionScriptBracket/Brace">]</span>, <span class="ActionScriptDefault_Text">uv</span><span class="ActionScriptBracket/Brace">[</span>1<span class="ActionScriptBracket/Brace">]</span>, <span class="ActionScriptDefault_Text">uv</span><span class="ActionScriptBracket/Brace">[</span>2<span class="ActionScriptBracket/Brace">]]))</span>;
                    <span class="ActionScriptBracket/Brace">}</span>
                    <span class="ActionScriptReserved">break</span>;
                <span class="ActionScriptComment">// polygon with *no* holes
</span>                <span class="ActionScriptReserved">case</span> <span class="ActionScriptDefault_Text">ASCollada</span>.<span class="ActionScriptDefault_Text">DAE_POLYLIST_ELEMENT</span><span class="ActionScriptOperator">:</span>
                    <span class="ActionScriptReserved">for</span><span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptDefault_Text">i</span> <span class="ActionScriptOperator">=</span> 0, <span class="ActionScriptDefault_Text">k</span> <span class="ActionScriptOperator">=</span> 0; <span class="ActionScriptDefault_Text">i</span> <span class="ActionScriptOperator">&lt;</span> <span class="ActionScriptDefault_Text">primitive</span>.<span class="ActionScriptDefault_Text">vcount</span>.<span class="ActionScriptDefault_Text">length</span>; <span class="ActionScriptDefault_Text">i</span><span class="ActionScriptOperator">++</span> <span class="ActionScriptBracket/Brace">)</span> 
                    <span class="ActionScriptBracket/Brace">{</span>
                        <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">poly</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">Array</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">Array</span><span class="ActionScriptBracket/Brace">()</span>;
                        <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">uvs</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">Array</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">Array</span><span class="ActionScriptBracket/Brace">()</span>;
                        
                        <span class="ActionScriptReserved">for</span><span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptDefault_Text">j</span> <span class="ActionScriptOperator">=</span> 0; <span class="ActionScriptDefault_Text">j</span> <span class="ActionScriptOperator">&lt;</span> <span class="ActionScriptDefault_Text">primitive</span>.<span class="ActionScriptDefault_Text">vcount</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">i</span><span class="ActionScriptBracket/Brace">]</span>; <span class="ActionScriptDefault_Text">j</span><span class="ActionScriptOperator">++</span> <span class="ActionScriptBracket/Brace">)</span> 
                        <span class="ActionScriptBracket/Brace">{</span>
                            <span class="ActionScriptDefault_Text">uvs</span>.<span class="ActionScriptDefault_Text">push</span><span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">hasUV</span> <span class="ActionScriptOperator">?</span> <span class="ActionScriptDefault_Text">texcoords</span><span class="ActionScriptBracket/Brace">[</span> <span class="ActionScriptDefault_Text">k</span> <span class="ActionScriptBracket/Brace">]</span> <span class="ActionScriptOperator">:</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">NumberUV</span><span class="ActionScriptBracket/Brace">())</span> <span class="ActionScriptBracket/Brace">)</span>;
                            <span class="ActionScriptDefault_Text">poly</span>.<span class="ActionScriptDefault_Text">push</span><span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptDefault_Text">geometry</span>.<span class="ActionScriptDefault_Text">vertices</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">primitive</span>.<span class="ActionScriptDefault_Text">vertices</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">k</span><span class="ActionScriptOperator">++</span><span class="ActionScriptBracket/Brace">]]</span> <span class="ActionScriptBracket/Brace">)</span>;
                        <span class="ActionScriptBracket/Brace">}</span>
                        
                        <span class="ActionScriptReserved">if</span><span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptOperator">!</span><span class="ActionScriptDefault_Text">geometry</span> <span class="ActionScriptOperator">||</span> <span class="ActionScriptOperator">!</span><span class="ActionScriptDefault_Text">geometry</span>.<span class="ActionScriptDefault_Text">faces</span> <span class="ActionScriptOperator">||</span> <span class="ActionScriptOperator">!</span><span class="ActionScriptDefault_Text">geometry</span>.<span class="ActionScriptDefault_Text">vertices</span> <span class="ActionScriptBracket/Brace">)</span>
                            <span class="ActionScriptReserved">throw</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">Error</span><span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptString">&quot;no geometry&quot;</span> <span class="ActionScriptBracket/Brace">)</span>;
                            
                        <span class="ActionScriptDefault_Text">v</span><span class="ActionScriptBracket/Brace">[</span>0<span class="ActionScriptBracket/Brace">]</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">poly</span><span class="ActionScriptBracket/Brace">[</span>0<span class="ActionScriptBracket/Brace">]</span>;
                        <span class="ActionScriptDefault_Text">uv</span><span class="ActionScriptBracket/Brace">[</span>0<span class="ActionScriptBracket/Brace">]</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">uvs</span><span class="ActionScriptBracket/Brace">[</span>0<span class="ActionScriptBracket/Brace">]</span>;

                        <span class="ActionScriptReserved">for</span><span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptDefault_Text">j</span> <span class="ActionScriptOperator">=</span> 1; <span class="ActionScriptDefault_Text">j</span> <span class="ActionScriptOperator">&lt;</span> <span class="ActionScriptDefault_Text">poly</span>.<span class="ActionScriptDefault_Text">length</span> <span class="ActionScriptOperator">-</span> 1; <span class="ActionScriptDefault_Text">j</span><span class="ActionScriptOperator">++</span> <span class="ActionScriptBracket/Brace">)</span>
                        <span class="ActionScriptBracket/Brace">{</span>
                            <span class="ActionScriptDefault_Text">v</span><span class="ActionScriptBracket/Brace">[</span>1<span class="ActionScriptBracket/Brace">]</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">poly</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">j</span><span class="ActionScriptBracket/Brace">]</span>;
                            <span class="ActionScriptDefault_Text">v</span><span class="ActionScriptBracket/Brace">[</span>2<span class="ActionScriptBracket/Brace">]</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">poly</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">j</span><span class="ActionScriptOperator">+</span>1<span class="ActionScriptBracket/Brace">]</span>;
                            <span class="ActionScriptDefault_Text">uv</span><span class="ActionScriptBracket/Brace">[</span>1<span class="ActionScriptBracket/Brace">]</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">uvs</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">j</span><span class="ActionScriptBracket/Brace">]</span>;
                            <span class="ActionScriptDefault_Text">uv</span><span class="ActionScriptBracket/Brace">[</span>2<span class="ActionScriptBracket/Brace">]</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">uvs</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">j</span><span class="ActionScriptOperator">+</span>1<span class="ActionScriptBracket/Brace">]</span>;
                            
                            <span class="ActionScriptReserved">if</span><span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptDefault_Text">v</span><span class="ActionScriptBracket/Brace">[</span>0<span class="ActionScriptBracket/Brace">]</span> <span class="ActionScriptReserved">is</span> <span class="ActionScriptDefault_Text">Vertex3D</span> <span class="ActionScriptOperator">&amp;&amp;</span> <span class="ActionScriptDefault_Text">v</span><span class="ActionScriptBracket/Brace">[</span>1<span class="ActionScriptBracket/Brace">]</span> <span class="ActionScriptReserved">is</span> <span class="ActionScriptDefault_Text">Vertex3D</span> <span class="ActionScriptOperator">&amp;&amp;</span> <span class="ActionScriptDefault_Text">v</span><span class="ActionScriptBracket/Brace">[</span>2<span class="ActionScriptBracket/Brace">]</span> <span class="ActionScriptReserved">is</span> <span class="ActionScriptDefault_Text">Vertex3D</span><span class="ActionScriptBracket/Brace">)</span>
                            <span class="ActionScriptBracket/Brace">{</span>
                                <span class="ActionScriptDefault_Text">geometry</span>.<span class="ActionScriptDefault_Text">faces</span>.<span class="ActionScriptDefault_Text">push</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">Triangle3D</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptReserved">null</span>, <span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">v</span><span class="ActionScriptBracket/Brace">[</span>0<span class="ActionScriptBracket/Brace">]</span>, <span class="ActionScriptDefault_Text">v</span><span class="ActionScriptBracket/Brace">[</span>1<span class="ActionScriptBracket/Brace">]</span>, <span class="ActionScriptDefault_Text">v</span><span class="ActionScriptBracket/Brace">[</span>2<span class="ActionScriptBracket/Brace">]]</span>, <span class="ActionScriptDefault_Text">material</span>, <span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">uv</span><span class="ActionScriptBracket/Brace">[</span>0<span class="ActionScriptBracket/Brace">]</span>, <span class="ActionScriptDefault_Text">uv</span><span class="ActionScriptBracket/Brace">[</span>1<span class="ActionScriptBracket/Brace">]</span>, <span class="ActionScriptDefault_Text">uv</span><span class="ActionScriptBracket/Brace">[</span>2<span class="ActionScriptBracket/Brace">]]))</span>;
                            <span class="ActionScriptBracket/Brace">}</span>
                            <span class="ActionScriptReserved">else</span>
                            <span class="ActionScriptBracket/Brace">{</span>
                            <span class="ActionScriptComment">//    PaperLogger.error(&quot;&quot; +primitive.name+ &quot; &quot;+ poly.length +&quot; &quot;+primitive.vertices.length+&quot; &quot;+geometry.vertices.length);
</span>                            <span class="ActionScriptBracket/Brace">}</span>
                        <span class="ActionScriptBracket/Brace">}</span>
                    <span class="ActionScriptBracket/Brace">}</span>
                    <span class="ActionScriptReserved">break</span>;
                
                <span class="ActionScriptComment">// polygons *with* holes (but holes not yet processed...)
</span>                <span class="ActionScriptReserved">case</span> <span class="ActionScriptDefault_Text">ASCollada</span>.<span class="ActionScriptDefault_Text">DAE_POLYGONS_ELEMENT</span><span class="ActionScriptOperator">:</span>
                    <span class="ActionScriptReserved">for</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">i</span> <span class="ActionScriptOperator">=</span> 0, <span class="ActionScriptDefault_Text">k</span> <span class="ActionScriptOperator">=</span> 0; <span class="ActionScriptDefault_Text">i</span> <span class="ActionScriptOperator">&lt;</span> <span class="ActionScriptDefault_Text">primitive</span>.<span class="ActionScriptDefault_Text">polygons</span>.<span class="ActionScriptDefault_Text">length</span>; <span class="ActionScriptDefault_Text">i</span><span class="ActionScriptOperator">++</span><span class="ActionScriptBracket/Brace">)</span>
                    <span class="ActionScriptBracket/Brace">{</span>
                        <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">p</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">Array</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">primitive</span>.<span class="ActionScriptDefault_Text">polygons</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">i</span><span class="ActionScriptBracket/Brace">]</span>;
                        <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">np</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">Array</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">Array</span><span class="ActionScriptBracket/Brace">()</span>;
                        <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">nuv</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">Array</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">Array</span><span class="ActionScriptBracket/Brace">()</span>;
                        
                        <span class="ActionScriptReserved">for</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">j</span> <span class="ActionScriptOperator">=</span> 0; <span class="ActionScriptDefault_Text">j</span> <span class="ActionScriptOperator">&lt;</span> <span class="ActionScriptDefault_Text">p</span>.<span class="ActionScriptDefault_Text">length</span>; <span class="ActionScriptDefault_Text">j</span><span class="ActionScriptOperator">++</span><span class="ActionScriptBracket/Brace">)</span>
                        <span class="ActionScriptBracket/Brace">{</span>
                            <span class="ActionScriptDefault_Text">nuv</span>.<span class="ActionScriptDefault_Text">push</span><span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">hasUV</span> <span class="ActionScriptOperator">?</span> <span class="ActionScriptDefault_Text">texcoords</span><span class="ActionScriptBracket/Brace">[</span> <span class="ActionScriptDefault_Text">k</span> <span class="ActionScriptBracket/Brace">]</span> <span class="ActionScriptOperator">:</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">NumberUV</span><span class="ActionScriptBracket/Brace">())</span> <span class="ActionScriptBracket/Brace">)</span>;
                            <span class="ActionScriptDefault_Text">np</span>.<span class="ActionScriptDefault_Text">push</span><span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptDefault_Text">geometry</span>.<span class="ActionScriptDefault_Text">vertices</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">primitive</span>.<span class="ActionScriptDefault_Text">vertices</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">k</span><span class="ActionScriptOperator">++</span><span class="ActionScriptBracket/Brace">]]</span> <span class="ActionScriptBracket/Brace">)</span>;
                        <span class="ActionScriptBracket/Brace">}</span>
                        
                        <span class="ActionScriptDefault_Text">v</span><span class="ActionScriptBracket/Brace">[</span>0<span class="ActionScriptBracket/Brace">]</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">np</span><span class="ActionScriptBracket/Brace">[</span>0<span class="ActionScriptBracket/Brace">]</span>;
                        <span class="ActionScriptDefault_Text">uv</span><span class="ActionScriptBracket/Brace">[</span>0<span class="ActionScriptBracket/Brace">]</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">nuv</span><span class="ActionScriptBracket/Brace">[</span>0<span class="ActionScriptBracket/Brace">]</span>;
                        
                        <span class="ActionScriptReserved">for</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">j</span> <span class="ActionScriptOperator">=</span> 1; <span class="ActionScriptDefault_Text">j</span> <span class="ActionScriptOperator">&lt;</span> <span class="ActionScriptDefault_Text">np</span>.<span class="ActionScriptDefault_Text">length</span> <span class="ActionScriptOperator">-</span> 1; <span class="ActionScriptDefault_Text">j</span><span class="ActionScriptOperator">++</span><span class="ActionScriptBracket/Brace">)</span>
                        <span class="ActionScriptBracket/Brace">{</span>
                            <span class="ActionScriptDefault_Text">v</span><span class="ActionScriptBracket/Brace">[</span>1<span class="ActionScriptBracket/Brace">]</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">np</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">j</span><span class="ActionScriptBracket/Brace">]</span>;
                            <span class="ActionScriptDefault_Text">v</span><span class="ActionScriptBracket/Brace">[</span>2<span class="ActionScriptBracket/Brace">]</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">np</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">j</span><span class="ActionScriptOperator">+</span>1<span class="ActionScriptBracket/Brace">]</span>;
                            <span class="ActionScriptDefault_Text">uv</span><span class="ActionScriptBracket/Brace">[</span>1<span class="ActionScriptBracket/Brace">]</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">nuv</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">j</span><span class="ActionScriptBracket/Brace">]</span>;
                            <span class="ActionScriptDefault_Text">uv</span><span class="ActionScriptBracket/Brace">[</span>2<span class="ActionScriptBracket/Brace">]</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">nuv</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">j</span><span class="ActionScriptOperator">+</span>1<span class="ActionScriptBracket/Brace">]</span>;
                
                            <span class="ActionScriptDefault_Text">geometry</span>.<span class="ActionScriptDefault_Text">faces</span>.<span class="ActionScriptDefault_Text">push</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">Triangle3D</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptReserved">null</span>, <span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">v</span><span class="ActionScriptBracket/Brace">[</span>0<span class="ActionScriptBracket/Brace">]</span>, <span class="ActionScriptDefault_Text">v</span><span class="ActionScriptBracket/Brace">[</span>1<span class="ActionScriptBracket/Brace">]</span>, <span class="ActionScriptDefault_Text">v</span><span class="ActionScriptBracket/Brace">[</span>2<span class="ActionScriptBracket/Brace">]]</span>, <span class="ActionScriptDefault_Text">material</span>, <span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">uv</span><span class="ActionScriptBracket/Brace">[</span>0<span class="ActionScriptBracket/Brace">]</span>, <span class="ActionScriptDefault_Text">uv</span><span class="ActionScriptBracket/Brace">[</span>1<span class="ActionScriptBracket/Brace">]</span>, <span class="ActionScriptDefault_Text">uv</span><span class="ActionScriptBracket/Brace">[</span>2<span class="ActionScriptBracket/Brace">]]))</span>;
                        <span class="ActionScriptBracket/Brace">}</span>
                    <span class="ActionScriptBracket/Brace">}</span>
                    <span class="ActionScriptReserved">break</span>;
                        
                <span class="ActionScriptReserved">default</span><span class="ActionScriptOperator">:</span>
                    <span class="ActionScriptReserved">throw</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">Error</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">&quot;Don&apos;t know how to create face for a DaePrimitive with type = &quot;</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptDefault_Text">primitive</span>.<span class="ActionScriptDefault_Text">type</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptBracket/Brace">}</span>
        <span class="ActionScriptBracket/Brace">}</span>
        
        <span class="ActionScriptASDoc">/**
         * 
         * @param    asset
         * @return
         */</span>
        <span class="ActionScriptReserved">protected</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">buildFileInfo</span><span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptDefault_Text">asset</span><span class="ActionScriptOperator">:*</span> <span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">:</span><span class="ActionScriptReserved">void</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptReserved">this</span>.<span class="ActionScriptDefault_Text">filename</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">asset</span> <span class="ActionScriptReserved">is</span> <span class="ActionScriptDefault_Text">String</span> <span class="ActionScriptOperator">?</span> <span class="ActionScriptDefault_Text">String</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">asset</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptOperator">:</span> <span class="ActionScriptString">&quot;./meshes/rawdata_dae&quot;</span>;
            
            <span class="ActionScriptComment">// make sure we&apos;ve got forward slashes!
</span>            <span class="ActionScriptReserved">this</span>.<span class="ActionScriptDefault_Text">filename</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">this</span>.<span class="ActionScriptDefault_Text">filename</span>.<span class="ActionScriptDefault_Text">split</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">&quot;\\&quot;</span><span class="ActionScriptBracket/Brace">)</span>.<span class="ActionScriptDefault_Text">join</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">&quot;/&quot;</span><span class="ActionScriptBracket/Brace">)</span>;
                
            <span class="ActionScriptReserved">if</span><span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptReserved">this</span>.<span class="ActionScriptDefault_Text">filename</span>.<span class="ActionScriptDefault_Text">indexOf</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">&quot;/&quot;</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptOperator">!=</span> <span class="ActionScriptOperator">-</span>1 <span class="ActionScriptBracket/Brace">)</span>
            <span class="ActionScriptBracket/Brace">{</span>
                <span class="ActionScriptComment">// dae is located in a sub-directory of the swf.
</span>                <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">parts</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">Array</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">this</span>.<span class="ActionScriptDefault_Text">filename</span>.<span class="ActionScriptDefault_Text">split</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">&quot;/&quot;</span><span class="ActionScriptBracket/Brace">)</span>;
                <span class="ActionScriptReserved">this</span>.<span class="ActionScriptDefault_Text">fileTitle</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">String</span><span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptDefault_Text">parts</span>.<span class="ActionScriptDefault_Text">pop</span><span class="ActionScriptBracket/Brace">()</span> <span class="ActionScriptBracket/Brace">)</span>;
                <span class="ActionScriptReserved">this</span>.<span class="ActionScriptDefault_Text">baseUrl</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">parts</span>.<span class="ActionScriptDefault_Text">join</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">&quot;/&quot;</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptBracket/Brace">}</span>
            <span class="ActionScriptReserved">else</span>
            <span class="ActionScriptBracket/Brace">{</span>
                <span class="ActionScriptComment">// dae is located in root directory of swf.
</span>                <span class="ActionScriptReserved">this</span>.<span class="ActionScriptDefault_Text">fileTitle</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">this</span>.<span class="ActionScriptDefault_Text">filename</span>;
                <span class="ActionScriptReserved">this</span>.<span class="ActionScriptDefault_Text">baseUrl</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptString">&quot;&quot;</span>;
            <span class="ActionScriptBracket/Brace">}</span>
        <span class="ActionScriptBracket/Brace">}</span>
        
        <span class="ActionScriptASDoc">/**
         * Builds all COLLADA geometries.
         */</span> 
        <span class="ActionScriptReserved">protected</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">buildGeometries</span><span class="ActionScriptBracket/Brace">()</span><span class="ActionScriptOperator">:</span><span class="ActionScriptReserved">void</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">i</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">int</span>, <span class="ActionScriptDefault_Text">j</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">int</span>, <span class="ActionScriptDefault_Text">k</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">int</span>;
            
            <span class="ActionScriptDefault_Text">_geometries</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">Object</span><span class="ActionScriptBracket/Brace">()</span>;
            
            <span class="ActionScriptReserved">for</span> <span class="ActionScriptReserved">each</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">geometry</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">DaeGeometry</span> <span class="ActionScriptReserved">in</span> <span class="ActionScriptReserved">this</span>.<span class="ActionScriptDefault_Text">document</span>.<span class="ActionScriptDefault_Text">geometries</span><span class="ActionScriptBracket/Brace">)</span>
            <span class="ActionScriptBracket/Brace">{</span>
                <span class="ActionScriptReserved">if</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">geometry</span>.<span class="ActionScriptDefault_Text">mesh</span><span class="ActionScriptBracket/Brace">)</span>
                <span class="ActionScriptBracket/Brace">{</span>
                    <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">g</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">GeometryObject3D</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">GeometryObject3D</span><span class="ActionScriptBracket/Brace">()</span>;
                    
                    <span class="ActionScriptDefault_Text">g</span>.<span class="ActionScriptDefault_Text">vertices</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">buildVertices</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">geometry</span>.<span class="ActionScriptDefault_Text">mesh</span><span class="ActionScriptBracket/Brace">)</span>;
                    <span class="ActionScriptDefault_Text">g</span>.<span class="ActionScriptDefault_Text">faces</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">Array</span><span class="ActionScriptBracket/Brace">()</span>;

                    <span class="ActionScriptReserved">if</span><span class="ActionScriptBracket/Brace">(!</span><span class="ActionScriptDefault_Text">g</span>.<span class="ActionScriptDefault_Text">vertices</span>.<span class="ActionScriptDefault_Text">length</span><span class="ActionScriptBracket/Brace">)</span>
                        <span class="ActionScriptReserved">continue</span>;
                        
                    <span class="ActionScriptReserved">for</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">i</span> <span class="ActionScriptOperator">=</span> 0; <span class="ActionScriptDefault_Text">i</span> <span class="ActionScriptOperator">&lt;</span> <span class="ActionScriptDefault_Text">geometry</span>.<span class="ActionScriptDefault_Text">mesh</span>.<span class="ActionScriptDefault_Text">primitives</span>.<span class="ActionScriptDefault_Text">length</span>; <span class="ActionScriptDefault_Text">i</span><span class="ActionScriptOperator">++</span><span class="ActionScriptBracket/Brace">)</span>
                    <span class="ActionScriptBracket/Brace">{</span>
                        <span class="ActionScriptDefault_Text">buildFaces</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">geometry</span>.<span class="ActionScriptDefault_Text">mesh</span>.<span class="ActionScriptDefault_Text">primitives</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">i</span><span class="ActionScriptBracket/Brace">]</span>, <span class="ActionScriptDefault_Text">g</span>, 0<span class="ActionScriptBracket/Brace">)</span>;
                    <span class="ActionScriptBracket/Brace">}</span>
                    
                    <span class="ActionScriptDefault_Text">_geometries</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">geometry</span>.<span class="ActionScriptDefault_Text">id</span><span class="ActionScriptBracket/Brace">]</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">g</span>;
                <span class="ActionScriptBracket/Brace">}</span>
                <span class="ActionScriptReserved">else</span> <span class="ActionScriptReserved">if</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">geometry</span>.<span class="ActionScriptDefault_Text">spline</span> <span class="ActionScriptOperator">&amp;&amp;</span> <span class="ActionScriptDefault_Text">geometry</span>.<span class="ActionScriptDefault_Text">splines</span><span class="ActionScriptBracket/Brace">)</span>
                <span class="ActionScriptBracket/Brace">{</span>
                    <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">lines</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">Lines3D</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">Lines3D</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">LineMaterial</span><span class="ActionScriptBracket/Brace">(D</span><span class="ActionScriptDefault_Text">EFAULT_LINE_COLOR</span><span class="ActionScriptBracket/Brace">)</span>, <span class="ActionScriptDefault_Text">geometry</span>.<span class="ActionScriptDefault_Text">id</span><span class="ActionScriptBracket/Brace">)</span>;
                    
                    <span class="ActionScriptReserved">for</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">i</span> <span class="ActionScriptOperator">=</span> 0; <span class="ActionScriptDefault_Text">i</span> <span class="ActionScriptOperator">&lt;</span> <span class="ActionScriptDefault_Text">geometry</span>.<span class="ActionScriptDefault_Text">splines</span>.<span class="ActionScriptDefault_Text">length</span>; <span class="ActionScriptDefault_Text">i</span><span class="ActionScriptOperator">++</span><span class="ActionScriptBracket/Brace">)</span>
                    <span class="ActionScriptBracket/Brace">{</span>
                        <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">spline</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">DaeSpline</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">geometry</span>.<span class="ActionScriptDefault_Text">splines</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">i</span><span class="ActionScriptBracket/Brace">]</span>;
                        
                        <span class="ActionScriptReserved">for</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">j</span> <span class="ActionScriptOperator">=</span> 0; <span class="ActionScriptDefault_Text">j</span> <span class="ActionScriptOperator">&lt;</span> <span class="ActionScriptDefault_Text">spline</span>.<span class="ActionScriptDefault_Text">vertices</span>.<span class="ActionScriptDefault_Text">length</span>; <span class="ActionScriptDefault_Text">j</span><span class="ActionScriptOperator">++</span><span class="ActionScriptBracket/Brace">)</span>
                        <span class="ActionScriptBracket/Brace">{</span>
                            <span class="ActionScriptDefault_Text">k</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">j</span><span class="ActionScriptOperator">+</span>1<span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptOperator">%</span> <span class="ActionScriptDefault_Text">spline</span>.<span class="ActionScriptDefault_Text">vertices</span>.<span class="ActionScriptDefault_Text">length</span>;
                            
                            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">v0</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">Vertex3D</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">Vertex3D</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">spline</span>.<span class="ActionScriptDefault_Text">vertices</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">j</span><span class="ActionScriptBracket/Brace">][</span>0<span class="ActionScriptBracket/Brace">]</span>, <span class="ActionScriptDefault_Text">spline</span>.<span class="ActionScriptDefault_Text">vertices</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">j</span><span class="ActionScriptBracket/Brace">][</span>1<span class="ActionScriptBracket/Brace">]</span>, <span class="ActionScriptDefault_Text">spline</span>.<span class="ActionScriptDefault_Text">vertices</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">j</span><span class="ActionScriptBracket/Brace">][</span>2<span class="ActionScriptBracket/Brace">])</span>;
                            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">v1</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">Vertex3D</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">Vertex3D</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">spline</span>.<span class="ActionScriptDefault_Text">vertices</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">k</span><span class="ActionScriptBracket/Brace">][</span>0<span class="ActionScriptBracket/Brace">]</span>, <span class="ActionScriptDefault_Text">spline</span>.<span class="ActionScriptDefault_Text">vertices</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">k</span><span class="ActionScriptBracket/Brace">][</span>1<span class="ActionScriptBracket/Brace">]</span>, <span class="ActionScriptDefault_Text">spline</span>.<span class="ActionScriptDefault_Text">vertices</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">k</span><span class="ActionScriptBracket/Brace">][</span>2<span class="ActionScriptBracket/Brace">])</span>;
                        
                            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">line</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">Line3D</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">Line3D</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">lines</span>, <span class="ActionScriptDefault_Text">lines</span>.<span class="ActionScriptDefault_Text">material</span> <span class="ActionScriptReserved">as</span> <span class="ActionScriptDefault_Text">LineMaterial</span>, <span class="ActionScriptDefault_Text">DEFAULT_LINE_WIDTH</span>, <span class="ActionScriptDefault_Text">v0</span>, <span class="ActionScriptDefault_Text">v1</span><span class="ActionScriptBracket/Brace">)</span>;
                            
                            <span class="ActionScriptDefault_Text">lines</span>.<span class="ActionScriptDefault_Text">addLine</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">line</span><span class="ActionScriptBracket/Brace">)</span>;
                        <span class="ActionScriptBracket/Brace">}</span>
                    <span class="ActionScriptBracket/Brace">}</span>
                    
                    <span class="ActionScriptDefault_Text">_geometries</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">geometry</span>.<span class="ActionScriptDefault_Text">id</span><span class="ActionScriptBracket/Brace">]</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">lines</span>;
                <span class="ActionScriptBracket/Brace">}</span>
            <span class="ActionScriptBracket/Brace">}</span>    
        <span class="ActionScriptBracket/Brace">}</span>
        
    
        
        <span class="ActionScriptASDoc">/**
         *
         * @return
         */</span>
        <span class="ActionScriptReserved">protected</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">buildImagePath</span><span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptDefault_Text">meshFolderPath</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">String</span>, <span class="ActionScriptDefault_Text">imgPath</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">String</span> <span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">String</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">texturePath</span> <span class="ActionScriptOperator">!=</span> <span class="ActionScriptReserved">null</span><span class="ActionScriptBracket/Brace">)</span>
                <span class="ActionScriptDefault_Text">imgPath</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">texturePath</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptDefault_Text">imgPath</span>.<span class="ActionScriptDefault_Text">slice</span><span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptDefault_Text">imgPath</span>.<span class="ActionScriptDefault_Text">lastIndexOf</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">&quot;/&quot;</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptOperator">+</span> 1 <span class="ActionScriptBracket/Brace">)</span>;
            
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">baseParts</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">Array</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">meshFolderPath</span>.<span class="ActionScriptDefault_Text">split</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">&quot;/&quot;</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">imgParts</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">Array</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">imgPath</span>.<span class="ActionScriptDefault_Text">split</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">&quot;/&quot;</span><span class="ActionScriptBracket/Brace">)</span>;
            
            <span class="ActionScriptReserved">while</span><span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptDefault_Text">baseParts</span><span class="ActionScriptBracket/Brace">[</span>0<span class="ActionScriptBracket/Brace">]</span> <span class="ActionScriptOperator">==</span> <span class="ActionScriptString">&quot;.&quot;</span> <span class="ActionScriptBracket/Brace">)</span>
                <span class="ActionScriptDefault_Text">baseParts</span>.<span class="ActionScriptDefault_Text">shift</span><span class="ActionScriptBracket/Brace">()</span>;
                
            <span class="ActionScriptReserved">while</span><span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptDefault_Text">imgParts</span><span class="ActionScriptBracket/Brace">[</span>0<span class="ActionScriptBracket/Brace">]</span> <span class="ActionScriptOperator">==</span> <span class="ActionScriptString">&quot;.&quot;</span> <span class="ActionScriptBracket/Brace">)</span>
                <span class="ActionScriptDefault_Text">imgParts</span>.<span class="ActionScriptDefault_Text">shift</span><span class="ActionScriptBracket/Brace">()</span>;
                
            <span class="ActionScriptReserved">while</span><span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptDefault_Text">imgParts</span><span class="ActionScriptBracket/Brace">[</span>0<span class="ActionScriptBracket/Brace">]</span> <span class="ActionScriptOperator">==</span> <span class="ActionScriptString">&quot;..&quot;</span> <span class="ActionScriptBracket/Brace">)</span>
            <span class="ActionScriptBracket/Brace">{</span>
                <span class="ActionScriptDefault_Text">imgParts</span>.<span class="ActionScriptDefault_Text">shift</span><span class="ActionScriptBracket/Brace">()</span>;
                <span class="ActionScriptDefault_Text">baseParts</span>.<span class="ActionScriptDefault_Text">pop</span><span class="ActionScriptBracket/Brace">()</span>;
            <span class="ActionScriptBracket/Brace">}</span>
                        
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">imgUrl</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">String</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">baseParts</span>.<span class="ActionScriptDefault_Text">length</span> <span class="ActionScriptOperator">&gt;</span> 1 <span class="ActionScriptOperator">?</span> <span class="ActionScriptDefault_Text">baseParts</span>.<span class="ActionScriptDefault_Text">join</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">&quot;/&quot;</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptOperator">:</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">baseParts</span>.<span class="ActionScriptDefault_Text">length</span><span class="ActionScriptOperator">?</span><span class="ActionScriptDefault_Text">baseParts</span><span class="ActionScriptBracket/Brace">[</span>0<span class="ActionScriptBracket/Brace">]</span><span class="ActionScriptOperator">:</span><span class="ActionScriptString">&quot;&quot;</span><span class="ActionScriptBracket/Brace">)</span>;
                        
            <span class="ActionScriptDefault_Text">imgUrl</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">imgUrl</span> <span class="ActionScriptOperator">!=</span> <span class="ActionScriptString">&quot;&quot;</span> <span class="ActionScriptOperator">?</span> <span class="ActionScriptDefault_Text">imgUrl</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptString">&quot;/&quot;</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptDefault_Text">imgParts</span>.<span class="ActionScriptDefault_Text">join</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">&quot;/&quot;</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptOperator">:</span> <span class="ActionScriptDefault_Text">imgParts</span>.<span class="ActionScriptDefault_Text">join</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">&quot;/&quot;</span><span class="ActionScriptBracket/Brace">)</span>;
            
            <span class="ActionScriptReserved">return</span> <span class="ActionScriptDefault_Text">imgUrl</span>;
        <span class="ActionScriptBracket/Brace">}</span>
        
        <span class="ActionScriptReserved">protected</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">getSymbolName</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">effectID</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">String</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">String</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">ef</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">DaeEffect</span>;
            <span class="ActionScriptReserved">for</span> <span class="ActionScriptReserved">each</span> <span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">effect</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">DaeEffect</span> <span class="ActionScriptReserved">in</span> <span class="ActionScriptReserved">this</span>.<span class="ActionScriptDefault_Text">document</span>.<span class="ActionScriptDefault_Text">effects</span> <span class="ActionScriptBracket/Brace">)</span>
            <span class="ActionScriptBracket/Brace">{</span>
               <span class="ActionScriptComment">// trace(&quot;locating effect&quot;, effect.id, effectID);
</span>                <span class="ActionScriptReserved">if</span><span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptDefault_Text">effect</span>.<span class="ActionScriptDefault_Text">id</span> <span class="ActionScriptOperator">==</span> <span class="ActionScriptDefault_Text">effectID</span> <span class="ActionScriptBracket/Brace">)</span> 
                <span class="ActionScriptBracket/Brace">{</span>
                    <span class="ActionScriptReserved">return</span> <span class="ActionScriptDefault_Text">effect</span>.<span class="ActionScriptDefault_Text">texture_url</span>;
                <span class="ActionScriptBracket/Brace">}</span>
            <span class="ActionScriptBracket/Brace">}</span>

            <span class="ActionScriptReserved">return</span> <span class="ActionScriptReserved">null</span>;
        <span class="ActionScriptBracket/Brace">}</span>
        
        <span class="ActionScriptASDoc">/**
         * Builds the materials.
         */</span> 
        <span class="ActionScriptReserved">protected</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">buildMaterials</span><span class="ActionScriptBracket/Brace">()</span><span class="ActionScriptOperator">:</span><span class="ActionScriptReserved">void</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptDefault_Text">_queuedMaterials</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">Array</span><span class="ActionScriptBracket/Brace">()</span>;
            
            <span class="ActionScriptReserved">for</span><span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">materialId</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">String</span> <span class="ActionScriptReserved">in</span> <span class="ActionScriptReserved">this</span>.<span class="ActionScriptDefault_Text">document</span>.<span class="ActionScriptDefault_Text">materials</span> <span class="ActionScriptBracket/Brace">)</span>
            <span class="ActionScriptBracket/Brace">{</span>
                <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">material</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">MaterialObject3D</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">null</span>;
                <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">daeMaterial</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">DaeMaterial</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">this</span>.<span class="ActionScriptDefault_Text">document</span>.<span class="ActionScriptDefault_Text">materials</span><span class="ActionScriptBracket/Brace">[</span> <span class="ActionScriptDefault_Text">materialId</span> <span class="ActionScriptBracket/Brace">]</span>;
                
                <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">symbol</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">String</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">this</span>.<span class="ActionScriptDefault_Text">document</span>.<span class="ActionScriptDefault_Text">materialTargetToSymbol</span><span class="ActionScriptBracket/Brace">[</span> <span class="ActionScriptDefault_Text">daeMaterial</span>.<span class="ActionScriptDefault_Text">id</span> <span class="ActionScriptBracket/Brace">]</span>;
                
                <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">mat</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">MaterialObject3D</span>;
                <span class="ActionScriptReserved">if</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">useMaterialTargetName</span><span class="ActionScriptBracket/Brace">){</span>
                    <span class="ActionScriptDefault_Text">mat</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">this</span>.<span class="ActionScriptDefault_Text">materials</span>.<span class="ActionScriptDefault_Text">getMaterialByName</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">materialId</span><span class="ActionScriptBracket/Brace">)</span>;
                    
                <span class="ActionScriptBracket/Brace">}</span><span class="ActionScriptReserved">else</span><span class="ActionScriptBracket/Brace">{</span>
                    <span class="ActionScriptDefault_Text">mat</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">this</span>.<span class="ActionScriptDefault_Text">materials</span>.<span class="ActionScriptDefault_Text">getMaterialByName</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">symbol</span><span class="ActionScriptBracket/Brace">)</span>;
                <span class="ActionScriptBracket/Brace">}</span>
                
                <span class="ActionScriptComment">/*
                 This next if block is a hack based on materials having their names as the bitmaps URL. 
                 If the material WAS passed in but given the same name as the bitmap&apos;s URL, then we 
                 add another material to the materials list using the symbol name.                 
                 */</span>
                <span class="ActionScriptReserved">if</span><span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptDefault_Text">mat</span> <span class="ActionScriptOperator">==</span> <span class="ActionScriptReserved">null</span><span class="ActionScriptBracket/Brace">)</span> 
                <span class="ActionScriptBracket/Brace">{</span>
                    <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">matID</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">String</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">getSymbolName</span><span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptDefault_Text">daeMaterial</span>.<span class="ActionScriptDefault_Text">effect</span> <span class="ActionScriptBracket/Brace">)</span>;
                    <span class="ActionScriptDefault_Text">mat</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">this</span>.<span class="ActionScriptDefault_Text">materials</span>.<span class="ActionScriptDefault_Text">getMaterialByName</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">matID</span><span class="ActionScriptBracket/Brace">)</span>;
                    <span class="ActionScriptComment">// remove bad reference BEFORE adding the next - otherwise, they&apos;ll both be removed
</span>                    <span class="ActionScriptReserved">this</span>.<span class="ActionScriptDefault_Text">materials</span>.<span class="ActionScriptDefault_Text">removeMaterial</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">mat</span><span class="ActionScriptBracket/Brace">)</span>;
                    <span class="ActionScriptReserved">if</span><span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptDefault_Text">mat</span> <span class="ActionScriptBracket/Brace">)</span> 
                    <span class="ActionScriptBracket/Brace">{</span>
                        <span class="ActionScriptReserved">if</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">useMaterialTargetName</span><span class="ActionScriptBracket/Brace">)</span>
                        <span class="ActionScriptBracket/Brace">{</span>
                             <span class="ActionScriptReserved">this</span>.<span class="ActionScriptDefault_Text">materials</span>.<span class="ActionScriptDefault_Text">addMaterial</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">mat</span>, <span class="ActionScriptDefault_Text">materialId</span><span class="ActionScriptBracket/Brace">)</span>;
                        <span class="ActionScriptBracket/Brace">}</span>
                        <span class="ActionScriptReserved">else</span>
                        <span class="ActionScriptBracket/Brace">{</span>
                             <span class="ActionScriptReserved">this</span>.<span class="ActionScriptDefault_Text">materials</span>.<span class="ActionScriptDefault_Text">addMaterial</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">mat</span>, <span class="ActionScriptDefault_Text">symbol</span><span class="ActionScriptBracket/Brace">)</span>;
                        <span class="ActionScriptBracket/Brace">}</span>
                    <span class="ActionScriptBracket/Brace">}</span>

                <span class="ActionScriptBracket/Brace">}</span>
                    
                <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">effect</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">DaeEffect</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">document</span>.<span class="ActionScriptDefault_Text">effects</span><span class="ActionScriptBracket/Brace">[</span> <span class="ActionScriptDefault_Text">daeMaterial</span>.<span class="ActionScriptDefault_Text">effect</span> <span class="ActionScriptBracket/Brace">]</span>;
                
                <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">lambert</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">DaeLambert</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">effect</span>.<span class="ActionScriptDefault_Text">color</span> <span class="ActionScriptReserved">as</span> <span class="ActionScriptDefault_Text">DaeLambert</span>;
                
                <span class="ActionScriptComment">// save the texture-set if necessary
</span>                <span class="ActionScriptReserved">if</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">lambert</span> <span class="ActionScriptOperator">&amp;&amp;</span> <span class="ActionScriptDefault_Text">lambert</span>.<span class="ActionScriptDefault_Text">diffuse</span>.<span class="ActionScriptDefault_Text">texture</span><span class="ActionScriptBracket/Brace">)</span>
                <span class="ActionScriptBracket/Brace">{</span>
                    <span class="ActionScriptDefault_Text">_textureSets</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">symbol</span><span class="ActionScriptBracket/Brace">]</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">lambert</span>.<span class="ActionScriptDefault_Text">diffuse</span>.<span class="ActionScriptDefault_Text">texture</span>.<span class="ActionScriptDefault_Text">texcoord</span>;
                <span class="ActionScriptBracket/Brace">}</span>
                
                <span class="ActionScriptComment">// material already exists in our materialsList, no need to process
</span>                <span class="ActionScriptReserved">if</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">mat</span><span class="ActionScriptBracket/Brace">){</span>
                    <span class="ActionScriptReserved">continue</span>;
                <span class="ActionScriptBracket/Brace">}</span>
                    
                <span class="ActionScriptComment">// if the material has a texture, qeueu the bitmap
</span>                <span class="ActionScriptReserved">if</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">effect</span> <span class="ActionScriptOperator">&amp;&amp;</span> <span class="ActionScriptDefault_Text">effect</span>.<span class="ActionScriptDefault_Text">texture_url</span><span class="ActionScriptBracket/Brace">)</span>
                <span class="ActionScriptBracket/Brace">{</span>                
                    <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">image</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">DaeImage</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">document</span>.<span class="ActionScriptDefault_Text">images</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">effect</span>.<span class="ActionScriptDefault_Text">texture_url</span><span class="ActionScriptBracket/Brace">]</span>;
                    <span class="ActionScriptReserved">if</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">image</span><span class="ActionScriptBracket/Brace">)</span>
                    <span class="ActionScriptBracket/Brace">{</span>
                        <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">imageUrl</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">String</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">buildImagePath</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptReserved">this</span>.<span class="ActionScriptDefault_Text">baseUrl</span>, <span class="ActionScriptDefault_Text">image</span>.<span class="ActionScriptDefault_Text">init_from</span><span class="ActionScriptBracket/Brace">)</span>;
                    
                        <span class="ActionScriptDefault_Text">material</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">BitmapFileMaterial</span><span class="ActionScriptBracket/Brace">()</span>;
                        <span class="ActionScriptDefault_Text">material</span>.<span class="ActionScriptDefault_Text">doubleSided</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">effect</span>.<span class="ActionScriptDefault_Text">double_sided</span>;
                        <span class="ActionScriptDefault_Text">_queuedMaterials</span>.<span class="ActionScriptDefault_Text">push</span><span class="ActionScriptBracket/Brace">({</span><span class="ActionScriptDefault_Text">symbol</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">symbol</span>, <span class="ActionScriptDefault_Text">url</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">imageUrl</span>, <span class="ActionScriptDefault_Text">material</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">material</span>, <span class="ActionScriptDefault_Text">target</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">materialId</span><span class="ActionScriptBracket/Brace">})</span>;
                        <span class="ActionScriptReserved">continue</span>;
                    <span class="ActionScriptBracket/Brace">}</span>
                <span class="ActionScriptBracket/Brace">}</span>

                <span class="ActionScriptReserved">if</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">lambert</span> <span class="ActionScriptOperator">&amp;&amp;</span> <span class="ActionScriptDefault_Text">lambert</span>.<span class="ActionScriptDefault_Text">diffuse</span>.<span class="ActionScriptDefault_Text">color</span><span class="ActionScriptBracket/Brace">)</span>
                <span class="ActionScriptBracket/Brace">{</span>
                    <span class="ActionScriptReserved">if</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">effect</span>.<span class="ActionScriptDefault_Text">wireframe</span><span class="ActionScriptBracket/Brace">)</span>
                        <span class="ActionScriptDefault_Text">material</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">WireframeMaterial</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">buildColor</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">lambert</span>.<span class="ActionScriptDefault_Text">diffuse</span>.<span class="ActionScriptDefault_Text">color</span><span class="ActionScriptBracket/Brace">))</span>;
                    <span class="ActionScriptReserved">else</span>
                        <span class="ActionScriptDefault_Text">material</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">ColorMaterial</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">buildColor</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">lambert</span>.<span class="ActionScriptDefault_Text">diffuse</span>.<span class="ActionScriptDefault_Text">color</span><span class="ActionScriptBracket/Brace">))</span>;
                <span class="ActionScriptBracket/Brace">}</span>
                <span class="ActionScriptReserved">else</span>
                    <span class="ActionScriptDefault_Text">material</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">MaterialObject3D</span>.<span class="ActionScriptDefault_Text">DEFAULT</span>;
                    
                <span class="ActionScriptDefault_Text">material</span>.<span class="ActionScriptDefault_Text">doubleSided</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">effect</span>.<span class="ActionScriptDefault_Text">double_sided</span>;
                
                <span class="ActionScriptReserved">if</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">useMaterialTargetName</span><span class="ActionScriptBracket/Brace">){</span>
                    <span class="ActionScriptReserved">this</span>.<span class="ActionScriptDefault_Text">materials</span>.<span class="ActionScriptDefault_Text">addMaterial</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">material</span>, <span class="ActionScriptDefault_Text">materialId</span><span class="ActionScriptBracket/Brace">)</span>;
                    
                <span class="ActionScriptBracket/Brace">}</span><span class="ActionScriptReserved">else</span><span class="ActionScriptBracket/Brace">{</span>
                    <span class="ActionScriptReserved">this</span>.<span class="ActionScriptDefault_Text">materials</span>.<span class="ActionScriptDefault_Text">addMaterial</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">material</span>, <span class="ActionScriptDefault_Text">symbol</span><span class="ActionScriptBracket/Brace">)</span>;
                <span class="ActionScriptBracket/Brace">}</span>
                
                
            <span class="ActionScriptBracket/Brace">}</span>
        
            
        
        <span class="ActionScriptBracket/Brace">}</span>
        
        <span class="ActionScriptASDoc">/**
         * Builds a Matrix3D from a node&apos;s transform array. @see org.ascollada.core.DaeNode#transforms
         * 
         * @param    node
         * 
         * @return
         */</span>
        <span class="ActionScriptReserved">protected</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">buildMatrix</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">node</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">DaeNode</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">Matrix3D</span> 
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">stack</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">Array</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">buildMatrixStack</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">node</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">matrix</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">Matrix3D</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">Matrix3D</span>.<span class="ActionScriptDefault_Text">IDENTITY</span>;
            <span class="ActionScriptReserved">for</span><span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">i</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">int</span> <span class="ActionScriptOperator">=</span> 0; <span class="ActionScriptDefault_Text">i</span> <span class="ActionScriptOperator">&lt;</span> <span class="ActionScriptDefault_Text">stack</span>.<span class="ActionScriptDefault_Text">length</span>; <span class="ActionScriptDefault_Text">i</span><span class="ActionScriptOperator">++</span> <span class="ActionScriptBracket/Brace">)</span> 
                <span class="ActionScriptDefault_Text">matrix</span>.<span class="ActionScriptDefault_Text">calculateMultiply4x4</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">matrix</span>, <span class="ActionScriptDefault_Text">stack</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">i</span><span class="ActionScriptBracket/Brace">])</span>;
            <span class="ActionScriptReserved">return</span> <span class="ActionScriptDefault_Text">matrix</span>;
        <span class="ActionScriptBracket/Brace">}</span>
        
        <span class="ActionScriptASDoc">/**
         * 
         * @param    node
         * @return
         */</span>
        <span class="ActionScriptReserved">protected</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">buildMatrixFromTransform</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">transform</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">DaeTransform</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">Matrix3D</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">matrix</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">Matrix3D</span>;
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">toRadians</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">Number</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">Math</span>.<span class="ActionScriptDefault_Text">PI</span><span class="ActionScriptOperator">/</span>180;
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">v</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">Array</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">transform</span>.<span class="ActionScriptDefault_Text">values</span>;
            
            <span class="ActionScriptReserved">switch</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">transform</span>.<span class="ActionScriptDefault_Text">type</span><span class="ActionScriptBracket/Brace">)</span>
            <span class="ActionScriptBracket/Brace">{</span>
                <span class="ActionScriptReserved">case</span> <span class="ActionScriptDefault_Text">ASCollada</span>.<span class="ActionScriptDefault_Text">DAE_ROTATE_ELEMENT</span><span class="ActionScriptOperator">:</span>
                    <span class="ActionScriptDefault_Text">matrix</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">Matrix3D</span>.<span class="ActionScriptDefault_Text">rotationMatrix</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">v</span><span class="ActionScriptBracket/Brace">[</span>0<span class="ActionScriptBracket/Brace">]</span>, <span class="ActionScriptDefault_Text">v</span><span class="ActionScriptBracket/Brace">[</span>1<span class="ActionScriptBracket/Brace">]</span>, <span class="ActionScriptDefault_Text">v</span><span class="ActionScriptBracket/Brace">[</span>2<span class="ActionScriptBracket/Brace">]</span>, <span class="ActionScriptDefault_Text">v</span><span class="ActionScriptBracket/Brace">[</span>3<span class="ActionScriptBracket/Brace">]</span> <span class="ActionScriptOperator">*</span> <span class="ActionScriptDefault_Text">toRadians</span><span class="ActionScriptBracket/Brace">)</span>;
                    <span class="ActionScriptReserved">break</span>;
                <span class="ActionScriptReserved">case</span> <span class="ActionScriptDefault_Text">ASCollada</span>.<span class="ActionScriptDefault_Text">DAE_SCALE_ELEMENT</span><span class="ActionScriptOperator">:</span>
                    <span class="ActionScriptDefault_Text">matrix</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">Matrix3D</span>.<span class="ActionScriptDefault_Text">scaleMatrix</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">v</span><span class="ActionScriptBracket/Brace">[</span>0<span class="ActionScriptBracket/Brace">]</span>, <span class="ActionScriptDefault_Text">v</span><span class="ActionScriptBracket/Brace">[</span>1<span class="ActionScriptBracket/Brace">]</span>, <span class="ActionScriptDefault_Text">v</span><span class="ActionScriptBracket/Brace">[</span>2<span class="ActionScriptBracket/Brace">])</span>;
                    <span class="ActionScriptReserved">break</span>;
                <span class="ActionScriptReserved">case</span> <span class="ActionScriptDefault_Text">ASCollada</span>.<span class="ActionScriptDefault_Text">DAE_TRANSLATE_ELEMENT</span><span class="ActionScriptOperator">:</span>
                    <span class="ActionScriptDefault_Text">matrix</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">Matrix3D</span>.<span class="ActionScriptDefault_Text">translationMatrix</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">v</span><span class="ActionScriptBracket/Brace">[</span>0<span class="ActionScriptBracket/Brace">]</span>, <span class="ActionScriptDefault_Text">v</span><span class="ActionScriptBracket/Brace">[</span>1<span class="ActionScriptBracket/Brace">]</span>, <span class="ActionScriptDefault_Text">v</span><span class="ActionScriptBracket/Brace">[</span>2<span class="ActionScriptBracket/Brace">])</span>;
                    <span class="ActionScriptReserved">break</span>;
                <span class="ActionScriptReserved">case</span> <span class="ActionScriptDefault_Text">ASCollada</span>.<span class="ActionScriptDefault_Text">DAE_MATRIX_ELEMENT</span><span class="ActionScriptOperator">:</span>
                    <span class="ActionScriptDefault_Text">matrix</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">Matrix3D</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">v</span><span class="ActionScriptBracket/Brace">)</span>;
                    <span class="ActionScriptReserved">break</span>;
                <span class="ActionScriptReserved">default</span><span class="ActionScriptOperator">:</span>
                    <span class="ActionScriptReserved">throw</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">Error</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">&quot;Unknown transform type: &quot;</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptDefault_Text">transform</span>.<span class="ActionScriptDefault_Text">type</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptBracket/Brace">}</span>
            <span class="ActionScriptReserved">return</span> <span class="ActionScriptDefault_Text">matrix</span>;
        <span class="ActionScriptBracket/Brace">}</span>
        
        <span class="ActionScriptASDoc">/**
         * 
         * @param    node
         * @return
         */</span>
        <span class="ActionScriptReserved">protected</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">buildMatrixStack</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">node</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">DaeNode</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">Array</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">stack</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">Array</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">Array</span><span class="ActionScriptBracket/Brace">()</span>;    
            <span class="ActionScriptReserved">for</span><span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">i</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">int</span> <span class="ActionScriptOperator">=</span> 0; <span class="ActionScriptDefault_Text">i</span> <span class="ActionScriptOperator">&lt;</span> <span class="ActionScriptDefault_Text">node</span>.<span class="ActionScriptDefault_Text">transforms</span>.<span class="ActionScriptDefault_Text">length</span>; <span class="ActionScriptDefault_Text">i</span><span class="ActionScriptOperator">++</span> <span class="ActionScriptBracket/Brace">)</span> 
                <span class="ActionScriptDefault_Text">stack</span>.<span class="ActionScriptDefault_Text">push</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">buildMatrixFromTransform</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">node</span>.<span class="ActionScriptDefault_Text">transforms</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">i</span><span class="ActionScriptBracket/Brace">]))</span>;
            <span class="ActionScriptReserved">return</span> <span class="ActionScriptDefault_Text">stack</span>;
        <span class="ActionScriptBracket/Brace">}</span>
        
        <span class="ActionScriptASDoc">/**
         * Builds a DisplayObject3D from a node. @see org.ascollada.core.DaeNode
         * 
         * @param    node    
         * 
         * @return    The created DisplayObject3D. @see org.papervision3d.objects.DisplayObject3D
         */</span> 
        <span class="ActionScriptReserved">protected</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">buildNode</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">node</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">DaeNode</span>, <span class="ActionScriptDefault_Text">parent</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">DisplayObject3D</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">:</span><span class="ActionScriptReserved">void</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">instance</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">DisplayObject3D</span>;
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">material</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">MaterialObject3D</span>;
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">i</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">int</span>;
            
            <span class="ActionScriptReserved">if</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">node</span>.<span class="ActionScriptDefault_Text">controllers</span>.<span class="ActionScriptDefault_Text">length</span><span class="ActionScriptBracket/Brace">)</span>
            <span class="ActionScriptBracket/Brace">{</span>
                <span class="ActionScriptComment">// controllers, can be of type &apos;skin&apos; or &apos;morph&apos;
</span>                <span class="ActionScriptReserved">for</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">i</span> <span class="ActionScriptOperator">=</span> 0; <span class="ActionScriptDefault_Text">i</span> <span class="ActionScriptOperator">&lt;</span> <span class="ActionScriptDefault_Text">node</span>.<span class="ActionScriptDefault_Text">controllers</span>.<span class="ActionScriptDefault_Text">length</span>; <span class="ActionScriptDefault_Text">i</span><span class="ActionScriptOperator">++</span><span class="ActionScriptBracket/Brace">)</span>
                <span class="ActionScriptBracket/Brace">{</span>
                    <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">instanceController</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">DaeInstanceController</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">node</span>.<span class="ActionScriptDefault_Text">controllers</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">i</span><span class="ActionScriptBracket/Brace">]</span>;
                    <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">colladaController</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">DaeController</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">document</span>.<span class="ActionScriptDefault_Text">controllers</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">instanceController</span>.<span class="ActionScriptDefault_Text">url</span><span class="ActionScriptBracket/Brace">]</span>;

                    <span class="ActionScriptReserved">if</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">colladaController</span>.<span class="ActionScriptDefault_Text">skin</span><span class="ActionScriptBracket/Brace">)</span>
                    <span class="ActionScriptBracket/Brace">{</span>
                        <span class="ActionScriptDefault_Text">instance</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">Skin3D</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptReserved">null</span>, <span class="ActionScriptBracket/Brace">[]</span>, <span class="ActionScriptBracket/Brace">[]</span>, <span class="ActionScriptDefault_Text">node</span>.<span class="ActionScriptDefault_Text">name</span><span class="ActionScriptBracket/Brace">)</span>;
                        
                        <span class="ActionScriptDefault_Text">buildSkin</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">instance</span> <span class="ActionScriptReserved">as</span> <span class="ActionScriptDefault_Text">Skin3D</span>, <span class="ActionScriptDefault_Text">colladaController</span>.<span class="ActionScriptDefault_Text">skin</span>, <span class="ActionScriptDefault_Text">instanceController</span>.<span class="ActionScriptDefault_Text">skeletons</span>, <span class="ActionScriptDefault_Text">node</span><span class="ActionScriptBracket/Brace">)</span>;
                    <span class="ActionScriptBracket/Brace">}</span>
                    <span class="ActionScriptReserved">else</span> <span class="ActionScriptReserved">if</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">colladaController</span>.<span class="ActionScriptDefault_Text">morph</span><span class="ActionScriptBracket/Brace">)</span>
                    <span class="ActionScriptBracket/Brace">{</span>
                        <span class="ActionScriptReserved">throw</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">Error</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">&quot;morph!&quot;</span><span class="ActionScriptBracket/Brace">)</span>;
                    <span class="ActionScriptBracket/Brace">}</span>
                    <span class="ActionScriptReserved">else</span>
                        <span class="ActionScriptReserved">throw</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">Error</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">&quot;A COLLADA controller should be of type &lt;skin&gt; or &lt;morph&gt;!&quot;</span><span class="ActionScriptBracket/Brace">)</span>;
                
                    <span class="ActionScriptComment">// dunnu yet how to handle multiple controllers.
</span>                    <span class="ActionScriptReserved">break</span>;
                <span class="ActionScriptBracket/Brace">}</span>
            <span class="ActionScriptBracket/Brace">}</span>
            <span class="ActionScriptReserved">else</span> <span class="ActionScriptReserved">if</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">node</span>.<span class="ActionScriptDefault_Text">geometries</span>.<span class="ActionScriptDefault_Text">length</span><span class="ActionScriptBracket/Brace">)</span>
            <span class="ActionScriptBracket/Brace">{</span>
                <span class="ActionScriptComment">// got geometry, so create a TriangleMesh3D
</span>                <span class="ActionScriptDefault_Text">instance</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">TriangleMesh3D</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptReserved">null</span>, <span class="ActionScriptBracket/Brace">[]</span>, <span class="ActionScriptBracket/Brace">[]</span>, <span class="ActionScriptDefault_Text">node</span>.<span class="ActionScriptDefault_Text">name</span><span class="ActionScriptBracket/Brace">)</span>;
                
                <span class="ActionScriptComment">// add all COLLADA geometries to the TriangleMesh3D
</span>                <span class="ActionScriptReserved">for</span> <span class="ActionScriptReserved">each</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">geom</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">DaeInstanceGeometry</span> <span class="ActionScriptReserved">in</span> <span class="ActionScriptDefault_Text">node</span>.<span class="ActionScriptDefault_Text">geometries</span><span class="ActionScriptBracket/Brace">)</span>
                <span class="ActionScriptBracket/Brace">{</span>
                    <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">geometry</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">GeometryObject3D</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">_geometries</span><span class="ActionScriptBracket/Brace">[</span> <span class="ActionScriptDefault_Text">geom</span>.<span class="ActionScriptDefault_Text">url</span> <span class="ActionScriptBracket/Brace">]</span>;        
                    <span class="ActionScriptReserved">if</span><span class="ActionScriptBracket/Brace">(!</span><span class="ActionScriptDefault_Text">geometry</span><span class="ActionScriptBracket/Brace">)</span>
                        <span class="ActionScriptReserved">continue</span>;
                    
                    <span class="ActionScriptReserved">if</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">_geometries</span><span class="ActionScriptBracket/Brace">[</span> <span class="ActionScriptDefault_Text">geom</span>.<span class="ActionScriptDefault_Text">url</span> <span class="ActionScriptBracket/Brace">]</span> <span class="ActionScriptReserved">is</span> <span class="ActionScriptDefault_Text">Lines3D</span><span class="ActionScriptBracket/Brace">)</span>
                    <span class="ActionScriptBracket/Brace">{</span>
                        <span class="ActionScriptDefault_Text">instance</span>.<span class="ActionScriptDefault_Text">addChild</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">_geometries</span><span class="ActionScriptBracket/Brace">[</span> <span class="ActionScriptDefault_Text">geom</span>.<span class="ActionScriptDefault_Text">url</span> <span class="ActionScriptBracket/Brace">])</span>;
                        <span class="ActionScriptReserved">continue</span>;
                    <span class="ActionScriptBracket/Brace">}</span>
                        
                    <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">materialInstances</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">Array</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">Array</span><span class="ActionScriptBracket/Brace">()</span>;
                    <span class="ActionScriptReserved">if</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">geom</span>.<span class="ActionScriptDefault_Text">materials</span><span class="ActionScriptBracket/Brace">)</span>
                    <span class="ActionScriptBracket/Brace">{</span>
                        <span class="ActionScriptReserved">for</span> <span class="ActionScriptReserved">each</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">instanceMaterial</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">DaeInstanceMaterial</span> <span class="ActionScriptReserved">in</span> <span class="ActionScriptDefault_Text">geom</span>.<span class="ActionScriptDefault_Text">materials</span><span class="ActionScriptBracket/Brace">)</span>
                        <span class="ActionScriptBracket/Brace">{</span>
                            <span class="ActionScriptReserved">if</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">useMaterialTargetName</span><span class="ActionScriptBracket/Brace">){</span>
                                <span class="ActionScriptDefault_Text">material</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">this</span>.<span class="ActionScriptDefault_Text">materials</span>.<span class="ActionScriptDefault_Text">getMaterialByName</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">instanceMaterial</span>.<span class="ActionScriptDefault_Text">target</span><span class="ActionScriptBracket/Brace">)</span>;
                            <span class="ActionScriptBracket/Brace">}</span><span class="ActionScriptReserved">else</span><span class="ActionScriptBracket/Brace">{</span>
                                <span class="ActionScriptDefault_Text">material</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">this</span>.<span class="ActionScriptDefault_Text">materials</span>.<span class="ActionScriptDefault_Text">getMaterialByName</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">instanceMaterial</span>.<span class="ActionScriptDefault_Text">symbol</span><span class="ActionScriptBracket/Brace">)</span>;
                            <span class="ActionScriptBracket/Brace">}</span>
                            
                            <span class="ActionScriptReserved">if</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">material</span><span class="ActionScriptBracket/Brace">)</span>
                            <span class="ActionScriptBracket/Brace">{</span>
                                <span class="ActionScriptDefault_Text">_bindVertexInputs</span><span class="ActionScriptBracket/Brace">[</span> <span class="ActionScriptDefault_Text">material</span> <span class="ActionScriptBracket/Brace">]</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">instanceMaterial</span>;
                                
                                <span class="ActionScriptComment">// register shaded materials with its object
</span>                                <span class="ActionScriptReserved">if</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">material</span> <span class="ActionScriptReserved">is</span> <span class="ActionScriptDefault_Text">AbstractLightShadeMaterial</span> <span class="ActionScriptOperator">||</span> <span class="ActionScriptDefault_Text">material</span> <span class="ActionScriptReserved">is</span> <span class="ActionScriptDefault_Text">ShadedMaterial</span><span class="ActionScriptBracket/Brace">)</span>
                                    <span class="ActionScriptDefault_Text">material</span>.<span class="ActionScriptDefault_Text">registerObject</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">instance</span><span class="ActionScriptBracket/Brace">)</span>;
                                
                                <span class="ActionScriptDefault_Text">materialInstances</span>.<span class="ActionScriptDefault_Text">push</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">material</span><span class="ActionScriptBracket/Brace">)</span>;
                            <span class="ActionScriptBracket/Brace">}</span>
                        <span class="ActionScriptBracket/Brace">}</span>
                    <span class="ActionScriptBracket/Brace">}</span>
                    
                    <span class="ActionScriptDefault_Text">mergeGeometries</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">instance</span>.<span class="ActionScriptDefault_Text">geometry</span>, <span class="ActionScriptDefault_Text">geometry</span>.<span class="ActionScriptDefault_Text">clone</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">instance</span><span class="ActionScriptBracket/Brace">)</span>, <span class="ActionScriptDefault_Text">materialInstances</span><span class="ActionScriptBracket/Brace">)</span>;
                <span class="ActionScriptBracket/Brace">}</span>
            <span class="ActionScriptBracket/Brace">}</span>
            <span class="ActionScriptReserved">else</span>
            <span class="ActionScriptBracket/Brace">{</span>
                <span class="ActionScriptComment">// no geometry, simply create a Joint3D
</span>                <span class="ActionScriptDefault_Text">instance</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">DisplayObject3D</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">node</span>.<span class="ActionScriptDefault_Text">name</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptBracket/Brace">}</span>
            
            <span class="ActionScriptComment">// recurse node instances
</span>            <span class="ActionScriptReserved">for</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">i</span> <span class="ActionScriptOperator">=</span> 0; <span class="ActionScriptDefault_Text">i</span> <span class="ActionScriptOperator">&lt;</span> <span class="ActionScriptDefault_Text">node</span>.<span class="ActionScriptDefault_Text">instance_nodes</span>.<span class="ActionScriptDefault_Text">length</span>; <span class="ActionScriptDefault_Text">i</span><span class="ActionScriptOperator">++</span><span class="ActionScriptBracket/Brace">)</span>
            <span class="ActionScriptBracket/Brace">{</span>
                <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">dae_node</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">DaeNode</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">document</span>.<span class="ActionScriptDefault_Text">getDaeNodeById</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">node</span>.<span class="ActionScriptDefault_Text">instance_nodes</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">i</span><span class="ActionScriptBracket/Brace">]</span>.<span class="ActionScriptDefault_Text">url</span><span class="ActionScriptBracket/Brace">)</span>;
                <span class="ActionScriptDefault_Text">buildNode</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">dae_node</span>, <span class="ActionScriptDefault_Text">instance</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptBracket/Brace">}</span>

            <span class="ActionScriptComment">// setup the initial transform
</span>            <span class="ActionScriptDefault_Text">instance</span>.<span class="ActionScriptDefault_Text">copyTransform</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">buildMatrix</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">node</span><span class="ActionScriptBracket/Brace">))</span>;    
            
            <span class="ActionScriptComment">// recurse node children
</span>            <span class="ActionScriptReserved">for</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">i</span> <span class="ActionScriptOperator">=</span> 0; <span class="ActionScriptDefault_Text">i</span> <span class="ActionScriptOperator">&lt;</span> <span class="ActionScriptDefault_Text">node</span>.<span class="ActionScriptDefault_Text">nodes</span>.<span class="ActionScriptDefault_Text">length</span>; <span class="ActionScriptDefault_Text">i</span><span class="ActionScriptOperator">++</span><span class="ActionScriptBracket/Brace">)</span>
                <span class="ActionScriptDefault_Text">buildNode</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">node</span>.<span class="ActionScriptDefault_Text">nodes</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">i</span><span class="ActionScriptBracket/Brace">]</span>, <span class="ActionScriptDefault_Text">instance</span><span class="ActionScriptBracket/Brace">)</span>;
                    
            <span class="ActionScriptComment">// save COLLADA id, sid
</span>            <span class="ActionScriptDefault_Text">_colladaID</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">instance</span><span class="ActionScriptBracket/Brace">]</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">node</span>.<span class="ActionScriptDefault_Text">id</span>;
            <span class="ActionScriptDefault_Text">_colladaSID</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">instance</span><span class="ActionScriptBracket/Brace">]</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">node</span>.<span class="ActionScriptDefault_Text">sid</span>;
            <span class="ActionScriptDefault_Text">_colladaIDToObject</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">node</span>.<span class="ActionScriptDefault_Text">id</span><span class="ActionScriptBracket/Brace">]</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">instance</span>;
            <span class="ActionScriptDefault_Text">_colladaSIDToObject</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">node</span>.<span class="ActionScriptDefault_Text">sid</span><span class="ActionScriptBracket/Brace">]</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">instance</span>;
            <span class="ActionScriptDefault_Text">_objectToNode</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">instance</span><span class="ActionScriptBracket/Brace">]</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">node</span>;
            
            <span class="ActionScriptDefault_Text">instance</span>.<span class="ActionScriptDefault_Text">flipLightDirection</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">true</span>;
                
            <span class="ActionScriptDefault_Text">parent</span>.<span class="ActionScriptDefault_Text">addChild</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">instance</span><span class="ActionScriptBracket/Brace">)</span>;
        <span class="ActionScriptBracket/Brace">}</span>
        
        <span class="ActionScriptASDoc">/**
         * Builds the scene.
         */</span> 
        <span class="ActionScriptReserved">protected</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">buildScene</span><span class="ActionScriptBracket/Brace">()</span><span class="ActionScriptOperator">:</span><span class="ActionScriptReserved">void</span>
        <span class="ActionScriptBracket/Brace">{</span>
            
            
            <span class="ActionScriptDefault_Text">_controllers</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">Array</span><span class="ActionScriptBracket/Brace">()</span>;
    
            <span class="ActionScriptDefault_Text">buildGeometries</span><span class="ActionScriptBracket/Brace">()</span>;
            
            <span class="ActionScriptDefault_Text">_rootNode</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">DisplayObject3D</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">ROOTNODE_NAME</span><span class="ActionScriptBracket/Brace">)</span>;
            
            <span class="ActionScriptReserved">for</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">i</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">int</span> <span class="ActionScriptOperator">=</span> 0; <span class="ActionScriptDefault_Text">i</span> <span class="ActionScriptOperator">&lt;</span> <span class="ActionScriptReserved">this</span>.<span class="ActionScriptDefault_Text">document</span>.<span class="ActionScriptDefault_Text">vscene</span>.<span class="ActionScriptDefault_Text">nodes</span>.<span class="ActionScriptDefault_Text">length</span>; <span class="ActionScriptDefault_Text">i</span><span class="ActionScriptOperator">++</span><span class="ActionScriptBracket/Brace">)</span>
            <span class="ActionScriptBracket/Brace">{</span>
                <span class="ActionScriptDefault_Text">buildNode</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptReserved">this</span>.<span class="ActionScriptDefault_Text">document</span>.<span class="ActionScriptDefault_Text">vscene</span>.<span class="ActionScriptDefault_Text">nodes</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">i</span><span class="ActionScriptBracket/Brace">]</span>, <span class="ActionScriptDefault_Text">_rootNode</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptBracket/Brace">}</span>
            
            <span class="ActionScriptComment">// link the skins
</span>            <span class="ActionScriptDefault_Text">linkSkins</span><span class="ActionScriptBracket/Brace">()</span>;
            
            <span class="ActionScriptReserved">this</span>.<span class="ActionScriptDefault_Text">addChild</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">_rootNode</span><span class="ActionScriptBracket/Brace">)</span>;
            
            <span class="ActionScriptReserved">if</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptReserved">this</span>.<span class="ActionScriptDefault_Text">yUp</span><span class="ActionScriptBracket/Brace">)</span>
            <span class="ActionScriptBracket/Brace">{</span>
                
            <span class="ActionScriptBracket/Brace">}</span>
            <span class="ActionScriptReserved">else</span>
            <span class="ActionScriptBracket/Brace">{</span>
                <span class="ActionScriptDefault_Text">_rootNode</span>.<span class="ActionScriptDefault_Text">rotationX</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptOperator">-</span>90;
                <span class="ActionScriptDefault_Text">_rootNode</span>.<span class="ActionScriptDefault_Text">rotationY</span> <span class="ActionScriptOperator">=</span> 180;
            <span class="ActionScriptBracket/Brace">}</span>
            
            <span class="ActionScriptReserved">if</span><span class="ActionScriptBracket/Brace">(!</span><span class="ActionScriptDefault_Text">_rightHanded</span><span class="ActionScriptBracket/Brace">)</span>
                <span class="ActionScriptDefault_Text">_rootNode</span>.<span class="ActionScriptDefault_Text">scaleX</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptOperator">-</span><span class="ActionScriptDefault_Text">_rootNode</span>.<span class="ActionScriptDefault_Text">scaleX</span>;
            
            <span class="ActionScriptComment">// animation stuff
</span>            <span class="ActionScriptDefault_Text">_currentFrame</span> <span class="ActionScriptOperator">=</span> 0;
            <span class="ActionScriptDefault_Text">_totalFrames</span> <span class="ActionScriptOperator">=</span> 0;
            <span class="ActionScriptDefault_Text">_startTime</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">_endTime</span> <span class="ActionScriptOperator">=</span> 0;
            <span class="ActionScriptDefault_Text">_channels</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">Array</span><span class="ActionScriptBracket/Brace">()</span>;
            <span class="ActionScriptDefault_Text">_isAnimated</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">false</span>;
            <span class="ActionScriptDefault_Text">_isPlaying</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">false</span>;
            

            
            <span class="ActionScriptComment">// may have animations to be parsed.
</span>            <span class="ActionScriptReserved">if</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">document</span>.<span class="ActionScriptDefault_Text">numQueuedAnimations</span><span class="ActionScriptBracket/Brace">)</span>
            <span class="ActionScriptBracket/Brace">{</span>
                <span class="ActionScriptDefault_Text">_isAnimated</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">true</span>;
                
                <span class="ActionScriptReserved">this</span>.<span class="ActionScriptDefault_Text">parser</span>.<span class="ActionScriptDefault_Text">addEventListener</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">Event</span>.<span class="ActionScriptDefault_Text">COMPLETE</span>, <span class="ActionScriptDefault_Text">onParseAnimationsComplete</span><span class="ActionScriptBracket/Brace">)</span>;
                <span class="ActionScriptReserved">this</span>.<span class="ActionScriptDefault_Text">parser</span>.<span class="ActionScriptDefault_Text">addEventListener</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">ProgressEvent</span>.<span class="ActionScriptDefault_Text">PROGRESS</span>, <span class="ActionScriptDefault_Text">onParseAnimationsProgress</span><span class="ActionScriptBracket/Brace">)</span>;
                <span class="ActionScriptReserved">this</span>.<span class="ActionScriptDefault_Text">parser</span>.<span class="ActionScriptDefault_Text">readAnimations</span><span class="ActionScriptBracket/Brace">()</span>;
            <span class="ActionScriptBracket/Brace">}</span>
            
            <span class="ActionScriptDefault_Text">dispatchEvent</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">FileLoadEvent</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">FileLoadEvent</span>.<span class="ActionScriptDefault_Text">LOAD_COMPLETE</span>, <span class="ActionScriptReserved">this</span>.<span class="ActionScriptDefault_Text">filename</span><span class="ActionScriptBracket/Brace">))</span>;
        <span class="ActionScriptBracket/Brace">}</span>
        
        <span class="ActionScriptASDoc">/**
         * Builds a skin.
         * 
         * @param    instance
         * @param    colladaSkin
         * @param    skeletons
         */</span> 
        <span class="ActionScriptReserved">protected</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">buildSkin</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">instance</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">Skin3D</span>, <span class="ActionScriptDefault_Text">colladaSkin</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">DaeSkin</span>, <span class="ActionScriptDefault_Text">skeletons</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">Array</span>, <span class="ActionScriptDefault_Text">node</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">DaeNode</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">:</span><span class="ActionScriptReserved">void</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">skin</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">GeometryObject3D</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">_geometries</span><span class="ActionScriptBracket/Brace">[</span> <span class="ActionScriptDefault_Text">colladaSkin</span>.<span class="ActionScriptDefault_Text">source</span> <span class="ActionScriptBracket/Brace">]</span>;
            <span class="ActionScriptReserved">if</span><span class="ActionScriptBracket/Brace">(!</span><span class="ActionScriptDefault_Text">skin</span><span class="ActionScriptBracket/Brace">)</span>
            <span class="ActionScriptBracket/Brace">{</span>
                <span class="ActionScriptComment">// geometry can be inside a morph controller
</span>                <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">morphController</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">DaeController</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">this</span>.<span class="ActionScriptDefault_Text">document</span>.<span class="ActionScriptDefault_Text">controllers</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">colladaSkin</span>.<span class="ActionScriptDefault_Text">source</span><span class="ActionScriptBracket/Brace">]</span>;
                <span class="ActionScriptReserved">if</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">morphController</span> <span class="ActionScriptOperator">&amp;&amp;</span> <span class="ActionScriptDefault_Text">morphController</span>.<span class="ActionScriptDefault_Text">morph</span><span class="ActionScriptBracket/Brace">)</span>
                <span class="ActionScriptBracket/Brace">{</span>
                    <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">morph</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">DaeMorph</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">morphController</span>.<span class="ActionScriptDefault_Text">morph</span>;
                    
                    <span class="ActionScriptComment">// fetch geometry
</span>                    <span class="ActionScriptDefault_Text">skin</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">_geometries</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">morph</span>.<span class="ActionScriptDefault_Text">source</span><span class="ActionScriptBracket/Brace">]</span>;

                    <span class="ActionScriptComment">// fetch target geometries
</span>                    <span class="ActionScriptReserved">for</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">j</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">int</span> <span class="ActionScriptOperator">=</span> 0; <span class="ActionScriptDefault_Text">j</span> <span class="ActionScriptOperator">&lt;</span> <span class="ActionScriptDefault_Text">morph</span>.<span class="ActionScriptDefault_Text">targets</span>.<span class="ActionScriptDefault_Text">length</span>; <span class="ActionScriptDefault_Text">j</span><span class="ActionScriptOperator">++</span><span class="ActionScriptBracket/Brace">)</span>
                    <span class="ActionScriptBracket/Brace">{</span>
                        <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">targetGeometry</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">GeometryObject3D</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">_geometries</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">morph</span>.<span class="ActionScriptDefault_Text">targets</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">j</span><span class="ActionScriptBracket/Brace">]]</span>;
                    <span class="ActionScriptBracket/Brace">}</span>
                <span class="ActionScriptBracket/Brace">}</span>
                <span class="ActionScriptReserved">if</span><span class="ActionScriptBracket/Brace">(!</span><span class="ActionScriptDefault_Text">skin</span><span class="ActionScriptBracket/Brace">)</span>
                    <span class="ActionScriptReserved">throw</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">Error</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">&quot;no geometry for source: &quot;</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptDefault_Text">colladaSkin</span>.<span class="ActionScriptDefault_Text">source</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptBracket/Brace">}</span>
            
            <span class="ActionScriptDefault_Text">mergeGeometries</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">instance</span>.<span class="ActionScriptDefault_Text">geometry</span>, <span class="ActionScriptDefault_Text">skin</span>.<span class="ActionScriptDefault_Text">clone</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">instance</span><span class="ActionScriptBracket/Brace">))</span>;
            
            <span class="ActionScriptDefault_Text">_skins</span><span class="ActionScriptBracket/Brace">[</span> <span class="ActionScriptDefault_Text">instance</span> <span class="ActionScriptBracket/Brace">]</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">colladaSkin</span>;
        <span class="ActionScriptBracket/Brace">}</span>
        
        <span class="ActionScriptASDoc">/**
         * Builds vertices from a COLLADA mesh.
         * 
         * @param    mesh    The COLLADA mesh. @see org.ascollada.core.DaeMesh
         * 
         * @return    Array of Vertex3D
         */</span>
        <span class="ActionScriptReserved">protected</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">buildVertices</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">mesh</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">DaeMesh</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">Array</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">vertices</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">Array</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">Array</span><span class="ActionScriptBracket/Brace">()</span>;
            <span class="ActionScriptReserved">for</span><span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">i</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">int</span> <span class="ActionScriptOperator">=</span> 0; <span class="ActionScriptDefault_Text">i</span> <span class="ActionScriptOperator">&lt;</span> <span class="ActionScriptDefault_Text">mesh</span>.<span class="ActionScriptDefault_Text">vertices</span>.<span class="ActionScriptDefault_Text">length</span>; <span class="ActionScriptDefault_Text">i</span><span class="ActionScriptOperator">++</span> <span class="ActionScriptBracket/Brace">)</span>
                <span class="ActionScriptDefault_Text">vertices</span>.<span class="ActionScriptDefault_Text">push</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">Vertex3D</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">mesh</span>.<span class="ActionScriptDefault_Text">vertices</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">i</span><span class="ActionScriptBracket/Brace">][</span>0<span class="ActionScriptBracket/Brace">]</span>, <span class="ActionScriptDefault_Text">mesh</span>.<span class="ActionScriptDefault_Text">vertices</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">i</span><span class="ActionScriptBracket/Brace">][</span>1<span class="ActionScriptBracket/Brace">]</span>, <span class="ActionScriptDefault_Text">mesh</span>.<span class="ActionScriptDefault_Text">vertices</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">i</span><span class="ActionScriptBracket/Brace">][</span>2<span class="ActionScriptBracket/Brace">]))</span>;
            <span class="ActionScriptReserved">return</span> <span class="ActionScriptDefault_Text">vertices</span>;
        <span class="ActionScriptBracket/Brace">}</span>
        
        <span class="ActionScriptASDoc">/**
         * Recursively finds a child by its COLLADA is.
         * 
         * @param    id
         * @param    parent
         * 
         * @return     The found child.
         */</span> 
        <span class="ActionScriptReserved">protected</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">findChildByID</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">id</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">String</span>, <span class="ActionScriptDefault_Text">parent</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">DisplayObject3D</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">null</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">DisplayObject3D</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptDefault_Text">parent</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">parent</span> <span class="ActionScriptOperator">||</span> <span class="ActionScriptReserved">this</span>;
            <span class="ActionScriptReserved">if</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">_colladaID</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">parent</span><span class="ActionScriptBracket/Brace">]</span> <span class="ActionScriptOperator">==</span> <span class="ActionScriptDefault_Text">id</span><span class="ActionScriptBracket/Brace">)</span>
                <span class="ActionScriptReserved">return</span> <span class="ActionScriptDefault_Text">parent</span>;
            <span class="ActionScriptReserved">for</span> <span class="ActionScriptReserved">each</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">child</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">DisplayObject3D</span> <span class="ActionScriptReserved">in</span> <span class="ActionScriptDefault_Text">parent</span>.<span class="ActionScriptDefault_Text">children</span><span class="ActionScriptBracket/Brace">)</span>    
            <span class="ActionScriptBracket/Brace">{</span>
                <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">obj</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">DisplayObject3D</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">findChildByID</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">id</span>, <span class="ActionScriptDefault_Text">child</span><span class="ActionScriptBracket/Brace">)</span>;
                <span class="ActionScriptReserved">if</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">obj</span><span class="ActionScriptBracket/Brace">)</span> 
                    <span class="ActionScriptReserved">return</span> <span class="ActionScriptDefault_Text">obj</span>;
            <span class="ActionScriptBracket/Brace">}</span>
            <span class="ActionScriptReserved">return</span> <span class="ActionScriptReserved">null</span>;
        <span class="ActionScriptBracket/Brace">}</span>
        
        <span class="ActionScriptASDoc">/**
         * Recursively finds a child by its SID.
         * 
         * @param    name
         * @param    parent
         * 
         * @return     The found child.
         */</span> 
        <span class="ActionScriptReserved">protected</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">findChildBySID</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">sid</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">String</span>, <span class="ActionScriptDefault_Text">parent</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">DisplayObject3D</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">null</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">DisplayObject3D</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptDefault_Text">parent</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">parent</span> <span class="ActionScriptOperator">||</span> <span class="ActionScriptReserved">this</span>;
            <span class="ActionScriptReserved">if</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">_colladaSID</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">parent</span><span class="ActionScriptBracket/Brace">]</span> <span class="ActionScriptOperator">==</span> <span class="ActionScriptDefault_Text">sid</span><span class="ActionScriptBracket/Brace">)</span>
                <span class="ActionScriptReserved">return</span> <span class="ActionScriptDefault_Text">parent</span>;
            <span class="ActionScriptReserved">for</span> <span class="ActionScriptReserved">each</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">child</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">DisplayObject3D</span> <span class="ActionScriptReserved">in</span> <span class="ActionScriptDefault_Text">parent</span>.<span class="ActionScriptDefault_Text">children</span><span class="ActionScriptBracket/Brace">)</span>    
            <span class="ActionScriptBracket/Brace">{</span>
                <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">obj</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">DisplayObject3D</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">findChildBySID</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">sid</span>, <span class="ActionScriptDefault_Text">child</span><span class="ActionScriptBracket/Brace">)</span>;
                <span class="ActionScriptReserved">if</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">obj</span><span class="ActionScriptBracket/Brace">)</span> 
                    <span class="ActionScriptReserved">return</span> <span class="ActionScriptDefault_Text">obj</span>;
            <span class="ActionScriptBracket/Brace">}</span>
            <span class="ActionScriptReserved">return</span> <span class="ActionScriptReserved">null</span>;
        <span class="ActionScriptBracket/Brace">}</span>
        
        <span class="ActionScriptASDoc">/**
         * Tests whether a node has a baked transform
         * 
         * @param    node
         */</span> 
        <span class="ActionScriptReserved">protected</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">isBakedMatrix</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">node</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">DaeNode</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">Boolean</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptReserved">if</span><span class="ActionScriptBracket/Brace">(!</span><span class="ActionScriptDefault_Text">node</span>.<span class="ActionScriptDefault_Text">transforms</span>.<span class="ActionScriptDefault_Text">length</span> <span class="ActionScriptOperator">||</span> <span class="ActionScriptDefault_Text">node</span>.<span class="ActionScriptDefault_Text">transforms</span>.<span class="ActionScriptDefault_Text">length</span> <span class="ActionScriptOperator">&gt;</span> 1<span class="ActionScriptBracket/Brace">)</span>
                <span class="ActionScriptReserved">return</span> <span class="ActionScriptReserved">false</span>;
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">transform</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">DaeTransform</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">node</span>.<span class="ActionScriptDefault_Text">transforms</span><span class="ActionScriptBracket/Brace">[</span>0<span class="ActionScriptBracket/Brace">]</span>;
            <span class="ActionScriptReserved">return</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">transform</span>.<span class="ActionScriptDefault_Text">type</span> <span class="ActionScriptOperator">==</span> <span class="ActionScriptDefault_Text">ASCollada</span>.<span class="ActionScriptDefault_Text">DAE_MATERIAL_ELEMENT</span><span class="ActionScriptBracket/Brace">)</span>;
        <span class="ActionScriptBracket/Brace">}</span>
        
        <span class="ActionScriptASDoc">/**
         * Setup the skin controllers.
         */</span> 
        <span class="ActionScriptReserved">protected</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">linkSkin</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">instance</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">DisplayObject3D</span>, <span class="ActionScriptDefault_Text">skin</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">DaeSkin</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">:</span><span class="ActionScriptReserved">void</span>
        <span class="ActionScriptBracket/Brace">{</span>            
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">i</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">int</span>;
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">found</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">Object</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">Object</span><span class="ActionScriptBracket/Brace">()</span>;
            
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">controller</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">SkinController</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">SkinController</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">instance</span> <span class="ActionScriptReserved">as</span> <span class="ActionScriptDefault_Text">Skin3D</span><span class="ActionScriptBracket/Brace">)</span>;

            <span class="ActionScriptDefault_Text">controller</span>.<span class="ActionScriptDefault_Text">bindShapeMatrix</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">Matrix3D</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">skin</span>.<span class="ActionScriptDefault_Text">bind_shape_matrix</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptDefault_Text">controller</span>.<span class="ActionScriptDefault_Text">joints</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">Array</span><span class="ActionScriptBracket/Brace">()</span>;
            <span class="ActionScriptDefault_Text">controller</span>.<span class="ActionScriptDefault_Text">vertexWeights</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">Array</span><span class="ActionScriptBracket/Brace">()</span>;
            <span class="ActionScriptDefault_Text">controller</span>.<span class="ActionScriptDefault_Text">invBindMatrices</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">Array</span><span class="ActionScriptBracket/Brace">()</span>;
            
            <span class="ActionScriptReserved">for</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">i</span> <span class="ActionScriptOperator">=</span> 0; <span class="ActionScriptDefault_Text">i</span> <span class="ActionScriptOperator">&lt;</span> <span class="ActionScriptDefault_Text">skin</span>.<span class="ActionScriptDefault_Text">joints</span>.<span class="ActionScriptDefault_Text">length</span>; <span class="ActionScriptDefault_Text">i</span><span class="ActionScriptOperator">++</span><span class="ActionScriptBracket/Brace">)</span>
            <span class="ActionScriptBracket/Brace">{</span>
                <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">jointId</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">String</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">skin</span>.<span class="ActionScriptDefault_Text">joints</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">i</span><span class="ActionScriptBracket/Brace">]</span>;
                
                <span class="ActionScriptReserved">if</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">found</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">jointId</span><span class="ActionScriptBracket/Brace">])</span>
                    <span class="ActionScriptReserved">continue</span>;
                    
                <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">joint</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">DisplayObject3D</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">_colladaIDToObject</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">jointId</span><span class="ActionScriptBracket/Brace">]</span>;
                <span class="ActionScriptReserved">if</span><span class="ActionScriptBracket/Brace">(!</span><span class="ActionScriptDefault_Text">joint</span><span class="ActionScriptBracket/Brace">)</span>
                    <span class="ActionScriptDefault_Text">joint</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">_colladaSIDToObject</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">jointId</span><span class="ActionScriptBracket/Brace">]</span>;
                <span class="ActionScriptReserved">if</span><span class="ActionScriptBracket/Brace">(!</span><span class="ActionScriptDefault_Text">joint</span><span class="ActionScriptBracket/Brace">)</span>
                    <span class="ActionScriptReserved">throw</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">Error</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">&quot;Couldn&apos;t find the joint id = &quot;</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptDefault_Text">jointId</span><span class="ActionScriptBracket/Brace">)</span>;

                <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">vertexWeights</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">Array</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">skin</span>.<span class="ActionScriptDefault_Text">findJointVertexWeightsByIDOrSID</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">jointId</span><span class="ActionScriptBracket/Brace">)</span>;
                <span class="ActionScriptReserved">if</span><span class="ActionScriptBracket/Brace">(!</span><span class="ActionScriptDefault_Text">vertexWeights</span><span class="ActionScriptBracket/Brace">)</span>
                    <span class="ActionScriptReserved">throw</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">Error</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">&quot;Could not find vertex weights for joint with id = &quot;</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptDefault_Text">jointId</span><span class="ActionScriptBracket/Brace">)</span>;
                    
                <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">bindMatrix</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">Array</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">skin</span>.<span class="ActionScriptDefault_Text">findJointBindMatrix2</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">jointId</span><span class="ActionScriptBracket/Brace">)</span>;
                <span class="ActionScriptReserved">if</span><span class="ActionScriptBracket/Brace">(!</span><span class="ActionScriptDefault_Text">bindMatrix</span> <span class="ActionScriptOperator">||</span> <span class="ActionScriptDefault_Text">bindMatrix</span>.<span class="ActionScriptDefault_Text">length</span> <span class="ActionScriptOperator">!=</span> 16<span class="ActionScriptBracket/Brace">)</span>
                    <span class="ActionScriptReserved">throw</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">Error</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">&quot;Could not find inverse bind matrix for joint with id = &quot;</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptDefault_Text">jointId</span><span class="ActionScriptBracket/Brace">)</span>;
                
                <span class="ActionScriptDefault_Text">controller</span>.<span class="ActionScriptDefault_Text">joints</span>.<span class="ActionScriptDefault_Text">push</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">joint</span><span class="ActionScriptBracket/Brace">)</span>;
                <span class="ActionScriptDefault_Text">controller</span>.<span class="ActionScriptDefault_Text">invBindMatrices</span>.<span class="ActionScriptDefault_Text">push</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">Matrix3D</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">bindMatrix</span><span class="ActionScriptBracket/Brace">))</span>;
                <span class="ActionScriptDefault_Text">controller</span>.<span class="ActionScriptDefault_Text">vertexWeights</span>.<span class="ActionScriptDefault_Text">push</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">vertexWeights</span><span class="ActionScriptBracket/Brace">)</span>;
                
                <span class="ActionScriptDefault_Text">found</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">jointId</span><span class="ActionScriptBracket/Brace">]</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">true</span>;
            <span class="ActionScriptBracket/Brace">}</span>
            
            <span class="ActionScriptDefault_Text">_controllers</span>.<span class="ActionScriptDefault_Text">push</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">controller</span><span class="ActionScriptBracket/Brace">)</span>;
        <span class="ActionScriptBracket/Brace">}</span>
        
        <span class="ActionScriptASDoc">/**
         * Setup the skin controllers.
         */</span> 
        <span class="ActionScriptReserved">protected</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">linkSkins</span><span class="ActionScriptBracket/Brace">()</span><span class="ActionScriptOperator">:</span><span class="ActionScriptReserved">void</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptDefault_Text">_numSkins</span> <span class="ActionScriptOperator">=</span> 0;
            
            <span class="ActionScriptReserved">for</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">object</span><span class="ActionScriptOperator">:*</span> <span class="ActionScriptReserved">in</span> <span class="ActionScriptDefault_Text">_skins</span><span class="ActionScriptBracket/Brace">)</span>
            <span class="ActionScriptBracket/Brace">{</span>
                <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">instance</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">TriangleMesh3D</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">object</span> <span class="ActionScriptReserved">as</span> <span class="ActionScriptDefault_Text">TriangleMesh3D</span>;
                <span class="ActionScriptReserved">if</span><span class="ActionScriptBracket/Brace">(!</span><span class="ActionScriptDefault_Text">instance</span><span class="ActionScriptBracket/Brace">)</span>
                    <span class="ActionScriptReserved">throw</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">Error</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">&quot;Not a Skin3D?&quot;</span><span class="ActionScriptBracket/Brace">)</span>;
                <span class="ActionScriptDefault_Text">linkSkin</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">instance</span>, <span class="ActionScriptDefault_Text">_skins</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">object</span><span class="ActionScriptBracket/Brace">])</span>;
                <span class="ActionScriptDefault_Text">_numSkins</span><span class="ActionScriptOperator">++</span>;
            <span class="ActionScriptBracket/Brace">}</span>
        <span class="ActionScriptBracket/Brace">}</span>
        
        <span class="ActionScriptASDoc">/**
         * Loads the next material.
         * 
         * @param    event
         */</span> 
        <span class="ActionScriptReserved">protected</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">loadNextMaterial</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">event</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">FileLoadEvent</span><span class="ActionScriptOperator">=</span><span class="ActionScriptReserved">null</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">:</span><span class="ActionScriptReserved">void</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptReserved">if</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">event</span><span class="ActionScriptBracket/Brace">)</span>
            <span class="ActionScriptBracket/Brace">{</span>
                <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">previous</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">BitmapFileMaterial</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">event</span>.<span class="ActionScriptDefault_Text">target</span> <span class="ActionScriptReserved">as</span> <span class="ActionScriptDefault_Text">BitmapFileMaterial</span>;
                <span class="ActionScriptReserved">if</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">_rightHanded</span> <span class="ActionScriptOperator">&amp;&amp;</span> <span class="ActionScriptDefault_Text">previous</span><span class="ActionScriptBracket/Brace">)</span>
                    <span class="ActionScriptDefault_Text">BitmapMaterialTools</span>.<span class="ActionScriptDefault_Text">mirrorBitmapX</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">previous</span>.<span class="ActionScriptDefault_Text">bitmap</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptBracket/Brace">}</span>
            
            <span class="ActionScriptReserved">if</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">_queuedMaterials</span>.<span class="ActionScriptDefault_Text">length</span><span class="ActionScriptBracket/Brace">)</span>
            <span class="ActionScriptBracket/Brace">{</span>
                <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">data</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">Object</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">_queuedMaterials</span>.<span class="ActionScriptDefault_Text">shift</span><span class="ActionScriptBracket/Brace">()</span>;
                <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">url</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">String</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">data</span>.<span class="ActionScriptDefault_Text">url</span>;
                <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">symbol</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">String</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">data</span>.<span class="ActionScriptDefault_Text">symbol</span>;
                <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">target</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">String</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">data</span>.<span class="ActionScriptDefault_Text">target</span>;
                
                <span class="ActionScriptDefault_Text">url</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">url</span>.<span class="ActionScriptDefault_Text">replace</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">/\.tga/</span><span class="ActionScriptDefault_Text">i</span>, <span class="ActionScriptString">&quot;.&quot;</span><span class="ActionScriptOperator">+</span><span class="ActionScriptDefault_Text">DEFAULT_TGA_ALTERNATIVE</span><span class="ActionScriptBracket/Brace">)</span>;
                
                <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">material</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">BitmapFileMaterial</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">data</span>.<span class="ActionScriptDefault_Text">material</span>;
                <span class="ActionScriptDefault_Text">material</span>.<span class="ActionScriptDefault_Text">addEventListener</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">FileLoadEvent</span>.<span class="ActionScriptDefault_Text">LOAD_COMPLETE</span>, <span class="ActionScriptDefault_Text">loadNextMaterial</span><span class="ActionScriptBracket/Brace">)</span>;
                <span class="ActionScriptDefault_Text">material</span>.<span class="ActionScriptDefault_Text">addEventListener</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">FileLoadEvent</span>.<span class="ActionScriptDefault_Text">LOAD_ERROR</span>, <span class="ActionScriptDefault_Text">onMaterialError</span><span class="ActionScriptBracket/Brace">)</span>;
                
                <span class="ActionScriptComment">// shouldn&apos;t need the ?nc no cache filename now that BitmapFileMaterial has been fixed. 
</span>                <span class="ActionScriptDefault_Text">material</span>.<span class="ActionScriptDefault_Text">texture</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">url</span>;

                <span class="ActionScriptReserved">if</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">useMaterialTargetName</span><span class="ActionScriptBracket/Brace">){</span>
                    <span class="ActionScriptDefault_Text">material</span>.<span class="ActionScriptDefault_Text">name</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">target</span>;
                    <span class="ActionScriptReserved">this</span>.<span class="ActionScriptDefault_Text">materials</span>.<span class="ActionScriptDefault_Text">addMaterial</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">material</span>, <span class="ActionScriptDefault_Text">target</span><span class="ActionScriptBracket/Brace">)</span>;
                <span class="ActionScriptBracket/Brace">}</span><span class="ActionScriptReserved">else</span><span class="ActionScriptBracket/Brace">{</span>
                    <span class="ActionScriptDefault_Text">material</span>.<span class="ActionScriptDefault_Text">name</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">symbol</span>;
                    <span class="ActionScriptReserved">this</span>.<span class="ActionScriptDefault_Text">materials</span>.<span class="ActionScriptDefault_Text">addMaterial</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">material</span>, <span class="ActionScriptDefault_Text">symbol</span><span class="ActionScriptBracket/Brace">)</span>;
                <span class="ActionScriptBracket/Brace">}</span>
            <span class="ActionScriptBracket/Brace">}</span>
            <span class="ActionScriptReserved">else</span>
            <span class="ActionScriptBracket/Brace">{</span>
                <span class="ActionScriptDefault_Text">dispatchEvent</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">FileLoadEvent</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">FileLoadEvent</span>.<span class="ActionScriptDefault_Text">COLLADA_MATERIALS_DONE</span>, <span class="ActionScriptReserved">this</span>.<span class="ActionScriptDefault_Text">filename</span><span class="ActionScriptBracket/Brace">))</span>;

                <span class="ActionScriptDefault_Text">onMaterialsLoaded</span><span class="ActionScriptBracket/Brace">()</span>;
                <span class="ActionScriptComment">//buildScene();
</span>            <span class="ActionScriptBracket/Brace">}</span>
        <span class="ActionScriptBracket/Brace">}</span>
        
        
        <span class="ActionScriptReserved">protected</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">onMaterialsLoaded</span><span class="ActionScriptBracket/Brace">()</span> <span class="ActionScriptOperator">:</span> <span class="ActionScriptReserved">void</span>
        <span class="ActionScriptBracket/Brace">{</span>
            
            <span class="ActionScriptReserved">if</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptReserved">this</span>.<span class="ActionScriptDefault_Text">parser</span>.<span class="ActionScriptDefault_Text">hasEventListener</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">Event</span>.<span class="ActionScriptDefault_Text">COMPLETE</span><span class="ActionScriptBracket/Brace">))</span>
                <span class="ActionScriptReserved">this</span>.<span class="ActionScriptDefault_Text">parser</span>.<span class="ActionScriptDefault_Text">removeEventListener</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">Event</span>.<span class="ActionScriptDefault_Text">COMPLETE</span>, <span class="ActionScriptDefault_Text">onParseComplete</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptReserved">if</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptReserved">this</span>.<span class="ActionScriptDefault_Text">parser</span>.<span class="ActionScriptDefault_Text">hasEventListener</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">ProgressEvent</span>.<span class="ActionScriptDefault_Text">PROGRESS</span><span class="ActionScriptBracket/Brace">))</span>
                <span class="ActionScriptReserved">this</span>.<span class="ActionScriptDefault_Text">parser</span>.<span class="ActionScriptDefault_Text">removeEventListener</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">ProgressEvent</span>.<span class="ActionScriptDefault_Text">PROGRESS</span>, <span class="ActionScriptDefault_Text">onParseProgress</span><span class="ActionScriptBracket/Brace">)</span>;
            
            <span class="ActionScriptComment">//may have geometries to be parsed
</span>            <span class="ActionScriptReserved">if</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">document</span>.<span class="ActionScriptDefault_Text">numQueuedGeometries</span><span class="ActionScriptBracket/Brace">)</span>
            <span class="ActionScriptBracket/Brace">{</span>
                <span class="ActionScriptReserved">this</span>.<span class="ActionScriptDefault_Text">parser</span>.<span class="ActionScriptDefault_Text">addEventListener</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">Event</span>.<span class="ActionScriptDefault_Text">COMPLETE</span>, <span class="ActionScriptDefault_Text">onParseGeometriesComplete</span><span class="ActionScriptBracket/Brace">)</span>;
                <span class="ActionScriptComment">//this.parser.addEventListener(ProgressEvent.PROGRESS, onParseGeometriesProgress);
</span>                <span class="ActionScriptReserved">this</span>.<span class="ActionScriptDefault_Text">parser</span>.<span class="ActionScriptDefault_Text">readGeometries</span><span class="ActionScriptBracket/Brace">()</span>;
            <span class="ActionScriptBracket/Brace">}</span>
            <span class="ActionScriptReserved">else</span>
            <span class="ActionScriptBracket/Brace">{</span>
                <span class="ActionScriptDefault_Text">buildScene</span><span class="ActionScriptBracket/Brace">()</span>; 
            <span class="ActionScriptBracket/Brace">}</span>
            
            
            
            
        <span class="ActionScriptBracket/Brace">}</span>
        
        <span class="ActionScriptReserved">protected</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">onParseGeometriesComplete</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">e</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">Event</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptOperator">:</span> <span class="ActionScriptReserved">void</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptReserved">if</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptReserved">this</span>.<span class="ActionScriptDefault_Text">parser</span>.<span class="ActionScriptDefault_Text">hasEventListener</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">Event</span>.<span class="ActionScriptDefault_Text">COMPLETE</span><span class="ActionScriptBracket/Brace">))</span>
                <span class="ActionScriptReserved">this</span>.<span class="ActionScriptDefault_Text">parser</span>.<span class="ActionScriptDefault_Text">removeEventListener</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">Event</span>.<span class="ActionScriptDefault_Text">COMPLETE</span>, <span class="ActionScriptDefault_Text">onParseGeometriesComplete</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptDefault_Text">buildScene</span><span class="ActionScriptBracket/Brace">()</span>; 
        <span class="ActionScriptBracket/Brace">}</span>
        
        <span class="ActionScriptASDoc">/**
         * Merge geometries.
         * 
         * @param target The target geometry to merge to.
         * @param source The source geometry
         * @param material Optional material for triangles, only used when a triangle has no material.
         */</span> 
        <span class="ActionScriptReserved">protected</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">mergeGeometries</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">target</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">GeometryObject3D</span>, <span class="ActionScriptDefault_Text">source</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">GeometryObject3D</span>, <span class="ActionScriptDefault_Text">materialInstances</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">Array</span><span class="ActionScriptOperator">=</span><span class="ActionScriptReserved">null</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">:</span><span class="ActionScriptReserved">void</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptReserved">if</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">materialInstances</span> <span class="ActionScriptOperator">&amp;&amp;</span> <span class="ActionScriptDefault_Text">materialInstances</span>.<span class="ActionScriptDefault_Text">length</span><span class="ActionScriptBracket/Brace">)</span>
            <span class="ActionScriptBracket/Brace">{</span>
                <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">firstMaterial</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">MaterialObject3D</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">materialInstances</span><span class="ActionScriptBracket/Brace">[</span>0<span class="ActionScriptBracket/Brace">]</span>;
                
                <span class="ActionScriptReserved">for</span> <span class="ActionScriptReserved">each</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">triangle</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">Triangle3D</span> <span class="ActionScriptReserved">in</span> <span class="ActionScriptDefault_Text">source</span>.<span class="ActionScriptDefault_Text">faces</span><span class="ActionScriptBracket/Brace">)</span>
                <span class="ActionScriptBracket/Brace">{</span>
                    <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">correctMaterial</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">Boolean</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">false</span>;
                    <span class="ActionScriptReserved">for</span> <span class="ActionScriptReserved">each</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">material</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">MaterialObject3D</span> <span class="ActionScriptReserved">in</span> <span class="ActionScriptDefault_Text">materialInstances</span><span class="ActionScriptBracket/Brace">)</span>
                    <span class="ActionScriptBracket/Brace">{</span>
                        <span class="ActionScriptReserved">if</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">material</span> <span class="ActionScriptOperator">===</span> <span class="ActionScriptDefault_Text">triangle</span>.<span class="ActionScriptDefault_Text">material</span><span class="ActionScriptBracket/Brace">)</span>
                        <span class="ActionScriptBracket/Brace">{</span>
                            <span class="ActionScriptDefault_Text">correctMaterial</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">true</span>;
                            <span class="ActionScriptReserved">break</span>;
                        <span class="ActionScriptBracket/Brace">}</span>
                    <span class="ActionScriptBracket/Brace">}</span>
                    <span class="ActionScriptDefault_Text">triangle</span>.<span class="ActionScriptDefault_Text">material</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">correctMaterial</span> <span class="ActionScriptOperator">?</span> <span class="ActionScriptDefault_Text">triangle</span>.<span class="ActionScriptDefault_Text">material</span> <span class="ActionScriptOperator">:</span> <span class="ActionScriptDefault_Text">firstMaterial</span>;
                <span class="ActionScriptBracket/Brace">}</span>
            <span class="ActionScriptBracket/Brace">}</span>
            <span class="ActionScriptDefault_Text">target</span>.<span class="ActionScriptDefault_Text">vertices</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">target</span>.<span class="ActionScriptDefault_Text">vertices</span>.<span class="ActionScriptDefault_Text">concat</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">source</span>.<span class="ActionScriptDefault_Text">vertices</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptDefault_Text">target</span>.<span class="ActionScriptDefault_Text">faces</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">target</span>.<span class="ActionScriptDefault_Text">faces</span>.<span class="ActionScriptDefault_Text">concat</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">source</span>.<span class="ActionScriptDefault_Text">faces</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptDefault_Text">target</span>.<span class="ActionScriptDefault_Text">ready</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">true</span>;
        <span class="ActionScriptBracket/Brace">}</span>

        <span class="ActionScriptASDoc">/**
         * Called when a BitmapMaterial failed to load.
         * 
         * @param    event
         */</span> 
        <span class="ActionScriptReserved">protected</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">onMaterialError</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">event</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">Event</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">:</span><span class="ActionScriptReserved">void</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptDefault_Text">loadNextMaterial</span><span class="ActionScriptBracket/Brace">()</span>;    
        <span class="ActionScriptBracket/Brace">}</span>
        
        <span class="ActionScriptASDoc">/**
         * Called when the parser completed parsing animations.
         * 
         * @param    event
         */</span> 
        <span class="ActionScriptReserved">protected</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">onParseAnimationsComplete</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">event</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">Event</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">:</span><span class="ActionScriptReserved">void</span>
        <span class="ActionScriptBracket/Brace">{</span>    
            <span class="ActionScriptDefault_Text">buildAnimationChannels</span><span class="ActionScriptBracket/Brace">()</span>;
                    
            <span class="ActionScriptDefault_Text">_channels</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">this</span>.<span class="ActionScriptDefault_Text">getAnimationChannels</span><span class="ActionScriptBracket/Brace">()</span> <span class="ActionScriptOperator">||</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">Array</span><span class="ActionScriptBracket/Brace">()</span>;    
            <span class="ActionScriptDefault_Text">_currentFrame</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">_totalFrames</span> <span class="ActionScriptOperator">=</span> 0;
            <span class="ActionScriptDefault_Text">_startTime</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">_endTime</span> <span class="ActionScriptOperator">=</span> 0;
            
            <span class="ActionScriptReserved">for</span> <span class="ActionScriptReserved">each</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">channel</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">AbstractChannel3D</span> <span class="ActionScriptReserved">in</span> <span class="ActionScriptDefault_Text">_channels</span><span class="ActionScriptBracket/Brace">)</span>
            <span class="ActionScriptBracket/Brace">{</span>
                <span class="ActionScriptDefault_Text">_totalFrames</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">Math</span>.<span class="ActionScriptDefault_Text">max</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">_totalFrames</span>, <span class="ActionScriptDefault_Text">channel</span>.<span class="ActionScriptDefault_Text">keyFrames</span>.<span class="ActionScriptDefault_Text">length</span><span class="ActionScriptBracket/Brace">)</span>;    
                <span class="ActionScriptDefault_Text">_startTime</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">Math</span>.<span class="ActionScriptDefault_Text">min</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">_startTime</span>, <span class="ActionScriptDefault_Text">channel</span>.<span class="ActionScriptDefault_Text">startTime</span><span class="ActionScriptBracket/Brace">)</span>;
                <span class="ActionScriptDefault_Text">_endTime</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">Math</span>.<span class="ActionScriptDefault_Text">max</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">_endTime</span>, <span class="ActionScriptDefault_Text">channel</span>.<span class="ActionScriptDefault_Text">endTime</span><span class="ActionScriptBracket/Brace">)</span>;
                <span class="ActionScriptDefault_Text">channel</span>.<span class="ActionScriptDefault_Text">updateToTime</span><span class="ActionScriptBracket/Brace">(</span>0<span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptBracket/Brace">}</span>
            
            <span class="ActionScriptDefault_Text">PaperLogger</span>.<span class="ActionScriptDefault_Text">info</span><span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptString">&quot;animations COMPLETE (#channels: &quot;</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptDefault_Text">_channels</span>.<span class="ActionScriptDefault_Text">length</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptString">&quot; #frames: &quot;</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptDefault_Text">_totalFrames</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptString">&quot;, startTime: &quot;</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptDefault_Text">_startTime</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptString">&quot; endTime: &quot;</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptDefault_Text">_endTime</span><span class="ActionScriptOperator">+</span> <span class="ActionScriptString">&quot;)&quot;</span><span class="ActionScriptBracket/Brace">)</span>;
            
            <span class="ActionScriptDefault_Text">dispatchEvent</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">FileLoadEvent</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">FileLoadEvent</span>.<span class="ActionScriptDefault_Text">ANIMATIONS_COMPLETE</span>, <span class="ActionScriptReserved">this</span>.<span class="ActionScriptDefault_Text">filename</span><span class="ActionScriptBracket/Brace">))</span>;
            
            <span class="ActionScriptReserved">if</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">_autoPlay</span><span class="ActionScriptBracket/Brace">)</span>
                <span class="ActionScriptDefault_Text">play</span><span class="ActionScriptBracket/Brace">()</span>;
        <span class="ActionScriptBracket/Brace">}</span>
        
        <span class="ActionScriptASDoc">/**
         * Called on parse animations progress.
         * 
         * @param    event
         */</span> 
        <span class="ActionScriptReserved">protected</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">onParseAnimationsProgress</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">event</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">ProgressEvent</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">:</span><span class="ActionScriptReserved">void</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptDefault_Text">PaperLogger</span>.<span class="ActionScriptDefault_Text">info</span><span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptString">&quot;animations #&quot;</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptDefault_Text">event</span>.<span class="ActionScriptDefault_Text">bytesLoaded</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptString">&quot; of &quot;</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptDefault_Text">event</span>.<span class="ActionScriptDefault_Text">bytesTotal</span><span class="ActionScriptBracket/Brace">)</span>;
        <span class="ActionScriptBracket/Brace">}</span>
        
        <span class="ActionScriptASDoc">/**
         * Called when the DaeReader completed parsing.
         * 
         * @param    event
         */</span>
        <span class="ActionScriptReserved">protected</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">onParseComplete</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">event</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">Event</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">:</span><span class="ActionScriptReserved">void</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">reader</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">DaeReader</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">event</span>.<span class="ActionScriptDefault_Text">target</span> <span class="ActionScriptReserved">as</span> <span class="ActionScriptDefault_Text">DaeReader</span>;
            
            <span class="ActionScriptReserved">this</span>.<span class="ActionScriptDefault_Text">document</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">reader</span>.<span class="ActionScriptDefault_Text">document</span>;
            
            <span class="ActionScriptDefault_Text">_textureSets</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">Object</span><span class="ActionScriptBracket/Brace">()</span>;
            <span class="ActionScriptDefault_Text">_colladaID</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">Dictionary</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptReserved">true</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptDefault_Text">_colladaSID</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">Dictionary</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptReserved">true</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptDefault_Text">_colladaIDToObject</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">Object</span><span class="ActionScriptBracket/Brace">()</span>;
            <span class="ActionScriptDefault_Text">_colladaSIDToObject</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">Object</span><span class="ActionScriptBracket/Brace">()</span>;
            <span class="ActionScriptDefault_Text">_objectToNode</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">Object</span><span class="ActionScriptBracket/Brace">()</span>;
            <span class="ActionScriptDefault_Text">_skins</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">Dictionary</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptReserved">true</span><span class="ActionScriptBracket/Brace">)</span>;
            
            <span class="ActionScriptDefault_Text">buildMaterials</span><span class="ActionScriptBracket/Brace">()</span>;
            <span class="ActionScriptDefault_Text">loadNextMaterial</span><span class="ActionScriptBracket/Brace">()</span>;
        <span class="ActionScriptBracket/Brace">}</span>
        
        <span class="ActionScriptASDoc">/**
         * Called on parsing progress.
         * 
         * @param    event
         */</span> 
        <span class="ActionScriptReserved">protected</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">onParseProgress</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">event</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">ProgressEvent</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">:</span><span class="ActionScriptReserved">void</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptDefault_Text">dispatchEvent</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">FileLoadEvent</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">FileLoadEvent</span>.<span class="ActionScriptDefault_Text">LOAD_PROGRESS</span>, <span class="ActionScriptReserved">this</span>.<span class="ActionScriptDefault_Text">filename</span>, <span class="ActionScriptDefault_Text">event</span>.<span class="ActionScriptDefault_Text">bytesLoaded</span>, <span class="ActionScriptDefault_Text">event</span>.<span class="ActionScriptDefault_Text">bytesTotal</span>, <span class="ActionScriptReserved">null</span>, <span class="ActionScriptReserved">null</span>, <span class="ActionScriptReserved">true</span>, <span class="ActionScriptReserved">false</span><span class="ActionScriptBracket/Brace">))</span>;
        <span class="ActionScriptBracket/Brace">}</span>
        
        <span class="ActionScriptASDoc">/** Whether the COLLADA uses Y-up, Z-up otherwise. */</span>
        <span class="ActionScriptReserved">public</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptReserved">get</span> <span class="ActionScriptDefault_Text">yUp</span><span class="ActionScriptBracket/Brace">()</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">Boolean</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptReserved">if</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptReserved">this</span>.<span class="ActionScriptDefault_Text">document</span><span class="ActionScriptBracket/Brace">){</span>
                <span class="ActionScriptReserved">return</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptReserved">this</span>.<span class="ActionScriptDefault_Text">document</span>.<span class="ActionScriptDefault_Text">asset</span>.<span class="ActionScriptDefault_Text">yUp</span> <span class="ActionScriptOperator">==</span> <span class="ActionScriptDefault_Text">ASCollada</span>.<span class="ActionScriptDefault_Text">DAE_Y_UP</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptBracket/Brace">}</span><span class="ActionScriptReserved">else</span><span class="ActionScriptBracket/Brace">{</span>
                <span class="ActionScriptReserved">return</span> <span class="ActionScriptReserved">false</span>;
            <span class="ActionScriptBracket/Brace">}</span>
        <span class="ActionScriptBracket/Brace">}</span>
        
    <span class="ActionScriptBracket/Brace">}</span>
<span class="ActionScriptBracket/Brace">}</span>

</pre></body>
</html>
