<!-- saved from url=(0014)about:internet -->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<title>FLARMat.as</title>
<link rel="stylesheet" type="text/css" href="../../../../../../SourceStyles.css"/>
</head>

<body><pre><span class="ActionScriptComment">/* 
 * PROJECT: FLARToolKit
 * --------------------------------------------------------------------------------
 * This work is based on the NyARToolKit developed by
 *   R.Iizuka (nyatla)
 * http://nyatla.jp/nyatoolkit/
 *
 * The FLARToolKit is ActionScript 3.0 version ARToolkit class library.
 * Copyright (C)2008 Saqoosha
 *
 * This program is free software; you can redistribute it and/or
 * modify it under the terms of the GNU General Public License
 * as published by the Free Software Foundation; either version 2
 * of the License, or (at your option) any later version.
 * 
 * This program is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 * GNU General Public License for more details.
 * 
 * You should have received a copy of the GNU General Public License
 * along with this framework; if not, write to the Free Software
 * Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307  USA
 * 
 * For further information please contact.
 *    http://www.libspark.org/wiki/saqoosha/FLARToolKit
 *    &lt;saq(at)saqoosha.net&gt;
 * 
 */</span>

<span class="ActionScriptpackage">package</span> <span class="ActionScriptDefault_Text">org</span>.<span class="ActionScriptDefault_Text">libspark</span>.<span class="ActionScriptDefault_Text">flartoolkit</span>.<span class="ActionScriptDefault_Text">core</span> <span class="ActionScriptBracket/Brace">{</span>
    <span class="ActionScriptReserved">import</span> <span class="ActionScriptDefault_Text">org</span>.<span class="ActionScriptDefault_Text">libspark</span>.<span class="ActionScriptDefault_Text">flartoolkit</span>.<span class="ActionScriptDefault_Text">core</span>.<span class="ActionScriptDefault_Text">FLARException</span>;
    <span class="ActionScriptReserved">import</span> <span class="ActionScriptDefault_Text">org</span>.<span class="ActionScriptDefault_Text">libspark</span>.<span class="ActionScriptDefault_Text">flartoolkit</span>.<span class="ActionScriptDefault_Text">utils</span>.<span class="ActionScriptDefault_Text">ArrayUtil</span>;    

    <span class="ActionScriptASDoc">/**
     * ARMat構造体に対応するクラス typedef struct { double *m; int row; int clm; }ARMat;
     * 
     */</span>
    <span class="ActionScriptReserved">public</span> <span class="ActionScriptclass">class</span> <span class="ActionScriptDefault_Text">FLARMat</span> <span class="ActionScriptBracket/Brace">{</span>

        <span class="ActionScriptASDoc">/**
         * 配列サイズと行列サイズは必ずしも一致しないことに注意 返された配列のサイズを行列の大きさとして使わないこと！
         * 
         */</span>
        <span class="ActionScriptReserved">protected</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">m</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">Array</span>; 
        <span class="ActionScriptComment">// double[][]
</span>
        <span class="ActionScriptReserved">private</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">clm</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">int</span>;
        <span class="ActionScriptReserved">private</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">row</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">int</span>;

        <span class="ActionScriptASDoc">/**
         * デフォルトコンストラクタは機能しません。
         * 
         * @throws FLARException
         */</span>
        <span class="ActionScriptComment">//    protected function FLARMat()
</span>        <span class="ActionScriptComment">//    {
</span>        <span class="ActionScriptComment">//        throw new FLARException();
</span>        <span class="ActionScriptComment">//    }
</span>
        <span class="ActionScriptReserved">public</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">FLARMat</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">i_row</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">int</span>, <span class="ActionScriptDefault_Text">i_clm</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">int</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptComment">//        m = new double[i_row][i_clm];
</span>            <span class="ActionScriptDefault_Text">m</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">ArrayUtil</span>.<span class="ActionScriptDefault_Text">createJaggedArray</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">i_row</span>, <span class="ActionScriptDefault_Text">i_clm</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptDefault_Text">clm</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">i_clm</span>;
            <span class="ActionScriptDefault_Text">row</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">i_row</span>;
        <span class="ActionScriptBracket/Brace">}</span>

        <span class="ActionScriptASDoc">/**
         * i_row x i_clmサイズの行列を格納できるように行列サイズを変更します。 実行後、行列の各値は不定になります。
         * 
         * @param i_row
         * @param i_clm
         */</span>
        <span class="ActionScriptReserved">public</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">realloc</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">i_row</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">int</span>, <span class="ActionScriptDefault_Text">i_clm</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">int</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">:</span><span class="ActionScriptReserved">void</span> <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">i_row</span> <span class="ActionScriptOperator">&lt;=</span> <span class="ActionScriptReserved">this</span>.<span class="ActionScriptDefault_Text">m</span>.<span class="ActionScriptDefault_Text">length</span> <span class="ActionScriptOperator">&amp;&amp;</span> <span class="ActionScriptDefault_Text">i_clm</span> <span class="ActionScriptOperator">&lt;=</span> <span class="ActionScriptReserved">this</span>.<span class="ActionScriptDefault_Text">m</span><span class="ActionScriptBracket/Brace">[</span>0<span class="ActionScriptBracket/Brace">]</span>.<span class="ActionScriptDefault_Text">length</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptComment">// 十分な配列があれば何もしない。
</span>        <span class="ActionScriptBracket/Brace">}</span> <span class="ActionScriptReserved">else</span> <span class="ActionScriptBracket/Brace">{</span>
                <span class="ActionScriptComment">// 不十分なら取り直す。
</span>                <span class="ActionScriptComment">//            m = new double[i_row][i_clm];
</span>                <span class="ActionScriptDefault_Text">m</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">ArrayUtil</span>.<span class="ActionScriptDefault_Text">createJaggedArray</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">i_row</span>, <span class="ActionScriptDefault_Text">i_clm</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptBracket/Brace">}</span>
            <span class="ActionScriptReserved">this</span>.<span class="ActionScriptDefault_Text">clm</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">i_clm</span>;
            <span class="ActionScriptReserved">this</span>.<span class="ActionScriptDefault_Text">row</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">i_row</span>;
        <span class="ActionScriptBracket/Brace">}</span>

        <span class="ActionScriptReserved">public</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">getClm</span><span class="ActionScriptBracket/Brace">()</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">int</span> <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptReserved">return</span> <span class="ActionScriptDefault_Text">clm</span>;
        <span class="ActionScriptBracket/Brace">}</span>

        <span class="ActionScriptReserved">public</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">getRow</span><span class="ActionScriptBracket/Brace">()</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">int</span> <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptReserved">return</span> <span class="ActionScriptDefault_Text">row</span>;
        <span class="ActionScriptBracket/Brace">}</span>

        <span class="ActionScriptASDoc">/**
         * 行列をゼロクリアする。
         */</span>
        <span class="ActionScriptReserved">public</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">zeroClear</span><span class="ActionScriptBracket/Brace">()</span><span class="ActionScriptOperator">:</span><span class="ActionScriptReserved">void</span> <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">i</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">int</span>;
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">i2</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">int</span>;
            <span class="ActionScriptComment">// For順変更OK
</span>            <span class="ActionScriptReserved">for</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">i</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">row</span> <span class="ActionScriptOperator">-</span> 1;<span class="ActionScriptDefault_Text">i</span> <span class="ActionScriptOperator">&gt;=</span> 0; <span class="ActionScriptDefault_Text">i</span><span class="ActionScriptOperator">--</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptBracket/Brace">{</span>
                <span class="ActionScriptReserved">for</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">i2</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">clm</span> <span class="ActionScriptOperator">-</span> 1;<span class="ActionScriptDefault_Text">i2</span> <span class="ActionScriptOperator">&gt;=</span> 0; <span class="ActionScriptDefault_Text">i2</span><span class="ActionScriptOperator">--</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptBracket/Brace">{</span>
                    <span class="ActionScriptDefault_Text">m</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">i</span><span class="ActionScriptBracket/Brace">][</span><span class="ActionScriptDefault_Text">i2</span><span class="ActionScriptBracket/Brace">]</span> <span class="ActionScriptOperator">=</span> 0.0;
                <span class="ActionScriptBracket/Brace">}</span>
            <span class="ActionScriptBracket/Brace">}</span>
        <span class="ActionScriptBracket/Brace">}</span>

        <span class="ActionScriptASDoc">/**
         * i_copy_fromの内容を自分自身にコピーします。 高さ・幅は同一で無いと失敗します。
         * 
         * @param i_copy_from
         */</span>
        <span class="ActionScriptReserved">public</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">copyFrom</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">i_copy_from</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">FLARMat</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">:</span><span class="ActionScriptReserved">void</span> <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptComment">// サイズ確認
</span>            <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptReserved">this</span>.<span class="ActionScriptDefault_Text">row</span> <span class="ActionScriptOperator">!=</span> <span class="ActionScriptDefault_Text">i_copy_from</span>.<span class="ActionScriptDefault_Text">row</span> <span class="ActionScriptOperator">||</span> <span class="ActionScriptReserved">this</span>.<span class="ActionScriptDefault_Text">clm</span> <span class="ActionScriptOperator">!=</span> <span class="ActionScriptDefault_Text">i_copy_from</span>.<span class="ActionScriptDefault_Text">clm</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptBracket/Brace">{</span>
                <span class="ActionScriptReserved">throw</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">FLARException</span><span class="ActionScriptBracket/Brace">()</span>;
            <span class="ActionScriptBracket/Brace">}</span>
            <span class="ActionScriptComment">// 値コピー
</span>            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">r</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">int</span>;
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">c</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">int</span>;
            <span class="ActionScriptReserved">for</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">r</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">this</span>.<span class="ActionScriptDefault_Text">row</span> <span class="ActionScriptOperator">-</span> 1;<span class="ActionScriptDefault_Text">r</span> <span class="ActionScriptOperator">&gt;=</span> 0; <span class="ActionScriptDefault_Text">r</span><span class="ActionScriptOperator">--</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptBracket/Brace">{</span>
                <span class="ActionScriptReserved">for</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">c</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">this</span>.<span class="ActionScriptDefault_Text">clm</span> <span class="ActionScriptOperator">-</span> 1;<span class="ActionScriptDefault_Text">c</span> <span class="ActionScriptOperator">&gt;=</span> 0; <span class="ActionScriptDefault_Text">c</span><span class="ActionScriptOperator">--</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptBracket/Brace">{</span>
                    <span class="ActionScriptReserved">this</span>.<span class="ActionScriptDefault_Text">m</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">r</span><span class="ActionScriptBracket/Brace">][</span><span class="ActionScriptDefault_Text">c</span><span class="ActionScriptBracket/Brace">]</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">i_copy_from</span>.<span class="ActionScriptDefault_Text">m</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">r</span><span class="ActionScriptBracket/Brace">][</span><span class="ActionScriptDefault_Text">c</span><span class="ActionScriptBracket/Brace">]</span>;
                <span class="ActionScriptBracket/Brace">}</span>
            <span class="ActionScriptBracket/Brace">}</span>
        <span class="ActionScriptBracket/Brace">}</span>

        <span class="ActionScriptReserved">public</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">getArray</span><span class="ActionScriptBracket/Brace">()</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">Array</span> <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptReserved">return</span> <span class="ActionScriptDefault_Text">m</span>;
        <span class="ActionScriptBracket/Brace">}</span>

        <span class="ActionScriptComment">// public void getRowVec(int i_row,FLARVec o_vec)
</span>        <span class="ActionScriptComment">// {
</span>        <span class="ActionScriptComment">// o_vec.set(this.m[i_row],this.clm);
</span>        <span class="ActionScriptComment">// }
</span>        <span class="ActionScriptASDoc">/**
         * aとbの積を自分自身に格納する。arMatrixMul()の代替品
         * 
         * @param a
         * @param b
         * @throws FLARException
         */</span>
        <span class="ActionScriptReserved">public</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">matrixMul</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">a</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">FLARMat</span>, <span class="ActionScriptDefault_Text">b</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">FLARMat</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">:</span><span class="ActionScriptReserved">void</span> <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">a</span>.<span class="ActionScriptDefault_Text">clm</span> <span class="ActionScriptOperator">!=</span> <span class="ActionScriptDefault_Text">b</span>.<span class="ActionScriptDefault_Text">row</span> <span class="ActionScriptOperator">||</span> <span class="ActionScriptReserved">this</span>.<span class="ActionScriptDefault_Text">row</span> <span class="ActionScriptOperator">!=</span> <span class="ActionScriptDefault_Text">a</span>.<span class="ActionScriptDefault_Text">row</span> <span class="ActionScriptOperator">||</span> <span class="ActionScriptReserved">this</span>.<span class="ActionScriptDefault_Text">clm</span> <span class="ActionScriptOperator">!=</span> <span class="ActionScriptDefault_Text">b</span>.<span class="ActionScriptDefault_Text">clm</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptBracket/Brace">{</span>
                <span class="ActionScriptReserved">throw</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">FLARException</span><span class="ActionScriptBracket/Brace">()</span>;
            <span class="ActionScriptBracket/Brace">}</span>
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">w</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">Number</span>;
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">r</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">int</span>;
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">c</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">int</span>;
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">i</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">int</span>;
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">am</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">Array</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">a</span>.<span class="ActionScriptDefault_Text">m</span>;
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">bm</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">Array</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">b</span>.<span class="ActionScriptDefault_Text">m</span>;
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">dm</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">Array</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">this</span>.<span class="ActionScriptDefault_Text">m</span>;
            <span class="ActionScriptComment">// For順変更禁止
</span>            <span class="ActionScriptReserved">for</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">r</span> <span class="ActionScriptOperator">=</span> 0;<span class="ActionScriptDefault_Text">r</span> <span class="ActionScriptOperator">&lt;</span> <span class="ActionScriptReserved">this</span>.<span class="ActionScriptDefault_Text">row</span>; <span class="ActionScriptDefault_Text">r</span><span class="ActionScriptOperator">++</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptBracket/Brace">{</span>
                <span class="ActionScriptReserved">for</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">c</span> <span class="ActionScriptOperator">=</span> 0;<span class="ActionScriptDefault_Text">c</span> <span class="ActionScriptOperator">&lt;</span> <span class="ActionScriptReserved">this</span>.<span class="ActionScriptDefault_Text">clm</span>; <span class="ActionScriptDefault_Text">c</span><span class="ActionScriptOperator">++</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptBracket/Brace">{</span>
                    <span class="ActionScriptDefault_Text">w</span> <span class="ActionScriptOperator">=</span> 0.0;
                    <span class="ActionScriptComment">// dest.setARELEM0(r, c,0.0);
</span>                    <span class="ActionScriptReserved">for</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">i</span> <span class="ActionScriptOperator">=</span> 0;<span class="ActionScriptDefault_Text">i</span> <span class="ActionScriptOperator">&lt;</span> <span class="ActionScriptDefault_Text">a</span>.<span class="ActionScriptDefault_Text">clm</span>; <span class="ActionScriptDefault_Text">i</span><span class="ActionScriptOperator">++</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptBracket/Brace">{</span>
                        <span class="ActionScriptDefault_Text">w</span> <span class="ActionScriptOperator">+=</span> <span class="ActionScriptDefault_Text">am</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">r</span><span class="ActionScriptBracket/Brace">][</span><span class="ActionScriptDefault_Text">i</span><span class="ActionScriptBracket/Brace">]</span> <span class="ActionScriptOperator">*</span> <span class="ActionScriptDefault_Text">bm</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">i</span><span class="ActionScriptBracket/Brace">][</span><span class="ActionScriptDefault_Text">c</span><span class="ActionScriptBracket/Brace">]</span>;<span class="ActionScriptComment">// ARELEM0(dest, r, c) +=ARELEM0(a, r, i) * ARELEM0(b,i, c);
</span>                    <span class="ActionScriptBracket/Brace">}</span>
                    <span class="ActionScriptDefault_Text">dm</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">r</span><span class="ActionScriptBracket/Brace">][</span><span class="ActionScriptDefault_Text">c</span><span class="ActionScriptBracket/Brace">]</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">w</span>;
                <span class="ActionScriptBracket/Brace">}</span>
            <span class="ActionScriptBracket/Brace">}</span>
        <span class="ActionScriptBracket/Brace">}</span>

        <span class="ActionScriptReserved">private</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">wk_nos_matrixSelfInv</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">Array</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">Array</span><span class="ActionScriptBracket/Brace">(</span>50<span class="ActionScriptBracket/Brace">)</span>; 
        
        <span class="ActionScriptComment">// new int[50];
</span>
        <span class="ActionScriptComment">// private final static double matrixSelfInv_epsl=1.0e-10;
</span>        <span class="ActionScriptASDoc">/**
         * i_targetを逆行列に変換する。arMatrixSelfInv()と、arMatrixSelfInv_minv()関数を合成してあります。
         * OPTIMIZE STEP[485-&gt;422]
         * 
         * @param i_target
         *            逆行列にする行列
         * @return 逆行列があればTRUE/無ければFALSE
         * 
         * @throws FLARException
         */</span>
        <span class="ActionScriptReserved">public</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">matrixSelfInv</span><span class="ActionScriptBracket/Brace">()</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">Boolean</span> <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">ap</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">Array</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">this</span>.<span class="ActionScriptDefault_Text">m</span>;
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">dimen</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">int</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">this</span>.<span class="ActionScriptDefault_Text">row</span>;
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">dimen_1</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">int</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">dimen</span> <span class="ActionScriptOperator">-</span> 1;
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">ap_n</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">Array</span>;
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">ap_ip</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">Array</span>;
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">ap_i</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">Array</span>;
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">j</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">int</span>;
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">ip</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">int</span>;
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">nwork</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">int</span>;
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">nos</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">Array</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">wk_nos_matrixSelfInv</span>;
            <span class="ActionScriptComment">// この関数で初期化される。
</span>            <span class="ActionScriptComment">// double epsl;
</span>            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">p</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">Number</span>;
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">pbuf</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">Number</span>;
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">work</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">Number</span>;

            <span class="ActionScriptComment">/* check size */</span>
            <span class="ActionScriptReserved">switch</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">dimen</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptBracket/Brace">{</span>
                <span class="ActionScriptReserved">case</span> 0<span class="ActionScriptOperator">:</span>
                    <span class="ActionScriptReserved">throw</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">FLARException</span><span class="ActionScriptBracket/Brace">()</span>;
                <span class="ActionScriptReserved">case</span> 1<span class="ActionScriptOperator">:</span>
                    <span class="ActionScriptDefault_Text">ap</span><span class="ActionScriptBracket/Brace">[</span>0<span class="ActionScriptBracket/Brace">][</span>0<span class="ActionScriptBracket/Brace">]</span> <span class="ActionScriptOperator">=</span> 1.0 <span class="ActionScriptOperator">/</span> <span class="ActionScriptDefault_Text">ap</span><span class="ActionScriptBracket/Brace">[</span>0<span class="ActionScriptBracket/Brace">][</span>0<span class="ActionScriptBracket/Brace">]</span>;
                    <span class="ActionScriptComment">// *ap = 1.0 / (*ap);
</span>                    <span class="ActionScriptReserved">return</span> <span class="ActionScriptReserved">true</span>;<span class="ActionScriptComment">/* 1 dimension */</span>
            <span class="ActionScriptBracket/Brace">}</span>

            <span class="ActionScriptReserved">for</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">n</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">int</span> <span class="ActionScriptOperator">=</span> 0;<span class="ActionScriptDefault_Text">n</span> <span class="ActionScriptOperator">&lt;</span> <span class="ActionScriptDefault_Text">dimen</span>; <span class="ActionScriptDefault_Text">n</span><span class="ActionScriptOperator">++</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptBracket/Brace">{</span>
                <span class="ActionScriptDefault_Text">nos</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">n</span><span class="ActionScriptBracket/Brace">]</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">n</span>;
            <span class="ActionScriptBracket/Brace">}</span>

            <span class="ActionScriptComment">/*
             * nyatla memo ipが定まらないで計算が行われる場合があるので挿入。 ループ内で0初期化していいかが判らない。
             */</span>
            <span class="ActionScriptDefault_Text">ip</span> <span class="ActionScriptOperator">=</span> 0;
            <span class="ActionScriptComment">// For順変更禁止
</span>            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">i</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">int</span>;
            <span class="ActionScriptReserved">for</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">n</span> <span class="ActionScriptOperator">=</span> 0;<span class="ActionScriptDefault_Text">n</span> <span class="ActionScriptOperator">&lt;</span> <span class="ActionScriptDefault_Text">dimen</span>; <span class="ActionScriptDefault_Text">n</span><span class="ActionScriptOperator">++</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptBracket/Brace">{</span>
                <span class="ActionScriptDefault_Text">ap_n</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">ap</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">n</span><span class="ActionScriptBracket/Brace">]</span>;
                <span class="ActionScriptComment">// wcp = ap + n * rowa;
</span>                <span class="ActionScriptDefault_Text">p</span> <span class="ActionScriptOperator">=</span> 0.0;
                <span class="ActionScriptReserved">for</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">i</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">n</span>;<span class="ActionScriptDefault_Text">i</span> <span class="ActionScriptOperator">&lt;</span> <span class="ActionScriptDefault_Text">dimen</span>; <span class="ActionScriptDefault_Text">i</span><span class="ActionScriptOperator">++</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptBracket/Brace">{</span>
                    <span class="ActionScriptComment">// for(i = n, wap = wcp, p =
</span>                    <span class="ActionScriptComment">// 0.0; i &lt; dimen ; i++, wap +=
</span>                    <span class="ActionScriptComment">// rowa)
</span>                    <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">p</span> <span class="ActionScriptOperator">&lt;</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">pbuf</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">Math</span>.<span class="ActionScriptDefault_Text">abs</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">ap</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">i</span><span class="ActionScriptBracket/Brace">][</span>0<span class="ActionScriptBracket/Brace">])))</span> <span class="ActionScriptBracket/Brace">{</span>
                        <span class="ActionScriptDefault_Text">p</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">pbuf</span>;
                        <span class="ActionScriptDefault_Text">ip</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">i</span>;
                    <span class="ActionScriptBracket/Brace">}</span>
                <span class="ActionScriptBracket/Brace">}</span>
                <span class="ActionScriptComment">// if (p &lt;= matrixSelfInv_epsl){
</span>                <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">p</span> <span class="ActionScriptOperator">==</span> 0.0<span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptBracket/Brace">{</span>
                    <span class="ActionScriptReserved">return</span> <span class="ActionScriptReserved">false</span>;
                <span class="ActionScriptComment">// throw new FLARException();
</span>                <span class="ActionScriptBracket/Brace">}</span>

                <span class="ActionScriptDefault_Text">nwork</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">nos</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">ip</span><span class="ActionScriptBracket/Brace">]</span>;
                <span class="ActionScriptDefault_Text">nos</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">ip</span><span class="ActionScriptBracket/Brace">]</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">nos</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">n</span><span class="ActionScriptBracket/Brace">]</span>;
                <span class="ActionScriptDefault_Text">nos</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">n</span><span class="ActionScriptBracket/Brace">]</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">nwork</span>;

                <span class="ActionScriptDefault_Text">ap_ip</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">ap</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">ip</span><span class="ActionScriptBracket/Brace">]</span>;
                <span class="ActionScriptReserved">for</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">j</span> <span class="ActionScriptOperator">=</span> 0;<span class="ActionScriptDefault_Text">j</span> <span class="ActionScriptOperator">&lt;</span> <span class="ActionScriptDefault_Text">dimen</span>; <span class="ActionScriptDefault_Text">j</span><span class="ActionScriptOperator">++</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptBracket/Brace">{</span>
                    <span class="ActionScriptComment">// for(j = 0, wap = ap + ip * rowa,
</span>                    <span class="ActionScriptComment">// wbp = wcp; j &lt; dimen ; j++) {
</span>                    <span class="ActionScriptDefault_Text">work</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">ap_ip</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">j</span><span class="ActionScriptBracket/Brace">]</span>; 
                    <span class="ActionScriptComment">// work = *wap;
</span>                    <span class="ActionScriptDefault_Text">ap_ip</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">j</span><span class="ActionScriptBracket/Brace">]</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">ap_n</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">j</span><span class="ActionScriptBracket/Brace">]</span>;
                    <span class="ActionScriptDefault_Text">ap_n</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">j</span><span class="ActionScriptBracket/Brace">]</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">work</span>;
                <span class="ActionScriptBracket/Brace">}</span>

                <span class="ActionScriptDefault_Text">work</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">ap_n</span><span class="ActionScriptBracket/Brace">[</span>0<span class="ActionScriptBracket/Brace">]</span>;
                <span class="ActionScriptReserved">for</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">j</span> <span class="ActionScriptOperator">=</span> 0;<span class="ActionScriptDefault_Text">j</span> <span class="ActionScriptOperator">&lt;</span> <span class="ActionScriptDefault_Text">dimen_1</span>; <span class="ActionScriptDefault_Text">j</span><span class="ActionScriptOperator">++</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptBracket/Brace">{</span>
                    <span class="ActionScriptComment">// for(j = 1, wap = wcp, work =
</span>                    <span class="ActionScriptComment">// *wcp; j &lt; dimen ; j++, wap++)
</span>                    <span class="ActionScriptDefault_Text">ap_n</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">j</span><span class="ActionScriptBracket/Brace">]</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">ap_n</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">j</span> <span class="ActionScriptOperator">+</span> 1<span class="ActionScriptBracket/Brace">]</span> <span class="ActionScriptOperator">/</span> <span class="ActionScriptDefault_Text">work</span>;<span class="ActionScriptComment">// *wap = *(wap + 1) / work;
</span>                <span class="ActionScriptBracket/Brace">}</span>
                <span class="ActionScriptDefault_Text">ap_n</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">j</span><span class="ActionScriptBracket/Brace">]</span> <span class="ActionScriptOperator">=</span> 1.0 <span class="ActionScriptOperator">/</span> <span class="ActionScriptDefault_Text">work</span>;
                <span class="ActionScriptComment">// *wap = 1.0 / work;
</span>                <span class="ActionScriptReserved">for</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">i</span> <span class="ActionScriptOperator">=</span> 0;<span class="ActionScriptDefault_Text">i</span> <span class="ActionScriptOperator">&lt;</span> <span class="ActionScriptDefault_Text">dimen</span>; <span class="ActionScriptDefault_Text">i</span><span class="ActionScriptOperator">++</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptBracket/Brace">{</span>
                    <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">i</span> <span class="ActionScriptOperator">!=</span> <span class="ActionScriptDefault_Text">n</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptBracket/Brace">{</span>
                        <span class="ActionScriptDefault_Text">ap_i</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">ap</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">i</span><span class="ActionScriptBracket/Brace">]</span>;
                        <span class="ActionScriptComment">// wap = ap + i * rowa;
</span>
                        <span class="ActionScriptDefault_Text">work</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">ap_i</span><span class="ActionScriptBracket/Brace">[</span>0<span class="ActionScriptBracket/Brace">]</span>;
                        <span class="ActionScriptReserved">for</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">j</span> <span class="ActionScriptOperator">=</span> 0; <span class="ActionScriptDefault_Text">j</span> <span class="ActionScriptOperator">&lt;</span> <span class="ActionScriptDefault_Text">dimen_1</span>; <span class="ActionScriptDefault_Text">j</span><span class="ActionScriptOperator">++</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptBracket/Brace">{</span>
                            <span class="ActionScriptComment">// for(j = 1, wbp = wcp,work = *wap;j &lt; dimen ;j++, wap++, wbp++)
</span>                            <span class="ActionScriptDefault_Text">ap_i</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">j</span><span class="ActionScriptBracket/Brace">]</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">ap_i</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">j</span> <span class="ActionScriptOperator">+</span> 1<span class="ActionScriptBracket/Brace">]</span> <span class="ActionScriptOperator">-</span> <span class="ActionScriptDefault_Text">work</span> <span class="ActionScriptOperator">*</span> <span class="ActionScriptDefault_Text">ap_n</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">j</span><span class="ActionScriptBracket/Brace">]</span>;<span class="ActionScriptComment">// wap = *(wap +1) - work *(*wbp);
</span>                        <span class="ActionScriptBracket/Brace">}</span>
                        <span class="ActionScriptDefault_Text">ap_i</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">j</span><span class="ActionScriptBracket/Brace">]</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptOperator">-</span><span class="ActionScriptDefault_Text">work</span> <span class="ActionScriptOperator">*</span> <span class="ActionScriptDefault_Text">ap_n</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">j</span><span class="ActionScriptBracket/Brace">]</span>;<span class="ActionScriptComment">// *wap = -work * (*wbp);
</span>                    <span class="ActionScriptBracket/Brace">}</span>
                <span class="ActionScriptBracket/Brace">}</span>
            <span class="ActionScriptBracket/Brace">}</span>

            <span class="ActionScriptReserved">for</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">n</span> <span class="ActionScriptOperator">=</span> 0;<span class="ActionScriptDefault_Text">n</span> <span class="ActionScriptOperator">&lt;</span> <span class="ActionScriptDefault_Text">dimen</span>; <span class="ActionScriptDefault_Text">n</span><span class="ActionScriptOperator">++</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptBracket/Brace">{</span>
                <span class="ActionScriptReserved">for</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">j</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">n</span>;<span class="ActionScriptDefault_Text">j</span> <span class="ActionScriptOperator">&lt;</span> <span class="ActionScriptDefault_Text">dimen</span>; <span class="ActionScriptDefault_Text">j</span><span class="ActionScriptOperator">++</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptBracket/Brace">{</span>
                    <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">nos</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">j</span><span class="ActionScriptBracket/Brace">]</span> <span class="ActionScriptOperator">==</span> <span class="ActionScriptDefault_Text">n</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptBracket/Brace">{</span>
                        <span class="ActionScriptReserved">break</span>;
                    <span class="ActionScriptBracket/Brace">}</span>
                <span class="ActionScriptBracket/Brace">}</span>
                <span class="ActionScriptDefault_Text">nos</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">j</span><span class="ActionScriptBracket/Brace">]</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">nos</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">n</span><span class="ActionScriptBracket/Brace">]</span>;
                <span class="ActionScriptReserved">for</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">i</span> <span class="ActionScriptOperator">=</span> 0; <span class="ActionScriptDefault_Text">i</span> <span class="ActionScriptOperator">&lt;</span> <span class="ActionScriptDefault_Text">dimen</span>; <span class="ActionScriptDefault_Text">i</span><span class="ActionScriptOperator">++</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptBracket/Brace">{</span>
                    <span class="ActionScriptComment">// for(i = 0, wap = ap + j, wbp
</span>                    <span class="ActionScriptComment">// = ap + n; i &lt; dimen ;i++, wap
</span>                    <span class="ActionScriptComment">// += rowa, wbp += rowa) {
</span>                    <span class="ActionScriptDefault_Text">ap_i</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">ap</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">i</span><span class="ActionScriptBracket/Brace">]</span>;
                    <span class="ActionScriptDefault_Text">work</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">ap_i</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">j</span><span class="ActionScriptBracket/Brace">]</span>;
                    <span class="ActionScriptComment">// work = *wap;
</span>                    <span class="ActionScriptDefault_Text">ap_i</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">j</span><span class="ActionScriptBracket/Brace">]</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">ap_i</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">n</span><span class="ActionScriptBracket/Brace">]</span>;
                    <span class="ActionScriptComment">// *wap = *wbp;
</span>                    <span class="ActionScriptDefault_Text">ap_i</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">n</span><span class="ActionScriptBracket/Brace">]</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">work</span>;<span class="ActionScriptComment">// *wbp = work;
</span>                <span class="ActionScriptBracket/Brace">}</span>
            <span class="ActionScriptBracket/Brace">}</span>
            <span class="ActionScriptReserved">return</span> <span class="ActionScriptReserved">true</span>;
        <span class="ActionScriptBracket/Brace">}</span>

        <span class="ActionScriptASDoc">/**
         * sourceの転置行列をdestに得る。arMatrixTrans()の代替品
         * 
         * @param dest
         * @param source
         * @return
         */</span>
        <span class="ActionScriptReserved">public</span> <span class="ActionScriptReserved">static</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">matrixTrans</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">dest</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">FLARMat</span>, <span class="ActionScriptDefault_Text">source</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">FLARMat</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">:</span><span class="ActionScriptReserved">void</span> <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">dest</span>.<span class="ActionScriptDefault_Text">row</span> <span class="ActionScriptOperator">!=</span> <span class="ActionScriptDefault_Text">source</span>.<span class="ActionScriptDefault_Text">clm</span> <span class="ActionScriptOperator">||</span> <span class="ActionScriptDefault_Text">dest</span>.<span class="ActionScriptDefault_Text">clm</span> <span class="ActionScriptOperator">!=</span> <span class="ActionScriptDefault_Text">source</span>.<span class="ActionScriptDefault_Text">row</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptBracket/Brace">{</span>
                <span class="ActionScriptReserved">throw</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">FLARException</span><span class="ActionScriptBracket/Brace">()</span>;
            <span class="ActionScriptBracket/Brace">}</span>
            <span class="ActionScriptDefault_Text">FLARException</span>.<span class="ActionScriptDefault_Text">trap</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">&quot;未チェックのパス&quot;</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptComment">// For順変更禁止
</span>            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">r</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">int</span>;
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">c</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">int</span>;
            <span class="ActionScriptReserved">for</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">r</span> <span class="ActionScriptOperator">=</span> 0; <span class="ActionScriptDefault_Text">r</span> <span class="ActionScriptOperator">&lt;</span> <span class="ActionScriptDefault_Text">dest</span>.<span class="ActionScriptDefault_Text">row</span>; <span class="ActionScriptDefault_Text">r</span><span class="ActionScriptOperator">++</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptBracket/Brace">{</span>
                <span class="ActionScriptReserved">for</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">c</span> <span class="ActionScriptOperator">=</span> 0; <span class="ActionScriptDefault_Text">c</span> <span class="ActionScriptOperator">&lt;</span> <span class="ActionScriptDefault_Text">dest</span>.<span class="ActionScriptDefault_Text">clm</span>; <span class="ActionScriptDefault_Text">c</span><span class="ActionScriptOperator">++</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptBracket/Brace">{</span>
                    <span class="ActionScriptDefault_Text">dest</span>.<span class="ActionScriptDefault_Text">m</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">r</span><span class="ActionScriptBracket/Brace">][</span><span class="ActionScriptDefault_Text">c</span><span class="ActionScriptBracket/Brace">]</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">source</span>.<span class="ActionScriptDefault_Text">m</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">c</span><span class="ActionScriptBracket/Brace">][</span><span class="ActionScriptDefault_Text">r</span><span class="ActionScriptBracket/Brace">]</span>;
                <span class="ActionScriptBracket/Brace">}</span>
            <span class="ActionScriptBracket/Brace">}</span>
        <span class="ActionScriptBracket/Brace">}</span>

        <span class="ActionScriptASDoc">/**
         * unitを単位行列に初期化する。arMatrixUnitの代替品
         * 
         * @param unit
         */</span>
        <span class="ActionScriptReserved">public</span> <span class="ActionScriptReserved">static</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">matrixUnit</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">unit</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">FLARMat</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">:</span><span class="ActionScriptReserved">void</span> <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">unit</span>.<span class="ActionScriptDefault_Text">row</span> <span class="ActionScriptOperator">!=</span> <span class="ActionScriptDefault_Text">unit</span>.<span class="ActionScriptDefault_Text">clm</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptBracket/Brace">{</span>
                <span class="ActionScriptReserved">throw</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">FLARException</span><span class="ActionScriptBracket/Brace">()</span>;
            <span class="ActionScriptBracket/Brace">}</span>
            <span class="ActionScriptDefault_Text">FLARException</span>.<span class="ActionScriptDefault_Text">trap</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">&quot;未チェックのパス&quot;</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptComment">// For順変更禁止
</span>            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">r</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">int</span>;
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">c</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">int</span>;
            <span class="ActionScriptReserved">for</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">r</span> <span class="ActionScriptOperator">=</span> 0; <span class="ActionScriptDefault_Text">r</span> <span class="ActionScriptOperator">&lt;</span> <span class="ActionScriptDefault_Text">unit</span>.<span class="ActionScriptDefault_Text">getRow</span><span class="ActionScriptBracket/Brace">()</span>; <span class="ActionScriptDefault_Text">r</span><span class="ActionScriptOperator">++</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptBracket/Brace">{</span>
                <span class="ActionScriptReserved">for</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">c</span> <span class="ActionScriptOperator">=</span> 0; <span class="ActionScriptDefault_Text">c</span> <span class="ActionScriptOperator">&lt;</span> <span class="ActionScriptDefault_Text">unit</span>.<span class="ActionScriptDefault_Text">getClm</span><span class="ActionScriptBracket/Brace">()</span>; <span class="ActionScriptDefault_Text">c</span><span class="ActionScriptOperator">++</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptBracket/Brace">{</span>
                    <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">r</span> <span class="ActionScriptOperator">==</span> <span class="ActionScriptDefault_Text">c</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptBracket/Brace">{</span>
                        <span class="ActionScriptDefault_Text">unit</span>.<span class="ActionScriptDefault_Text">m</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">r</span><span class="ActionScriptBracket/Brace">][</span><span class="ActionScriptDefault_Text">c</span><span class="ActionScriptBracket/Brace">]</span> <span class="ActionScriptOperator">=</span> 1.0;
                    <span class="ActionScriptBracket/Brace">}</span> <span class="ActionScriptReserved">else</span> <span class="ActionScriptBracket/Brace">{</span>
                        <span class="ActionScriptDefault_Text">unit</span>.<span class="ActionScriptDefault_Text">m</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">r</span><span class="ActionScriptBracket/Brace">][</span><span class="ActionScriptDefault_Text">c</span><span class="ActionScriptBracket/Brace">]</span> <span class="ActionScriptOperator">=</span> 0.0;
                    <span class="ActionScriptBracket/Brace">}</span>
                <span class="ActionScriptBracket/Brace">}</span>
            <span class="ActionScriptBracket/Brace">}</span>
        <span class="ActionScriptBracket/Brace">}</span>

        <span class="ActionScriptASDoc">/**
         * sourceの内容を自身に複製する。 Optimized 2008.04.19
         * 
         * @param i_source
         * @return
         */</span>
        <span class="ActionScriptReserved">public</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">matrixDup</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">i_source</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">FLARMat</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">:</span><span class="ActionScriptReserved">void</span> <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptComment">// 自身の配列サイズを相手のそれより大きいことを保障する。
</span>            <span class="ActionScriptReserved">this</span>.<span class="ActionScriptDefault_Text">realloc</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">i_source</span>.<span class="ActionScriptDefault_Text">row</span>, <span class="ActionScriptDefault_Text">i_source</span>.<span class="ActionScriptDefault_Text">clm</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptComment">// 内容を転写
</span>            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">r</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">int</span>;
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">c</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">int</span>;
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">src_m</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">Array</span>;
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">dest_m</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">Array</span>;
            <span class="ActionScriptDefault_Text">src_m</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">i_source</span>.<span class="ActionScriptDefault_Text">m</span>;
            <span class="ActionScriptDefault_Text">dest_m</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">this</span>.<span class="ActionScriptDefault_Text">m</span>;
            <span class="ActionScriptComment">// コピーはFor順を変えてもOK
</span>            <span class="ActionScriptReserved">for</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">r</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">this</span>.<span class="ActionScriptDefault_Text">row</span> <span class="ActionScriptOperator">-</span> 1; <span class="ActionScriptDefault_Text">r</span> <span class="ActionScriptOperator">&gt;=</span> 0; <span class="ActionScriptDefault_Text">r</span><span class="ActionScriptOperator">--</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptBracket/Brace">{</span>
                <span class="ActionScriptReserved">for</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">c</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">this</span>.<span class="ActionScriptDefault_Text">clm</span> <span class="ActionScriptOperator">-</span> 1; <span class="ActionScriptDefault_Text">c</span> <span class="ActionScriptOperator">&gt;=</span> 0; <span class="ActionScriptDefault_Text">c</span><span class="ActionScriptOperator">--</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptBracket/Brace">{</span>
                    <span class="ActionScriptDefault_Text">dest_m</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">r</span><span class="ActionScriptBracket/Brace">][</span><span class="ActionScriptDefault_Text">c</span><span class="ActionScriptBracket/Brace">]</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">src_m</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">r</span><span class="ActionScriptBracket/Brace">][</span><span class="ActionScriptDefault_Text">c</span><span class="ActionScriptBracket/Brace">]</span>;
                <span class="ActionScriptBracket/Brace">}</span>
            <span class="ActionScriptBracket/Brace">}</span>
        <span class="ActionScriptBracket/Brace">}</span>

        <span class="ActionScriptReserved">public</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">matrixAllocDup</span><span class="ActionScriptBracket/Brace">()</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">FLARMat</span> <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">result</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">FLARMat</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">FLARMat</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptReserved">this</span>.<span class="ActionScriptDefault_Text">row</span>, <span class="ActionScriptReserved">this</span>.<span class="ActionScriptDefault_Text">clm</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptComment">// コピー
</span>            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">r</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">int</span>;
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">c</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">int</span>;
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">dest_m</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">Array</span>;
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">src_m</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">Array</span>;
            <span class="ActionScriptDefault_Text">dest_m</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">result</span>.<span class="ActionScriptDefault_Text">m</span>;
            <span class="ActionScriptDefault_Text">src_m</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">this</span>.<span class="ActionScriptDefault_Text">m</span>;
            <span class="ActionScriptComment">// コピーはFor順を変えてもOK
</span>            <span class="ActionScriptReserved">for</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">r</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">this</span>.<span class="ActionScriptDefault_Text">row</span> <span class="ActionScriptOperator">-</span> 1; <span class="ActionScriptDefault_Text">r</span> <span class="ActionScriptOperator">&gt;=</span> 0; <span class="ActionScriptDefault_Text">r</span><span class="ActionScriptOperator">--</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptBracket/Brace">{</span>
                <span class="ActionScriptReserved">for</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">c</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">this</span>.<span class="ActionScriptDefault_Text">clm</span> <span class="ActionScriptOperator">-</span> 1; <span class="ActionScriptDefault_Text">c</span> <span class="ActionScriptOperator">&gt;=</span> 0; <span class="ActionScriptDefault_Text">c</span><span class="ActionScriptOperator">--</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptBracket/Brace">{</span>
                    <span class="ActionScriptDefault_Text">dest_m</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">r</span><span class="ActionScriptBracket/Brace">][</span><span class="ActionScriptDefault_Text">c</span><span class="ActionScriptBracket/Brace">]</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">src_m</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">r</span><span class="ActionScriptBracket/Brace">][</span><span class="ActionScriptDefault_Text">c</span><span class="ActionScriptBracket/Brace">]</span>;
                <span class="ActionScriptBracket/Brace">}</span>
            <span class="ActionScriptBracket/Brace">}</span>
            <span class="ActionScriptReserved">return</span> <span class="ActionScriptDefault_Text">result</span>;
        <span class="ActionScriptBracket/Brace">}</span>

        <span class="ActionScriptASDoc">/**
         * arMatrixInv関数の代替品です。 destにsourceの逆行列を返します。
         * 
         * @param dest
         * @param source
         * @throws FLARException
         */</span>
        <span class="ActionScriptReserved">public</span> <span class="ActionScriptReserved">static</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">matrixInv</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">dest</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">FLARMat</span>, <span class="ActionScriptDefault_Text">source</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">FLARMat</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">:</span><span class="ActionScriptReserved">void</span> <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptDefault_Text">FLARException</span>.<span class="ActionScriptDefault_Text">trap</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">&quot;未チェックのパス&quot;</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptDefault_Text">dest</span>.<span class="ActionScriptDefault_Text">matrixDup</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">source</span><span class="ActionScriptBracket/Brace">)</span>;

            <span class="ActionScriptDefault_Text">FLARException</span>.<span class="ActionScriptDefault_Text">trap</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">&quot;未チェックのパス&quot;</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptDefault_Text">dest</span>.<span class="ActionScriptDefault_Text">matrixSelfInv</span><span class="ActionScriptBracket/Brace">()</span>;
        <span class="ActionScriptBracket/Brace">}</span>

        <span class="ActionScriptReserved">public</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">matrixAllocInv</span><span class="ActionScriptBracket/Brace">()</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">FLARMat</span> <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptDefault_Text">FLARException</span>.<span class="ActionScriptDefault_Text">trap</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">&quot;未チェックのパス&quot;</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">result</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">FLARMat</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">matrixAllocDup</span><span class="ActionScriptBracket/Brace">()</span>;

            <span class="ActionScriptDefault_Text">FLARException</span>.<span class="ActionScriptDefault_Text">trap</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">&quot;未チェックのパス&quot;</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptDefault_Text">result</span>.<span class="ActionScriptDefault_Text">matrixSelfInv</span><span class="ActionScriptBracket/Brace">()</span>;
            <span class="ActionScriptReserved">return</span> <span class="ActionScriptDefault_Text">result</span>;
        <span class="ActionScriptBracket/Brace">}</span>

        <span class="ActionScriptASDoc">/**
         * dim x dim の単位行列を作る。
         * 
         * @param dim
         * @return
         * @throws FLARException
         */</span>
        <span class="ActionScriptReserved">public</span> <span class="ActionScriptReserved">static</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">matrixAllocUnit</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">dim</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">int</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">FLARMat</span> <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptDefault_Text">FLARException</span>.<span class="ActionScriptDefault_Text">trap</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">&quot;未チェックのパス&quot;</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">result</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">FLARMat</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">FLARMat</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">dim</span>, <span class="ActionScriptDefault_Text">dim</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptDefault_Text">FLARException</span>.<span class="ActionScriptDefault_Text">trap</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">&quot;未チェックのパス&quot;</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptDefault_Text">FLARMat</span>.<span class="ActionScriptDefault_Text">matrixUnit</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">result</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptReserved">return</span> <span class="ActionScriptDefault_Text">result</span>;
        <span class="ActionScriptBracket/Brace">}</span>

        <span class="ActionScriptASDoc">/**
         * arMatrixDispの代替品
         * 
         * @param m
         * @return
         */</span>
        <span class="ActionScriptReserved">public</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">matrixDisp</span><span class="ActionScriptBracket/Brace">()</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">int</span> <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptDefault_Text">FLARException</span>.<span class="ActionScriptDefault_Text">trap</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">&quot;未チェックのパス&quot;</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptComment">//        System.out.println(&quot; === matrix (&quot; + row + &quot;,&quot; + clm + &quot;) ===&quot;);// printf(&quot; ===matrix (%d,%d) ===\n&quot;, m-&gt;row, m-&gt;clm);
</span>            <span class="ActionScriptComment">//        for (var r:int = 0; r &lt; row; r++) {// for(int r = 0; r &lt; m-&gt;row; r++) {
</span>            <span class="ActionScriptComment">//            System.out.print(&quot; |&quot;);// printf(&quot; |&quot;);
</span>            <span class="ActionScriptComment">//            for (var c:int = 0; c &lt; clm; c++) {// for(int c = 0; c &lt; m-&gt;clm; c++) {
</span>            <span class="ActionScriptComment">//                System.out.print(&quot; &quot; + m[r][c]);// printf(&quot; %10g&quot;, ARELEM0(m, r, c));
</span>            <span class="ActionScriptComment">//            }
</span>            <span class="ActionScriptComment">//            System.out.println(&quot; |&quot;);// printf(&quot; |\n&quot;);
</span>            <span class="ActionScriptComment">//        }
</span>            <span class="ActionScriptComment">//        System.out.println(&quot; ======================&quot;);// printf(&quot; ======================\n&quot;);
</span>            <span class="ActionScriptReserved">return</span> 0;
        <span class="ActionScriptBracket/Brace">}</span>

        <span class="ActionScriptReserved">private</span> <span class="ActionScriptReserved">static</span> <span class="ActionScriptReserved">const</span> <span class="ActionScriptDefault_Text">PCA_EPS</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">Number</span> <span class="ActionScriptOperator">=</span> 1<span class="ActionScriptDefault_Text">e</span><span class="ActionScriptOperator">-</span>6; 
        <span class="ActionScriptComment">// #define EPS 1e-6
</span>
        <span class="ActionScriptReserved">private</span> <span class="ActionScriptReserved">static</span> <span class="ActionScriptReserved">const</span> <span class="ActionScriptDefault_Text">PCA_MAX_ITER</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">int</span> <span class="ActionScriptOperator">=</span> 100; 
        <span class="ActionScriptComment">// #define MAX_ITER 100
</span>
        <span class="ActionScriptReserved">private</span> <span class="ActionScriptReserved">static</span> <span class="ActionScriptReserved">const</span> <span class="ActionScriptDefault_Text">PCA_VZERO</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">Number</span> <span class="ActionScriptOperator">=</span> 1<span class="ActionScriptDefault_Text">e</span><span class="ActionScriptOperator">-</span>16; 
        
        <span class="ActionScriptComment">// #define VZERO 1e-16
</span>
        <span class="ActionScriptASDoc">/**
         * static int EX( ARMat *input, ARVec *mean )の代替関数 Optimize:STEP:[144-&gt;110]
         * 
         * @param input
         * @param mean
         * @return
         * @throws FLARException
         */</span>
        <span class="ActionScriptReserved">private</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">PCA_EX</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">mean</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">FLARVec</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">:</span><span class="ActionScriptReserved">void</span> <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">lrow</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">int</span>;
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">lclm</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">int</span>;
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">i</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">int</span>;
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">i2</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">int</span>;
            <span class="ActionScriptDefault_Text">lrow</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">this</span>.<span class="ActionScriptDefault_Text">row</span>;
            <span class="ActionScriptDefault_Text">lclm</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">this</span>.<span class="ActionScriptDefault_Text">clm</span>;
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">lm</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">Array</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">this</span>.<span class="ActionScriptDefault_Text">m</span>;

            <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">lrow</span> <span class="ActionScriptOperator">&lt;=</span> 0 <span class="ActionScriptOperator">||</span> <span class="ActionScriptDefault_Text">lclm</span> <span class="ActionScriptOperator">&lt;=</span> 0<span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptBracket/Brace">{</span>
                <span class="ActionScriptReserved">throw</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">FLARException</span><span class="ActionScriptBracket/Brace">()</span>;
            <span class="ActionScriptBracket/Brace">}</span>
            <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">mean</span>.<span class="ActionScriptDefault_Text">getClm</span><span class="ActionScriptBracket/Brace">()</span> <span class="ActionScriptOperator">!=</span> <span class="ActionScriptDefault_Text">lclm</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptBracket/Brace">{</span>
                <span class="ActionScriptReserved">throw</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">FLARException</span><span class="ActionScriptBracket/Brace">()</span>;
            <span class="ActionScriptBracket/Brace">}</span>
            <span class="ActionScriptComment">// double[] mean_array=mean.getArray();
</span>            <span class="ActionScriptComment">// mean.zeroClear();
</span>            <span class="ActionScriptReserved">const</span> <span class="ActionScriptDefault_Text">mean_array</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">Array</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">mean</span>.<span class="ActionScriptDefault_Text">getArray</span><span class="ActionScriptBracket/Brace">()</span>;
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">w</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">Number</span>;
            <span class="ActionScriptComment">// For順変更禁止
</span>            <span class="ActionScriptReserved">for</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">i2</span> <span class="ActionScriptOperator">=</span> 0; <span class="ActionScriptDefault_Text">i2</span> <span class="ActionScriptOperator">&lt;</span> <span class="ActionScriptDefault_Text">lclm</span>; <span class="ActionScriptDefault_Text">i2</span><span class="ActionScriptOperator">++</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptBracket/Brace">{</span>
                <span class="ActionScriptDefault_Text">w</span> <span class="ActionScriptOperator">=</span> 0.0;
                <span class="ActionScriptReserved">for</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">i</span> <span class="ActionScriptOperator">=</span> 0; <span class="ActionScriptDefault_Text">i</span> <span class="ActionScriptOperator">&lt;</span> <span class="ActionScriptDefault_Text">lrow</span>; <span class="ActionScriptDefault_Text">i</span><span class="ActionScriptOperator">++</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptBracket/Brace">{</span>
                    <span class="ActionScriptComment">// *(v++) += *(m++);
</span>                    <span class="ActionScriptDefault_Text">w</span> <span class="ActionScriptOperator">+=</span> <span class="ActionScriptDefault_Text">lm</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">i</span><span class="ActionScriptBracket/Brace">][</span><span class="ActionScriptDefault_Text">i2</span><span class="ActionScriptBracket/Brace">]</span>;
                <span class="ActionScriptBracket/Brace">}</span>
                <span class="ActionScriptDefault_Text">mean_array</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">i2</span><span class="ActionScriptBracket/Brace">]</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">w</span> <span class="ActionScriptOperator">/</span> <span class="ActionScriptDefault_Text">lrow</span>;<span class="ActionScriptComment">// mean-&gt;v[i] /= row;
</span>            <span class="ActionScriptBracket/Brace">}</span>
        <span class="ActionScriptBracket/Brace">}</span>

        <span class="ActionScriptASDoc">/**
         * static int CENTER( ARMat *inout, ARVec *mean )の代替関数
         * 
         * @param inout
         * @param mean
         * @return
         */</span>
        <span class="ActionScriptReserved">private</span> <span class="ActionScriptReserved">static</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">PCA_CENTER</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">inout</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">FLARMat</span>, <span class="ActionScriptDefault_Text">mean</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">FLARVec</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">:</span><span class="ActionScriptReserved">void</span> <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">v</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">Array</span>;
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">row</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">int</span>;
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">clm</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">int</span>;

            <span class="ActionScriptDefault_Text">row</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">inout</span>.<span class="ActionScriptDefault_Text">getRow</span><span class="ActionScriptBracket/Brace">()</span>;
            <span class="ActionScriptDefault_Text">clm</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">inout</span>.<span class="ActionScriptDefault_Text">getClm</span><span class="ActionScriptBracket/Brace">()</span>;
            <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">mean</span>.<span class="ActionScriptDefault_Text">getClm</span><span class="ActionScriptBracket/Brace">()</span> <span class="ActionScriptOperator">!=</span> <span class="ActionScriptDefault_Text">clm</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptBracket/Brace">{</span>
                <span class="ActionScriptReserved">throw</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">FLARException</span><span class="ActionScriptBracket/Brace">()</span>;
            <span class="ActionScriptBracket/Brace">}</span>
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">im</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">Array</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">inout</span>.<span class="ActionScriptDefault_Text">m</span>;
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">im_i</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">Array</span>;
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">w0</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">Number</span>;
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">w1</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">Number</span>;
            <span class="ActionScriptDefault_Text">v</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">mean</span>.<span class="ActionScriptDefault_Text">getArray</span><span class="ActionScriptBracket/Brace">()</span>;
            <span class="ActionScriptComment">// 特にパフォーマンスが劣化するclm=1と2ときだけ、別パスで処理します。
</span>            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">i</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">int</span>;
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">j</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">int</span>;
            <span class="ActionScriptReserved">switch</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">clm</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptBracket/Brace">{</span>
                <span class="ActionScriptReserved">case</span> 1<span class="ActionScriptOperator">:</span>
                    <span class="ActionScriptDefault_Text">w0</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">v</span><span class="ActionScriptBracket/Brace">[</span>0<span class="ActionScriptBracket/Brace">]</span>;
                    <span class="ActionScriptReserved">for</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">i</span> <span class="ActionScriptOperator">=</span> 0;<span class="ActionScriptDefault_Text">i</span> <span class="ActionScriptOperator">&lt;</span> <span class="ActionScriptDefault_Text">row</span>; <span class="ActionScriptDefault_Text">i</span><span class="ActionScriptOperator">++</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptBracket/Brace">{</span>
                        <span class="ActionScriptDefault_Text">im</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">i</span><span class="ActionScriptBracket/Brace">][</span>0<span class="ActionScriptBracket/Brace">]</span> <span class="ActionScriptOperator">-=</span> <span class="ActionScriptDefault_Text">w0</span>;
                    <span class="ActionScriptBracket/Brace">}</span>
                    <span class="ActionScriptReserved">break</span>;
                <span class="ActionScriptReserved">case</span> 2<span class="ActionScriptOperator">:</span>
                    <span class="ActionScriptDefault_Text">w0</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">v</span><span class="ActionScriptBracket/Brace">[</span>0<span class="ActionScriptBracket/Brace">]</span>;
                    <span class="ActionScriptDefault_Text">w1</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">v</span><span class="ActionScriptBracket/Brace">[</span>1<span class="ActionScriptBracket/Brace">]</span>;
                    <span class="ActionScriptReserved">for</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">i</span> <span class="ActionScriptOperator">=</span> 0;<span class="ActionScriptDefault_Text">i</span> <span class="ActionScriptOperator">&lt;</span> <span class="ActionScriptDefault_Text">row</span>; <span class="ActionScriptDefault_Text">i</span><span class="ActionScriptOperator">++</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptBracket/Brace">{</span>
                        <span class="ActionScriptDefault_Text">im_i</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">im</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">i</span><span class="ActionScriptBracket/Brace">]</span>;
                        <span class="ActionScriptDefault_Text">im_i</span><span class="ActionScriptBracket/Brace">[</span>0<span class="ActionScriptBracket/Brace">]</span> <span class="ActionScriptOperator">-=</span> <span class="ActionScriptDefault_Text">w0</span>;
                        <span class="ActionScriptDefault_Text">im_i</span><span class="ActionScriptBracket/Brace">[</span>1<span class="ActionScriptBracket/Brace">]</span> <span class="ActionScriptOperator">-=</span> <span class="ActionScriptDefault_Text">w1</span>;
                    <span class="ActionScriptBracket/Brace">}</span>
                    <span class="ActionScriptReserved">break</span>;
                <span class="ActionScriptReserved">default</span><span class="ActionScriptOperator">:</span>
                    <span class="ActionScriptReserved">for</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">i</span> <span class="ActionScriptOperator">=</span> 0;<span class="ActionScriptDefault_Text">i</span> <span class="ActionScriptOperator">&lt;</span> <span class="ActionScriptDefault_Text">row</span>; <span class="ActionScriptDefault_Text">i</span><span class="ActionScriptOperator">++</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptBracket/Brace">{</span>
                        <span class="ActionScriptDefault_Text">im_i</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">im</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">i</span><span class="ActionScriptBracket/Brace">]</span>;
                        <span class="ActionScriptReserved">for</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">j</span> <span class="ActionScriptOperator">=</span> 0;<span class="ActionScriptDefault_Text">j</span> <span class="ActionScriptOperator">&lt;</span> <span class="ActionScriptDefault_Text">clm</span>; <span class="ActionScriptDefault_Text">j</span><span class="ActionScriptOperator">++</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptBracket/Brace">{</span>
                            <span class="ActionScriptComment">// *(m++) -= *(v++);
</span>                            <span class="ActionScriptDefault_Text">im_i</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">j</span><span class="ActionScriptBracket/Brace">]</span> <span class="ActionScriptOperator">-=</span> <span class="ActionScriptDefault_Text">v</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">j</span><span class="ActionScriptBracket/Brace">]</span>;
                        <span class="ActionScriptBracket/Brace">}</span>
                    <span class="ActionScriptBracket/Brace">}</span>
                    <span class="ActionScriptReserved">break</span>;
            <span class="ActionScriptBracket/Brace">}</span>
            <span class="ActionScriptReserved">return</span>;
        <span class="ActionScriptBracket/Brace">}</span>

        <span class="ActionScriptASDoc">/**
         * int x_by_xt( ARMat *input, ARMat *output )の代替関数
         * 
         * @param input
         * @param output
         * @throws FLARException
         */</span>
        <span class="ActionScriptReserved">private</span> <span class="ActionScriptReserved">static</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">PCA_x_by_xt</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">input</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">FLARMat</span>, <span class="ActionScriptDefault_Text">output</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">FLARMat</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">:</span><span class="ActionScriptReserved">void</span> <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptDefault_Text">FLARException</span>.<span class="ActionScriptDefault_Text">trap</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">&quot;動作未チェック/配列化未チェック&quot;</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">row</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">int</span>;
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">clm</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">int</span>;
            <span class="ActionScriptComment">// double[][] out;
</span>            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">in1</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">Array</span>;
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">in2</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">Array</span>;

            <span class="ActionScriptDefault_Text">FLARException</span>.<span class="ActionScriptDefault_Text">trap</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">&quot;未チェックのパス&quot;</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptDefault_Text">row</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">input</span>.<span class="ActionScriptDefault_Text">row</span>;
            <span class="ActionScriptDefault_Text">clm</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">input</span>.<span class="ActionScriptDefault_Text">clm</span>;
            <span class="ActionScriptDefault_Text">FLARException</span>.<span class="ActionScriptDefault_Text">trap</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">&quot;未チェックのパス&quot;</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">output</span>.<span class="ActionScriptDefault_Text">row</span> <span class="ActionScriptOperator">!=</span> <span class="ActionScriptDefault_Text">row</span> <span class="ActionScriptOperator">||</span> <span class="ActionScriptDefault_Text">output</span>.<span class="ActionScriptDefault_Text">clm</span> <span class="ActionScriptOperator">!=</span> <span class="ActionScriptDefault_Text">row</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptBracket/Brace">{</span>
                <span class="ActionScriptReserved">throw</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">FLARException</span><span class="ActionScriptBracket/Brace">()</span>;
            <span class="ActionScriptBracket/Brace">}</span>

            <span class="ActionScriptComment">// out = output.getArray();
</span>            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">i</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">int</span>;
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">j</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">int</span>;
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">k</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">int</span>;
            <span class="ActionScriptReserved">for</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">i</span> <span class="ActionScriptOperator">=</span> 0; <span class="ActionScriptDefault_Text">i</span> <span class="ActionScriptOperator">&lt;</span> <span class="ActionScriptDefault_Text">row</span>; <span class="ActionScriptDefault_Text">i</span><span class="ActionScriptOperator">++</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptBracket/Brace">{</span>
                <span class="ActionScriptReserved">for</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">j</span> <span class="ActionScriptOperator">=</span> 0; <span class="ActionScriptDefault_Text">j</span> <span class="ActionScriptOperator">&lt;</span> <span class="ActionScriptDefault_Text">row</span>; <span class="ActionScriptDefault_Text">j</span><span class="ActionScriptOperator">++</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptBracket/Brace">{</span>
                    <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">j</span> <span class="ActionScriptOperator">&lt;</span> <span class="ActionScriptDefault_Text">i</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptBracket/Brace">{</span>
                        <span class="ActionScriptDefault_Text">FLARException</span>.<span class="ActionScriptDefault_Text">trap</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">&quot;未チェックのパス&quot;</span><span class="ActionScriptBracket/Brace">)</span>;
                        <span class="ActionScriptDefault_Text">output</span>.<span class="ActionScriptDefault_Text">m</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">i</span><span class="ActionScriptBracket/Brace">][</span><span class="ActionScriptDefault_Text">j</span><span class="ActionScriptBracket/Brace">]</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">output</span>.<span class="ActionScriptDefault_Text">m</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">j</span><span class="ActionScriptBracket/Brace">][</span><span class="ActionScriptDefault_Text">i</span><span class="ActionScriptBracket/Brace">]</span>;<span class="ActionScriptComment">// *out =
</span>                                                    <span class="ActionScriptComment">// output-&gt;m[j*row+i];
</span>                    <span class="ActionScriptBracket/Brace">}</span> <span class="ActionScriptReserved">else</span> <span class="ActionScriptBracket/Brace">{</span>
                        <span class="ActionScriptDefault_Text">FLARException</span>.<span class="ActionScriptDefault_Text">trap</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">&quot;未チェックのパス&quot;</span><span class="ActionScriptBracket/Brace">)</span>;
                        <span class="ActionScriptDefault_Text">in1</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">input</span>.<span class="ActionScriptDefault_Text">m</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">i</span><span class="ActionScriptBracket/Brace">]</span>;
                        <span class="ActionScriptComment">// input.getRowArray(i);//in1 = &amp;(input-&gt;m[clm*i]);
</span>                        <span class="ActionScriptDefault_Text">in2</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">input</span>.<span class="ActionScriptDefault_Text">m</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">j</span><span class="ActionScriptBracket/Brace">]</span>;
                        <span class="ActionScriptComment">// input.getRowArray(j);//in2 = &amp;(input-&gt;m[clm*j]);
</span>                        <span class="ActionScriptDefault_Text">output</span>.<span class="ActionScriptDefault_Text">m</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">i</span><span class="ActionScriptBracket/Brace">][</span><span class="ActionScriptDefault_Text">j</span><span class="ActionScriptBracket/Brace">]</span> <span class="ActionScriptOperator">=</span> 0;
                        <span class="ActionScriptComment">// *out = 0.0;
</span>                        <span class="ActionScriptReserved">for</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">k</span> <span class="ActionScriptOperator">=</span> 0; <span class="ActionScriptDefault_Text">k</span> <span class="ActionScriptOperator">&lt;</span> <span class="ActionScriptDefault_Text">clm</span>; <span class="ActionScriptDefault_Text">k</span><span class="ActionScriptOperator">++</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptBracket/Brace">{</span>
                            <span class="ActionScriptDefault_Text">output</span>.<span class="ActionScriptDefault_Text">m</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">i</span><span class="ActionScriptBracket/Brace">][</span><span class="ActionScriptDefault_Text">j</span><span class="ActionScriptBracket/Brace">]</span> <span class="ActionScriptOperator">+=</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">in1</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">k</span><span class="ActionScriptBracket/Brace">]</span> <span class="ActionScriptOperator">*</span> <span class="ActionScriptDefault_Text">in2</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">k</span><span class="ActionScriptBracket/Brace">])</span>;<span class="ActionScriptComment">// *out += *(in1++)
</span>                                                            <span class="ActionScriptComment">// * *(in2++);
</span>                        <span class="ActionScriptBracket/Brace">}</span>
                    <span class="ActionScriptBracket/Brace">}</span>
                <span class="ActionScriptComment">// out.incPtr();
</span>                <span class="ActionScriptBracket/Brace">}</span>
            <span class="ActionScriptBracket/Brace">}</span>
        <span class="ActionScriptBracket/Brace">}</span>

        <span class="ActionScriptASDoc">/**
         * static int xt_by_x( ARMat *input, ARMat *output )の代替関数
         * Optimize:2008.04.19
         * 
         * @param input
         * @param i_output
         * @throws FLARException
         */</span>
        <span class="ActionScriptReserved">private</span> <span class="ActionScriptReserved">static</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">PCA_xt_by_x</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">input</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">FLARMat</span>, <span class="ActionScriptDefault_Text">i_output</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">FLARMat</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">:</span><span class="ActionScriptReserved">void</span> <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">in_</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">Array</span>;
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">row</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">int</span>;
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">clm</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">int</span>;

            <span class="ActionScriptDefault_Text">row</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">input</span>.<span class="ActionScriptDefault_Text">row</span>;
            <span class="ActionScriptDefault_Text">clm</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">input</span>.<span class="ActionScriptDefault_Text">clm</span>;
            <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">i_output</span>.<span class="ActionScriptDefault_Text">row</span> <span class="ActionScriptOperator">!=</span> <span class="ActionScriptDefault_Text">clm</span> <span class="ActionScriptOperator">||</span> <span class="ActionScriptDefault_Text">i_output</span>.<span class="ActionScriptDefault_Text">clm</span> <span class="ActionScriptOperator">!=</span> <span class="ActionScriptDefault_Text">clm</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptBracket/Brace">{</span>
                <span class="ActionScriptReserved">throw</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">FLARException</span><span class="ActionScriptBracket/Brace">()</span>;
            <span class="ActionScriptBracket/Brace">}</span>

            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">i</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">int</span>;
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">k</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">int</span>;
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">j</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">int</span>;
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">out_m</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">Array</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">i_output</span>.<span class="ActionScriptDefault_Text">m</span>;
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">w</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">Number</span>;
            <span class="ActionScriptReserved">for</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">i</span> <span class="ActionScriptOperator">=</span> 0; <span class="ActionScriptDefault_Text">i</span> <span class="ActionScriptOperator">&lt;</span> <span class="ActionScriptDefault_Text">clm</span>; <span class="ActionScriptDefault_Text">i</span><span class="ActionScriptOperator">++</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptBracket/Brace">{</span>
                <span class="ActionScriptReserved">for</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">j</span> <span class="ActionScriptOperator">=</span> 0; <span class="ActionScriptDefault_Text">j</span> <span class="ActionScriptOperator">&lt;</span> <span class="ActionScriptDefault_Text">clm</span>; <span class="ActionScriptDefault_Text">j</span><span class="ActionScriptOperator">++</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptBracket/Brace">{</span>
                    <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">j</span> <span class="ActionScriptOperator">&lt;</span> <span class="ActionScriptDefault_Text">i</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptBracket/Brace">{</span>
                        <span class="ActionScriptDefault_Text">out_m</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">i</span><span class="ActionScriptBracket/Brace">][</span><span class="ActionScriptDefault_Text">j</span><span class="ActionScriptBracket/Brace">]</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">out_m</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">j</span><span class="ActionScriptBracket/Brace">][</span><span class="ActionScriptDefault_Text">i</span><span class="ActionScriptBracket/Brace">]</span>;<span class="ActionScriptComment">// *out = output-&gt;m[j*clm+i];
</span>                    <span class="ActionScriptBracket/Brace">}</span> <span class="ActionScriptReserved">else</span> <span class="ActionScriptBracket/Brace">{</span>
                        <span class="ActionScriptDefault_Text">w</span> <span class="ActionScriptOperator">=</span> 0.0;
                        <span class="ActionScriptComment">// *out = 0.0;
</span>                        <span class="ActionScriptReserved">for</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">k</span> <span class="ActionScriptOperator">=</span> 0; <span class="ActionScriptDefault_Text">k</span> <span class="ActionScriptOperator">&lt;</span> <span class="ActionScriptDefault_Text">row</span>; <span class="ActionScriptDefault_Text">k</span><span class="ActionScriptOperator">++</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptBracket/Brace">{</span>
                            <span class="ActionScriptDefault_Text">in_</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">input</span>.<span class="ActionScriptDefault_Text">m</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">k</span><span class="ActionScriptBracket/Brace">]</span>;
                            <span class="ActionScriptComment">// in=input.getRowArray(k);
</span>                            <span class="ActionScriptDefault_Text">w</span> <span class="ActionScriptOperator">+=</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">in_</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">i</span><span class="ActionScriptBracket/Brace">]</span> <span class="ActionScriptOperator">*</span> <span class="ActionScriptDefault_Text">in_</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">j</span><span class="ActionScriptBracket/Brace">])</span>;<span class="ActionScriptComment">// *out += *in1 * *in2;
</span>                        <span class="ActionScriptBracket/Brace">}</span>
                        <span class="ActionScriptDefault_Text">out_m</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">i</span><span class="ActionScriptBracket/Brace">][</span><span class="ActionScriptDefault_Text">j</span><span class="ActionScriptBracket/Brace">]</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">w</span>;
                    <span class="ActionScriptBracket/Brace">}</span>
                <span class="ActionScriptBracket/Brace">}</span>
            <span class="ActionScriptBracket/Brace">}</span>
        <span class="ActionScriptBracket/Brace">}</span>

        <span class="ActionScriptReserved">private</span> <span class="ActionScriptReserved">const</span> <span class="ActionScriptDefault_Text">wk_PCA_QRM_ev</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">FLARVec</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">FLARVec</span><span class="ActionScriptBracket/Brace">(</span>1<span class="ActionScriptBracket/Brace">)</span>;

        <span class="ActionScriptASDoc">/**
         * static int QRM( ARMat *a, ARVec *dv )の代替関数
         * 
         * @param a
         * @param dv
         * @throws FLARException
         */</span>
        <span class="ActionScriptReserved">private</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">PCA_QRM</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">dv</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">FLARVec</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">:</span><span class="ActionScriptReserved">void</span> <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">w</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">Number</span>;
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">t</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">Number</span>;
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">s</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">Number</span>;
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">x</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">Number</span>;
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">y</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">Number</span>;
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">c</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">Number</span>;
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">dim</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">int</span>;
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">iter</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">int</span>;
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">dv_array</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">Array</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">dv</span>.<span class="ActionScriptDefault_Text">getArray</span><span class="ActionScriptBracket/Brace">()</span>;

            <span class="ActionScriptDefault_Text">dim</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">this</span>.<span class="ActionScriptDefault_Text">row</span>;
            <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">dim</span> <span class="ActionScriptOperator">!=</span> <span class="ActionScriptReserved">this</span>.<span class="ActionScriptDefault_Text">clm</span> <span class="ActionScriptOperator">||</span> <span class="ActionScriptDefault_Text">dim</span> <span class="ActionScriptOperator">&lt;</span> 2<span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptBracket/Brace">{</span>
                <span class="ActionScriptReserved">throw</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">FLARException</span><span class="ActionScriptBracket/Brace">()</span>;
            <span class="ActionScriptBracket/Brace">}</span>
            <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">dv</span>.<span class="ActionScriptDefault_Text">getClm</span><span class="ActionScriptBracket/Brace">()</span> <span class="ActionScriptOperator">!=</span> <span class="ActionScriptDefault_Text">dim</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptBracket/Brace">{</span>
                <span class="ActionScriptReserved">throw</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">FLARException</span><span class="ActionScriptBracket/Brace">()</span>;
            <span class="ActionScriptBracket/Brace">}</span>

            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">ev</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">FLARVec</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">this</span>.<span class="ActionScriptDefault_Text">wk_PCA_QRM_ev</span>;
            <span class="ActionScriptDefault_Text">ev</span>.<span class="ActionScriptDefault_Text">realloc</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">dim</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">ev_array</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">Array</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">ev</span>.<span class="ActionScriptDefault_Text">getArray</span><span class="ActionScriptBracket/Brace">()</span>;
            <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">ev</span> <span class="ActionScriptOperator">==</span> <span class="ActionScriptReserved">null</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptBracket/Brace">{</span>
                <span class="ActionScriptReserved">throw</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">FLARException</span><span class="ActionScriptBracket/Brace">()</span>;
            <span class="ActionScriptBracket/Brace">}</span>
            <span class="ActionScriptReserved">const</span> <span class="ActionScriptDefault_Text">L_m</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">Array</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">this</span>.<span class="ActionScriptDefault_Text">m</span>;
            <span class="ActionScriptReserved">this</span>.<span class="ActionScriptDefault_Text">vecTridiagonalize</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">dv</span>, <span class="ActionScriptDefault_Text">ev</span>, 1<span class="ActionScriptBracket/Brace">)</span>;

            <span class="ActionScriptDefault_Text">ev_array</span><span class="ActionScriptBracket/Brace">[</span>0<span class="ActionScriptBracket/Brace">]</span> <span class="ActionScriptOperator">=</span> 0.0;
            <span class="ActionScriptComment">// ev-&gt;v[0] = 0.0;
</span>            
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">h</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">int</span>;
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">j</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">int</span>;
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">k</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">int</span>;
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">i</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">int</span>;
            <span class="ActionScriptReserved">for</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">h</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">dim</span> <span class="ActionScriptOperator">-</span> 1; <span class="ActionScriptDefault_Text">h</span> <span class="ActionScriptOperator">&gt;</span> 0; <span class="ActionScriptDefault_Text">h</span><span class="ActionScriptOperator">--</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptBracket/Brace">{</span>
                <span class="ActionScriptDefault_Text">j</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">h</span>;
                <span class="ActionScriptReserved">while</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">j</span> <span class="ActionScriptOperator">&gt;</span> 0 <span class="ActionScriptOperator">&amp;&amp;</span> <span class="ActionScriptDefault_Text">Math</span>.<span class="ActionScriptDefault_Text">abs</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">ev_array</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">j</span><span class="ActionScriptBracket/Brace">])</span> <span class="ActionScriptOperator">&gt;</span> <span class="ActionScriptDefault_Text">PCA_EPS</span> <span class="ActionScriptOperator">*</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">Math</span>.<span class="ActionScriptDefault_Text">abs</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">dv_array</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">j</span> <span class="ActionScriptOperator">-</span> 1<span class="ActionScriptBracket/Brace">])</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptDefault_Text">Math</span>.<span class="ActionScriptDefault_Text">abs</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">dv_array</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">j</span><span class="ActionScriptBracket/Brace">])))</span> <span class="ActionScriptBracket/Brace">{</span>
                    <span class="ActionScriptComment">// while(j&gt;0 &amp;&amp; fabs(ev-&gt;v[j]) &gt;EPS*(fabs(dv-&gt;v[j-1])+fabs(dv-&gt;v[j])))
</span>                    <span class="ActionScriptComment">// j--;
</span>                    <span class="ActionScriptDefault_Text">j</span><span class="ActionScriptOperator">--</span>;
                <span class="ActionScriptBracket/Brace">}</span>
                <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">j</span> <span class="ActionScriptOperator">==</span> <span class="ActionScriptDefault_Text">h</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptBracket/Brace">{</span>
                    <span class="ActionScriptReserved">continue</span>;
                <span class="ActionScriptBracket/Brace">}</span>
                <span class="ActionScriptDefault_Text">iter</span> <span class="ActionScriptOperator">=</span> 0;
                <span class="ActionScriptReserved">do</span> <span class="ActionScriptBracket/Brace">{</span>
                    <span class="ActionScriptDefault_Text">iter</span><span class="ActionScriptOperator">++</span>;
                    <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">iter</span> <span class="ActionScriptOperator">&gt;</span> <span class="ActionScriptDefault_Text">PCA_MAX_ITER</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptBracket/Brace">{</span>
                        <span class="ActionScriptReserved">break</span>;
                    <span class="ActionScriptBracket/Brace">}</span>
                    <span class="ActionScriptDefault_Text">w</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">dv_array</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">h</span> <span class="ActionScriptOperator">-</span> 1<span class="ActionScriptBracket/Brace">]</span> <span class="ActionScriptOperator">-</span> <span class="ActionScriptDefault_Text">dv_array</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">h</span><span class="ActionScriptBracket/Brace">])</span> <span class="ActionScriptOperator">/</span> 2;
                    <span class="ActionScriptComment">// w = (dv-&gt;v[h-1] -dv-&gt;v[h]) / 2;//ここ？
</span>                    <span class="ActionScriptDefault_Text">t</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">ev_array</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">h</span><span class="ActionScriptBracket/Brace">]</span> <span class="ActionScriptOperator">*</span> <span class="ActionScriptDefault_Text">ev_array</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">h</span><span class="ActionScriptBracket/Brace">]</span>;
                    <span class="ActionScriptComment">// t = ev-&gt;v[h] * ev-&gt;v[h];
</span>                    <span class="ActionScriptDefault_Text">s</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">Math</span>.<span class="ActionScriptDefault_Text">sqrt</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">w</span> <span class="ActionScriptOperator">*</span> <span class="ActionScriptDefault_Text">w</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptDefault_Text">t</span><span class="ActionScriptBracket/Brace">)</span>;
                    <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">w</span> <span class="ActionScriptOperator">&lt;</span> 0<span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptBracket/Brace">{</span>
                        <span class="ActionScriptDefault_Text">s</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptOperator">-</span><span class="ActionScriptDefault_Text">s</span>;
                    <span class="ActionScriptBracket/Brace">}</span>
                    <span class="ActionScriptDefault_Text">x</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">dv_array</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">j</span><span class="ActionScriptBracket/Brace">]</span> <span class="ActionScriptOperator">-</span> <span class="ActionScriptDefault_Text">dv_array</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">h</span><span class="ActionScriptBracket/Brace">]</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptDefault_Text">t</span> <span class="ActionScriptOperator">/</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">w</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptDefault_Text">s</span><span class="ActionScriptBracket/Brace">)</span>;
                    <span class="ActionScriptComment">// x = dv-&gt;v[j] -dv-&gt;v[h] +t/(w+s);
</span>                    <span class="ActionScriptDefault_Text">y</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">ev_array</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">j</span> <span class="ActionScriptOperator">+</span> 1<span class="ActionScriptBracket/Brace">]</span>;
                    <span class="ActionScriptComment">// y = ev-&gt;v[j+1];
</span>                    <span class="ActionScriptReserved">for</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">k</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">j</span>; <span class="ActionScriptDefault_Text">k</span> <span class="ActionScriptOperator">&lt;</span> <span class="ActionScriptDefault_Text">h</span>; <span class="ActionScriptDefault_Text">k</span><span class="ActionScriptOperator">++</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptBracket/Brace">{</span>
                        <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">Math</span>.<span class="ActionScriptDefault_Text">abs</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">x</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptOperator">&gt;=</span> <span class="ActionScriptDefault_Text">Math</span>.<span class="ActionScriptDefault_Text">abs</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">y</span><span class="ActionScriptBracket/Brace">))</span> <span class="ActionScriptBracket/Brace">{</span>
                            <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">Math</span>.<span class="ActionScriptDefault_Text">abs</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">x</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptOperator">&gt;</span> <span class="ActionScriptDefault_Text">PCA_VZERO</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptBracket/Brace">{</span>
                                <span class="ActionScriptDefault_Text">t</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptOperator">-</span><span class="ActionScriptDefault_Text">y</span> <span class="ActionScriptOperator">/</span> <span class="ActionScriptDefault_Text">x</span>;
                                <span class="ActionScriptDefault_Text">c</span> <span class="ActionScriptOperator">=</span> 1 <span class="ActionScriptOperator">/</span> <span class="ActionScriptDefault_Text">Math</span>.<span class="ActionScriptDefault_Text">sqrt</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">t</span> <span class="ActionScriptOperator">*</span> <span class="ActionScriptDefault_Text">t</span> <span class="ActionScriptOperator">+</span> 1<span class="ActionScriptBracket/Brace">)</span>;
                                <span class="ActionScriptDefault_Text">s</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">t</span> <span class="ActionScriptOperator">*</span> <span class="ActionScriptDefault_Text">c</span>;
                            <span class="ActionScriptBracket/Brace">}</span> <span class="ActionScriptReserved">else</span> <span class="ActionScriptBracket/Brace">{</span>
                                <span class="ActionScriptDefault_Text">c</span> <span class="ActionScriptOperator">=</span> 1.0;
                                <span class="ActionScriptDefault_Text">s</span> <span class="ActionScriptOperator">=</span> 0.0;
                            <span class="ActionScriptBracket/Brace">}</span>
                        <span class="ActionScriptBracket/Brace">}</span> <span class="ActionScriptReserved">else</span> <span class="ActionScriptBracket/Brace">{</span>
                            <span class="ActionScriptDefault_Text">t</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptOperator">-</span><span class="ActionScriptDefault_Text">x</span> <span class="ActionScriptOperator">/</span> <span class="ActionScriptDefault_Text">y</span>;
                            <span class="ActionScriptDefault_Text">s</span> <span class="ActionScriptOperator">=</span> 1.0 <span class="ActionScriptOperator">/</span> <span class="ActionScriptDefault_Text">Math</span>.<span class="ActionScriptDefault_Text">sqrt</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">t</span> <span class="ActionScriptOperator">*</span> <span class="ActionScriptDefault_Text">t</span> <span class="ActionScriptOperator">+</span> 1<span class="ActionScriptBracket/Brace">)</span>;
                            <span class="ActionScriptDefault_Text">c</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">t</span> <span class="ActionScriptOperator">*</span> <span class="ActionScriptDefault_Text">s</span>;
                        <span class="ActionScriptBracket/Brace">}</span>
                        <span class="ActionScriptDefault_Text">w</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">dv_array</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">k</span><span class="ActionScriptBracket/Brace">]</span> <span class="ActionScriptOperator">-</span> <span class="ActionScriptDefault_Text">dv_array</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">k</span> <span class="ActionScriptOperator">+</span> 1<span class="ActionScriptBracket/Brace">]</span>;
                        <span class="ActionScriptComment">// w = dv-&gt;v[k] -dv-&gt;v[k+1];
</span>                        <span class="ActionScriptDefault_Text">t</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">w</span> <span class="ActionScriptOperator">*</span> <span class="ActionScriptDefault_Text">s</span> <span class="ActionScriptOperator">+</span> 2 <span class="ActionScriptOperator">*</span> <span class="ActionScriptDefault_Text">c</span> <span class="ActionScriptOperator">*</span> <span class="ActionScriptDefault_Text">ev_array</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">k</span> <span class="ActionScriptOperator">+</span> 1<span class="ActionScriptBracket/Brace">])</span> <span class="ActionScriptOperator">*</span> <span class="ActionScriptDefault_Text">s</span>;
                        <span class="ActionScriptComment">// t = (w * s +2 * c *ev-&gt;v[k+1]) *s;
</span>                        <span class="ActionScriptDefault_Text">dv_array</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">k</span><span class="ActionScriptBracket/Brace">]</span> <span class="ActionScriptOperator">-=</span> <span class="ActionScriptDefault_Text">t</span>;
                        <span class="ActionScriptComment">// dv-&gt;v[k] -= t;
</span>                        <span class="ActionScriptDefault_Text">dv_array</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">k</span> <span class="ActionScriptOperator">+</span> 1<span class="ActionScriptBracket/Brace">]</span> <span class="ActionScriptOperator">+=</span> <span class="ActionScriptDefault_Text">t</span>;
                        <span class="ActionScriptComment">// dv-&gt;v[k+1] += t;
</span>                        <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">k</span> <span class="ActionScriptOperator">&gt;</span> <span class="ActionScriptDefault_Text">j</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptBracket/Brace">{</span>
                            <span class="ActionScriptDefault_Text">FLARException</span>.<span class="ActionScriptDefault_Text">trap</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">&quot;未チェックパス&quot;</span><span class="ActionScriptBracket/Brace">)</span>;
                            <span class="ActionScriptDefault_Text">ev_array</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">k</span><span class="ActionScriptBracket/Brace">]</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">c</span> <span class="ActionScriptOperator">*</span> <span class="ActionScriptDefault_Text">ev_array</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">k</span><span class="ActionScriptBracket/Brace">]</span> <span class="ActionScriptOperator">-</span> <span class="ActionScriptDefault_Text">s</span> <span class="ActionScriptOperator">*</span> <span class="ActionScriptDefault_Text">y</span>;<span class="ActionScriptComment">// ev-&gt;v[k]= c *ev-&gt;v[k]- s * y;
</span>                        <span class="ActionScriptBracket/Brace">}</span>
                        <span class="ActionScriptDefault_Text">ev_array</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">k</span> <span class="ActionScriptOperator">+</span> 1<span class="ActionScriptBracket/Brace">]</span> <span class="ActionScriptOperator">+=</span> <span class="ActionScriptDefault_Text">s</span> <span class="ActionScriptOperator">*</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">c</span> <span class="ActionScriptOperator">*</span> <span class="ActionScriptDefault_Text">w</span> <span class="ActionScriptOperator">-</span> 2 <span class="ActionScriptOperator">*</span> <span class="ActionScriptDefault_Text">s</span> <span class="ActionScriptOperator">*</span> <span class="ActionScriptDefault_Text">ev_array</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">k</span> <span class="ActionScriptOperator">+</span> 1<span class="ActionScriptBracket/Brace">])</span>;
                        <span class="ActionScriptComment">// ev-&gt;v[k+1]+= s * (c* w- 2* s *ev-&gt;v[k+1]);
</span>
                        <span class="ActionScriptReserved">for</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">i</span> <span class="ActionScriptOperator">=</span> 0; <span class="ActionScriptDefault_Text">i</span> <span class="ActionScriptOperator">&lt;</span> <span class="ActionScriptDefault_Text">dim</span>; <span class="ActionScriptDefault_Text">i</span><span class="ActionScriptOperator">++</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptBracket/Brace">{</span>
                            <span class="ActionScriptDefault_Text">x</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">L_m</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">k</span><span class="ActionScriptBracket/Brace">][</span><span class="ActionScriptDefault_Text">i</span><span class="ActionScriptBracket/Brace">]</span>;
                            <span class="ActionScriptComment">// x = a-&gt;m[k*dim+i];
</span>                            <span class="ActionScriptDefault_Text">y</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">L_m</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">k</span> <span class="ActionScriptOperator">+</span> 1<span class="ActionScriptBracket/Brace">][</span><span class="ActionScriptDefault_Text">i</span><span class="ActionScriptBracket/Brace">]</span>;
                            <span class="ActionScriptComment">// y = a-&gt;m[(k+1)*dim+i];
</span>                            <span class="ActionScriptDefault_Text">L_m</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">k</span><span class="ActionScriptBracket/Brace">][</span><span class="ActionScriptDefault_Text">i</span><span class="ActionScriptBracket/Brace">]</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">c</span> <span class="ActionScriptOperator">*</span> <span class="ActionScriptDefault_Text">x</span> <span class="ActionScriptOperator">-</span> <span class="ActionScriptDefault_Text">s</span> <span class="ActionScriptOperator">*</span> <span class="ActionScriptDefault_Text">y</span>;
                            <span class="ActionScriptComment">// a-&gt;m[k*dim+i] = c * x - s* y;
</span>                            <span class="ActionScriptDefault_Text">L_m</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">k</span> <span class="ActionScriptOperator">+</span> 1<span class="ActionScriptBracket/Brace">][</span><span class="ActionScriptDefault_Text">i</span><span class="ActionScriptBracket/Brace">]</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">s</span> <span class="ActionScriptOperator">*</span> <span class="ActionScriptDefault_Text">x</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptDefault_Text">c</span> <span class="ActionScriptOperator">*</span> <span class="ActionScriptDefault_Text">y</span>;<span class="ActionScriptComment">// a-&gt;m[(k+1)*dim+i] = s* x + c * y;
</span>                        <span class="ActionScriptBracket/Brace">}</span>
                        <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">k</span> <span class="ActionScriptOperator">&lt;</span> <span class="ActionScriptDefault_Text">h</span> <span class="ActionScriptOperator">-</span> 1<span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptBracket/Brace">{</span>
                            <span class="ActionScriptDefault_Text">FLARException</span>.<span class="ActionScriptDefault_Text">trap</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">&quot;未チェックパス&quot;</span><span class="ActionScriptBracket/Brace">)</span>;
                            <span class="ActionScriptComment">// {
</span>                            <span class="ActionScriptDefault_Text">x</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">ev_array</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">k</span> <span class="ActionScriptOperator">+</span> 1<span class="ActionScriptBracket/Brace">]</span>;
                            <span class="ActionScriptComment">// x = ev-&gt;v[k+1];
</span>                            <span class="ActionScriptDefault_Text">y</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptOperator">-</span><span class="ActionScriptDefault_Text">s</span> <span class="ActionScriptOperator">*</span> <span class="ActionScriptDefault_Text">ev_array</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">k</span> <span class="ActionScriptOperator">+</span> 2<span class="ActionScriptBracket/Brace">]</span>;
                            <span class="ActionScriptComment">// y = -s * ev-&gt;v[k+2];
</span>                            <span class="ActionScriptDefault_Text">ev_array</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">k</span> <span class="ActionScriptOperator">+</span> 2<span class="ActionScriptBracket/Brace">]</span> <span class="ActionScriptOperator">*=</span> <span class="ActionScriptDefault_Text">c</span>;<span class="ActionScriptComment">// ev-&gt;v[k+2] *= c;
</span>                            <span class="ActionScriptComment">// }
</span>                        <span class="ActionScriptBracket/Brace">}</span>
                    <span class="ActionScriptBracket/Brace">}</span>
                <span class="ActionScriptBracket/Brace">}</span> <span class="ActionScriptReserved">while</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">Math</span>.<span class="ActionScriptDefault_Text">abs</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">ev_array</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">h</span><span class="ActionScriptBracket/Brace">])</span> <span class="ActionScriptOperator">&gt;</span> <span class="ActionScriptDefault_Text">PCA_EPS</span> <span class="ActionScriptOperator">*</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">Math</span>.<span class="ActionScriptDefault_Text">abs</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">dv_array</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">h</span> <span class="ActionScriptOperator">-</span> 1<span class="ActionScriptBracket/Brace">])</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptDefault_Text">Math</span>.<span class="ActionScriptDefault_Text">abs</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">dv_array</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">h</span><span class="ActionScriptBracket/Brace">])))</span>;
            <span class="ActionScriptBracket/Brace">}</span>
            <span class="ActionScriptReserved">for</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">k</span> <span class="ActionScriptOperator">=</span> 0;<span class="ActionScriptDefault_Text">k</span> <span class="ActionScriptOperator">&lt;</span> <span class="ActionScriptDefault_Text">dim</span> <span class="ActionScriptOperator">-</span> 1; <span class="ActionScriptDefault_Text">k</span><span class="ActionScriptOperator">++</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptBracket/Brace">{</span>
                <span class="ActionScriptDefault_Text">h</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">k</span>;
                <span class="ActionScriptDefault_Text">t</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">dv_array</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">h</span><span class="ActionScriptBracket/Brace">]</span>;
                <span class="ActionScriptComment">// t = dv-&gt;v[h];
</span>                <span class="ActionScriptReserved">for</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">i</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">k</span> <span class="ActionScriptOperator">+</span> 1;<span class="ActionScriptDefault_Text">i</span> <span class="ActionScriptOperator">&lt;</span> <span class="ActionScriptDefault_Text">dim</span>; <span class="ActionScriptDefault_Text">i</span><span class="ActionScriptOperator">++</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptBracket/Brace">{</span>
                    <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">dv_array</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">i</span><span class="ActionScriptBracket/Brace">]</span> <span class="ActionScriptOperator">&gt;</span> <span class="ActionScriptDefault_Text">t</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptBracket/Brace">{</span>
                        <span class="ActionScriptComment">// if( dv-&gt;v[i] &gt; t ) {
</span>                        <span class="ActionScriptDefault_Text">h</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">i</span>;
                        <span class="ActionScriptDefault_Text">t</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">dv_array</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">h</span><span class="ActionScriptBracket/Brace">]</span>;<span class="ActionScriptComment">// t = dv-&gt;v[h];
</span>                    <span class="ActionScriptBracket/Brace">}</span>
                <span class="ActionScriptBracket/Brace">}</span>
                <span class="ActionScriptDefault_Text">dv_array</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">h</span><span class="ActionScriptBracket/Brace">]</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">dv_array</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">k</span><span class="ActionScriptBracket/Brace">]</span>;
                <span class="ActionScriptComment">// dv-&gt;v[h] = dv-&gt;v[k];
</span>                <span class="ActionScriptDefault_Text">dv_array</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">k</span><span class="ActionScriptBracket/Brace">]</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">t</span>;
                <span class="ActionScriptComment">// dv-&gt;v[k] = t;
</span>                <span class="ActionScriptReserved">this</span>.<span class="ActionScriptDefault_Text">flipRow</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">h</span>, <span class="ActionScriptDefault_Text">k</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptBracket/Brace">}</span>
        <span class="ActionScriptBracket/Brace">}</span>

        <span class="ActionScriptASDoc">/**
         * i_row_1番目の行と、i_row_2番目の行を入れ替える。
         * 
         * @param i_row_1
         * @param i_row_2
         */</span>
        <span class="ActionScriptReserved">private</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">flipRow</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">i_row_1</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">int</span>, <span class="ActionScriptDefault_Text">i_row_2</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">int</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">:</span><span class="ActionScriptReserved">void</span> <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">i</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">int</span>;
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">w</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">Number</span>;
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">r1</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">Array</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">this</span>.<span class="ActionScriptDefault_Text">m</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">i_row_1</span><span class="ActionScriptBracket/Brace">]</span>;
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">r2</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">Array</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">this</span>.<span class="ActionScriptDefault_Text">m</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">i_row_2</span><span class="ActionScriptBracket/Brace">]</span>;
            <span class="ActionScriptComment">// For順変更OK
</span>            <span class="ActionScriptReserved">for</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">i</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">clm</span> <span class="ActionScriptOperator">-</span> 1;<span class="ActionScriptDefault_Text">i</span> <span class="ActionScriptOperator">&gt;=</span> 0; <span class="ActionScriptDefault_Text">i</span><span class="ActionScriptOperator">--</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptBracket/Brace">{</span>
                <span class="ActionScriptDefault_Text">w</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">r1</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">i</span><span class="ActionScriptBracket/Brace">]</span>;
                <span class="ActionScriptDefault_Text">r1</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">i</span><span class="ActionScriptBracket/Brace">]</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">r2</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">i</span><span class="ActionScriptBracket/Brace">]</span>;
                <span class="ActionScriptDefault_Text">r2</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">i</span><span class="ActionScriptBracket/Brace">]</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">w</span>;
            <span class="ActionScriptBracket/Brace">}</span>
        <span class="ActionScriptBracket/Brace">}</span>

        <span class="ActionScriptASDoc">/**
         * static int EV_create( ARMat *input, ARMat *u, ARMat *output, ARVec *ev
         * )の代替関数
         * 
         * @param input
         * @param u
         * @param output
         * @param ev
         * @throws FLARException
         */</span>
        <span class="ActionScriptReserved">private</span> <span class="ActionScriptReserved">static</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">PCA_EV_create</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">input</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">FLARMat</span>, <span class="ActionScriptDefault_Text">u</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">FLARMat</span>, <span class="ActionScriptDefault_Text">output</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">FLARMat</span>, <span class="ActionScriptDefault_Text">ev</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">FLARVec</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">:</span><span class="ActionScriptReserved">void</span> <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptDefault_Text">FLARException</span>.<span class="ActionScriptDefault_Text">trap</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">&quot;未チェックのパス&quot;</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">row</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">int</span>;
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">clm</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">int</span>;
            <span class="ActionScriptDefault_Text">row</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">input</span>.<span class="ActionScriptDefault_Text">row</span>;
            <span class="ActionScriptComment">// row = input-&gt;row;
</span>            <span class="ActionScriptDefault_Text">clm</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">input</span>.<span class="ActionScriptDefault_Text">clm</span>;
            <span class="ActionScriptComment">// clm = input-&gt;clm;
</span>            <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">row</span> <span class="ActionScriptOperator">&lt;=</span> 0 <span class="ActionScriptOperator">||</span> <span class="ActionScriptDefault_Text">clm</span> <span class="ActionScriptOperator">&lt;=</span> 0<span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptBracket/Brace">{</span>
                <span class="ActionScriptReserved">throw</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">FLARException</span><span class="ActionScriptBracket/Brace">()</span>;
            <span class="ActionScriptBracket/Brace">}</span>
            <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">u</span>.<span class="ActionScriptDefault_Text">row</span> <span class="ActionScriptOperator">!=</span> <span class="ActionScriptDefault_Text">row</span> <span class="ActionScriptOperator">||</span> <span class="ActionScriptDefault_Text">u</span>.<span class="ActionScriptDefault_Text">clm</span> <span class="ActionScriptOperator">!=</span> <span class="ActionScriptDefault_Text">row</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptBracket/Brace">{</span>
                <span class="ActionScriptComment">// if( u-&gt;row != row || u-&gt;clm !=
</span>                <span class="ActionScriptComment">// row ){
</span>                <span class="ActionScriptReserved">throw</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">FLARException</span><span class="ActionScriptBracket/Brace">()</span>;
            <span class="ActionScriptBracket/Brace">}</span>
            <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">output</span>.<span class="ActionScriptDefault_Text">row</span> <span class="ActionScriptOperator">!=</span> <span class="ActionScriptDefault_Text">row</span> <span class="ActionScriptOperator">||</span> <span class="ActionScriptDefault_Text">output</span>.<span class="ActionScriptDefault_Text">clm</span> <span class="ActionScriptOperator">!=</span> <span class="ActionScriptDefault_Text">clm</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptBracket/Brace">{</span>
                <span class="ActionScriptComment">// if( output-&gt;row !=
</span>                <span class="ActionScriptComment">// row || output-&gt;clm !=
</span>                <span class="ActionScriptComment">// clm ){
</span>                <span class="ActionScriptReserved">throw</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">FLARException</span><span class="ActionScriptBracket/Brace">()</span>;
            <span class="ActionScriptBracket/Brace">}</span>
            <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">ev</span>.<span class="ActionScriptDefault_Text">getClm</span><span class="ActionScriptBracket/Brace">()</span> <span class="ActionScriptOperator">!=</span> <span class="ActionScriptDefault_Text">row</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptBracket/Brace">{</span>
                <span class="ActionScriptComment">// if( ev-&gt;clm != row ){
</span>                <span class="ActionScriptReserved">throw</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">FLARException</span><span class="ActionScriptBracket/Brace">()</span>;
            <span class="ActionScriptBracket/Brace">}</span>
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">m</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">Array</span>;
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">in_</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">Array</span>;
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">m1</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">Array</span>;
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">ev_array</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">Array</span>;
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">sum</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">Number</span>;
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">work</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">Number</span>;

            <span class="ActionScriptDefault_Text">FLARException</span>.<span class="ActionScriptDefault_Text">trap</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">&quot;未チェックのパス&quot;</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptDefault_Text">m</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">output</span>.<span class="ActionScriptDefault_Text">m</span>;
            <span class="ActionScriptComment">// m = output-&gt;m;
</span>            <span class="ActionScriptDefault_Text">in_</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">input</span>.<span class="ActionScriptDefault_Text">m</span>;

            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">i</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">int</span>;
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">j</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">int</span>;
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">k</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">int</span>;
            <span class="ActionScriptDefault_Text">ev_array</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">ev</span>.<span class="ActionScriptDefault_Text">getArray</span><span class="ActionScriptBracket/Brace">()</span>;
            <span class="ActionScriptReserved">for</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">i</span> <span class="ActionScriptOperator">=</span> 0; <span class="ActionScriptDefault_Text">i</span> <span class="ActionScriptOperator">&lt;</span> <span class="ActionScriptDefault_Text">row</span>; <span class="ActionScriptDefault_Text">i</span><span class="ActionScriptOperator">++</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptBracket/Brace">{</span>
                <span class="ActionScriptDefault_Text">FLARException</span>.<span class="ActionScriptDefault_Text">trap</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">&quot;未チェックのパス&quot;</span><span class="ActionScriptBracket/Brace">)</span>;
                <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">ev_array</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">i</span><span class="ActionScriptBracket/Brace">]</span> <span class="ActionScriptOperator">&lt;</span> <span class="ActionScriptDefault_Text">PCA_VZERO</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptBracket/Brace">{</span>
                    <span class="ActionScriptComment">// if( ev-&gt;v[i] &lt; VZERO ){
</span>                    <span class="ActionScriptReserved">break</span>;
                <span class="ActionScriptBracket/Brace">}</span>
                <span class="ActionScriptDefault_Text">FLARException</span>.<span class="ActionScriptDefault_Text">trap</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">&quot;未チェックのパス&quot;</span><span class="ActionScriptBracket/Brace">)</span>;
                <span class="ActionScriptDefault_Text">work</span> <span class="ActionScriptOperator">=</span> 1 <span class="ActionScriptOperator">/</span> <span class="ActionScriptDefault_Text">Math</span>.<span class="ActionScriptDefault_Text">sqrt</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">Math</span>.<span class="ActionScriptDefault_Text">abs</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">ev_array</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">i</span><span class="ActionScriptBracket/Brace">]))</span>;
                <span class="ActionScriptComment">// work = 1 /
</span>                <span class="ActionScriptComment">// sqrt(fabs(ev-&gt;v[i]));
</span>                <span class="ActionScriptReserved">for</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">j</span> <span class="ActionScriptOperator">=</span> 0; <span class="ActionScriptDefault_Text">j</span> <span class="ActionScriptOperator">&lt;</span> <span class="ActionScriptDefault_Text">clm</span>; <span class="ActionScriptDefault_Text">j</span><span class="ActionScriptOperator">++</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptBracket/Brace">{</span>
                    <span class="ActionScriptDefault_Text">sum</span> <span class="ActionScriptOperator">=</span> 0.0;
                    <span class="ActionScriptDefault_Text">m1</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">u</span>.<span class="ActionScriptDefault_Text">m</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">i</span><span class="ActionScriptBracket/Brace">]</span>;
                    <span class="ActionScriptComment">// m1 = &amp;(u-&gt;m[i*row]);
</span>                    <span class="ActionScriptComment">// m2=input.getPointer(j);//m2 = &amp;(input-&gt;m[j]);
</span>                    <span class="ActionScriptReserved">for</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">k</span> <span class="ActionScriptOperator">=</span> 0; <span class="ActionScriptDefault_Text">k</span> <span class="ActionScriptOperator">&lt;</span> <span class="ActionScriptDefault_Text">row</span>; <span class="ActionScriptDefault_Text">k</span><span class="ActionScriptOperator">++</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptBracket/Brace">{</span>
                        <span class="ActionScriptDefault_Text">sum</span> <span class="ActionScriptOperator">+=</span> <span class="ActionScriptDefault_Text">m1</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">k</span><span class="ActionScriptBracket/Brace">]</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptDefault_Text">in_</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">k</span><span class="ActionScriptBracket/Brace">][</span><span class="ActionScriptDefault_Text">j</span><span class="ActionScriptBracket/Brace">]</span>;<span class="ActionScriptComment">// sum += *m1 * *m2;
</span>                    <span class="ActionScriptComment">// m1.incPtr(); //m1++;
</span>                    <span class="ActionScriptComment">// m2.addPtr(clm);//m2 += clm;
</span>                    <span class="ActionScriptBracket/Brace">}</span>
                    <span class="ActionScriptDefault_Text">m1</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">j</span><span class="ActionScriptBracket/Brace">]</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">sum</span> <span class="ActionScriptOperator">*</span> <span class="ActionScriptDefault_Text">work</span>;<span class="ActionScriptComment">// *(m++) = sum * work;
</span>                <span class="ActionScriptComment">// {//*(m++) = sum * work;
</span>                <span class="ActionScriptComment">// m.set(sum * work);
</span>                <span class="ActionScriptComment">// m.incPtr();}
</span>                <span class="ActionScriptBracket/Brace">}</span>
            <span class="ActionScriptBracket/Brace">}</span>
            <span class="ActionScriptReserved">for</span> <span class="ActionScriptBracket/Brace">(</span>; <span class="ActionScriptDefault_Text">i</span> <span class="ActionScriptOperator">&lt;</span> <span class="ActionScriptDefault_Text">row</span>; <span class="ActionScriptDefault_Text">i</span><span class="ActionScriptOperator">++</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptBracket/Brace">{</span>
                <span class="ActionScriptDefault_Text">FLARException</span>.<span class="ActionScriptDefault_Text">trap</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">&quot;未チェックのパス&quot;</span><span class="ActionScriptBracket/Brace">)</span>;
                <span class="ActionScriptDefault_Text">ev_array</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">i</span><span class="ActionScriptBracket/Brace">]</span> <span class="ActionScriptOperator">=</span> 0.0;
                <span class="ActionScriptComment">// ev-&gt;v[i] = 0.0;
</span>                <span class="ActionScriptReserved">for</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">j</span> <span class="ActionScriptOperator">=</span> 0; <span class="ActionScriptDefault_Text">j</span> <span class="ActionScriptOperator">&lt;</span> <span class="ActionScriptDefault_Text">clm</span>; <span class="ActionScriptDefault_Text">j</span><span class="ActionScriptOperator">++</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptBracket/Brace">{</span>
                    <span class="ActionScriptDefault_Text">m</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">i</span><span class="ActionScriptBracket/Brace">][</span><span class="ActionScriptDefault_Text">j</span><span class="ActionScriptBracket/Brace">]</span> <span class="ActionScriptOperator">=</span> 0.0;
                <span class="ActionScriptComment">// m.set(0.0);//*(m++) = 0.0;
</span>                <span class="ActionScriptComment">// m.incPtr();
</span>                <span class="ActionScriptBracket/Brace">}</span>
            <span class="ActionScriptBracket/Brace">}</span>
        <span class="ActionScriptBracket/Brace">}</span>

        <span class="ActionScriptReserved">private</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">wk_PCA_PCA_u</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">FLARMat</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">null</span>;

        <span class="ActionScriptASDoc">/**
         * static int PCA( ARMat *input, ARMat *output, ARVec *ev )
         * 
         * @param output
         * @param o_ev
         * @throws FLARException
         */</span>
        <span class="ActionScriptReserved">private</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">PCA_PCA</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">o_output</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">FLARMat</span>, <span class="ActionScriptDefault_Text">o_ev</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">FLARVec</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">:</span><span class="ActionScriptReserved">void</span> <span class="ActionScriptBracket/Brace">{</span>

            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">l_row</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">int</span>;
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">l_clm</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">int</span>;
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">min</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">int</span>;
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">ev_array</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">Array</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">o_ev</span>.<span class="ActionScriptDefault_Text">getArray</span><span class="ActionScriptBracket/Brace">()</span>;

            <span class="ActionScriptDefault_Text">l_row</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">this</span>.<span class="ActionScriptDefault_Text">row</span>;
            <span class="ActionScriptComment">// row = input-&gt;row;
</span>            <span class="ActionScriptDefault_Text">l_clm</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">this</span>.<span class="ActionScriptDefault_Text">clm</span>;
            <span class="ActionScriptComment">// clm = input-&gt;clm;
</span>            <span class="ActionScriptDefault_Text">min</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">l_clm</span> <span class="ActionScriptOperator">&lt;</span> <span class="ActionScriptDefault_Text">l_row</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptOperator">?</span> <span class="ActionScriptDefault_Text">l_clm</span> <span class="ActionScriptOperator">:</span> <span class="ActionScriptDefault_Text">l_row</span>;
            <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">l_row</span> <span class="ActionScriptOperator">&lt;</span> 2 <span class="ActionScriptOperator">||</span> <span class="ActionScriptDefault_Text">l_clm</span> <span class="ActionScriptOperator">&lt;</span> 2<span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptBracket/Brace">{</span>
                <span class="ActionScriptReserved">throw</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">FLARException</span><span class="ActionScriptBracket/Brace">()</span>;
            <span class="ActionScriptBracket/Brace">}</span>
            <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">o_output</span>.<span class="ActionScriptDefault_Text">clm</span> <span class="ActionScriptOperator">!=</span> <span class="ActionScriptReserved">this</span>.<span class="ActionScriptDefault_Text">clm</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptBracket/Brace">{</span>
                <span class="ActionScriptComment">// if( output-&gt;clm != input-&gt;clm ){
</span>                <span class="ActionScriptReserved">throw</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">FLARException</span><span class="ActionScriptBracket/Brace">()</span>;
            <span class="ActionScriptBracket/Brace">}</span>
            <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">o_output</span>.<span class="ActionScriptDefault_Text">row</span> <span class="ActionScriptOperator">!=</span> <span class="ActionScriptDefault_Text">min</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptBracket/Brace">{</span>
                <span class="ActionScriptComment">// if( output-&gt;row != min ){
</span>                <span class="ActionScriptReserved">throw</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">FLARException</span><span class="ActionScriptBracket/Brace">()</span>;
            <span class="ActionScriptBracket/Brace">}</span>
            <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">o_ev</span>.<span class="ActionScriptDefault_Text">getClm</span><span class="ActionScriptBracket/Brace">()</span> <span class="ActionScriptOperator">!=</span> <span class="ActionScriptDefault_Text">min</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptBracket/Brace">{</span>
                <span class="ActionScriptComment">// if( ev-&gt;clm != min ){
</span>                <span class="ActionScriptReserved">throw</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">FLARException</span><span class="ActionScriptBracket/Brace">()</span>;
            <span class="ActionScriptBracket/Brace">}</span>

            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">u</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">FLARMat</span>;
            <span class="ActionScriptComment">// u =new FLARMat( min, min );
</span>            <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptReserved">this</span>.<span class="ActionScriptDefault_Text">wk_PCA_PCA_u</span> <span class="ActionScriptOperator">==</span> <span class="ActionScriptReserved">null</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptBracket/Brace">{</span>
                <span class="ActionScriptDefault_Text">u</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">FLARMat</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">min</span>, <span class="ActionScriptDefault_Text">min</span><span class="ActionScriptBracket/Brace">)</span>;
                <span class="ActionScriptReserved">this</span>.<span class="ActionScriptDefault_Text">wk_PCA_PCA_u</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">u</span>;
            <span class="ActionScriptBracket/Brace">}</span> <span class="ActionScriptReserved">else</span> <span class="ActionScriptBracket/Brace">{</span>
                <span class="ActionScriptDefault_Text">u</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">this</span>.<span class="ActionScriptDefault_Text">wk_PCA_PCA_u</span>;
                <span class="ActionScriptDefault_Text">u</span>.<span class="ActionScriptDefault_Text">realloc</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">min</span>, <span class="ActionScriptDefault_Text">min</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptBracket/Brace">}</span>

            <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">l_row</span> <span class="ActionScriptOperator">&lt;</span> <span class="ActionScriptDefault_Text">l_clm</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptBracket/Brace">{</span>
                <span class="ActionScriptDefault_Text">FLARException</span>.<span class="ActionScriptDefault_Text">trap</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">&quot;未チェックのパス&quot;</span><span class="ActionScriptBracket/Brace">)</span>;
                <span class="ActionScriptDefault_Text">PCA_x_by_xt</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptReserved">this</span>, <span class="ActionScriptDefault_Text">u</span><span class="ActionScriptBracket/Brace">)</span>;<span class="ActionScriptComment">// if(x_by_xt( input, u ) &lt; 0 ) {
</span>            <span class="ActionScriptBracket/Brace">}</span> <span class="ActionScriptReserved">else</span> <span class="ActionScriptBracket/Brace">{</span>
                <span class="ActionScriptDefault_Text">PCA_xt_by_x</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptReserved">this</span>, <span class="ActionScriptDefault_Text">u</span><span class="ActionScriptBracket/Brace">)</span>;<span class="ActionScriptComment">// if(xt_by_x( input, u ) &lt; 0 ) {
</span>            <span class="ActionScriptBracket/Brace">}</span>
            <span class="ActionScriptDefault_Text">u</span>.<span class="ActionScriptDefault_Text">PCA_QRM</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">o_ev</span><span class="ActionScriptBracket/Brace">)</span>;

            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">m1</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">Array</span>;
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">m2</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">Array</span>;
            <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">l_row</span> <span class="ActionScriptOperator">&lt;</span> <span class="ActionScriptDefault_Text">l_clm</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptBracket/Brace">{</span>
                <span class="ActionScriptDefault_Text">FLARException</span>.<span class="ActionScriptDefault_Text">trap</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">&quot;未チェックのパス&quot;</span><span class="ActionScriptBracket/Brace">)</span>;
                <span class="ActionScriptDefault_Text">PCA_EV_create</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptReserved">this</span>, <span class="ActionScriptDefault_Text">u</span>, <span class="ActionScriptDefault_Text">o_output</span>, <span class="ActionScriptDefault_Text">o_ev</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptBracket/Brace">}</span> <span class="ActionScriptReserved">else</span> <span class="ActionScriptBracket/Brace">{</span>
                <span class="ActionScriptDefault_Text">m1</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">u</span>.<span class="ActionScriptDefault_Text">m</span>;
                <span class="ActionScriptComment">// m1 = u-&gt;m;
</span>                <span class="ActionScriptDefault_Text">m2</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">o_output</span>.<span class="ActionScriptDefault_Text">m</span>;
                <span class="ActionScriptComment">// m2 = output-&gt;m;
</span>                <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">i</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">int</span>;
                <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">j</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">int</span>;
                <span class="ActionScriptReserved">for</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">i</span> <span class="ActionScriptOperator">=</span> 0;<span class="ActionScriptDefault_Text">i</span> <span class="ActionScriptOperator">&lt;</span> <span class="ActionScriptDefault_Text">min</span>; <span class="ActionScriptDefault_Text">i</span><span class="ActionScriptOperator">++</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptBracket/Brace">{</span>
                    <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">ev_array</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">i</span><span class="ActionScriptBracket/Brace">]</span> <span class="ActionScriptOperator">&lt;</span> <span class="ActionScriptDefault_Text">PCA_VZERO</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptBracket/Brace">{</span>
                        <span class="ActionScriptComment">// if( ev-&gt;v[i] &lt; VZERO ){
</span>                        <span class="ActionScriptReserved">break</span>;
                    <span class="ActionScriptBracket/Brace">}</span>
                    <span class="ActionScriptReserved">for</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">j</span> <span class="ActionScriptOperator">=</span> 0;<span class="ActionScriptDefault_Text">j</span> <span class="ActionScriptOperator">&lt;</span> <span class="ActionScriptDefault_Text">min</span>; <span class="ActionScriptDefault_Text">j</span><span class="ActionScriptOperator">++</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptBracket/Brace">{</span>
                        <span class="ActionScriptDefault_Text">m2</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">i</span><span class="ActionScriptBracket/Brace">][</span><span class="ActionScriptDefault_Text">j</span><span class="ActionScriptBracket/Brace">]</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">m1</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">i</span><span class="ActionScriptBracket/Brace">][</span><span class="ActionScriptDefault_Text">j</span><span class="ActionScriptBracket/Brace">]</span>;<span class="ActionScriptComment">// *(m2++) = *(m1++);
</span>                    <span class="ActionScriptBracket/Brace">}</span>
                <span class="ActionScriptBracket/Brace">}</span>
                <span class="ActionScriptReserved">for</span> <span class="ActionScriptBracket/Brace">(</span>;<span class="ActionScriptDefault_Text">i</span> <span class="ActionScriptOperator">&lt;</span> <span class="ActionScriptDefault_Text">min</span>; <span class="ActionScriptDefault_Text">i</span><span class="ActionScriptOperator">++</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptBracket/Brace">{</span>
                    <span class="ActionScriptComment">// for( ; i &lt; min; i++){
</span>                    <span class="ActionScriptComment">// コードを見た限りあってそうだからコメントアウト(2008/03/26)FLARException.trap(&quot;未チェックのパス&quot;);
</span>                    <span class="ActionScriptDefault_Text">ev_array</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">i</span><span class="ActionScriptBracket/Brace">]</span> <span class="ActionScriptOperator">=</span> 0.0;
                    <span class="ActionScriptComment">// ev-&gt;v[i] = 0.0;
</span>                    <span class="ActionScriptReserved">for</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">j</span> <span class="ActionScriptOperator">=</span> 0;<span class="ActionScriptDefault_Text">j</span> <span class="ActionScriptOperator">&lt;</span> <span class="ActionScriptDefault_Text">min</span>; <span class="ActionScriptDefault_Text">j</span><span class="ActionScriptOperator">++</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptBracket/Brace">{</span>
                        <span class="ActionScriptDefault_Text">m2</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">i</span><span class="ActionScriptBracket/Brace">][</span><span class="ActionScriptDefault_Text">j</span><span class="ActionScriptBracket/Brace">]</span> <span class="ActionScriptOperator">=</span> 0.0;<span class="ActionScriptComment">// *(m2++) = 0.0;
</span>                    <span class="ActionScriptBracket/Brace">}</span>
                <span class="ActionScriptBracket/Brace">}</span>
            <span class="ActionScriptBracket/Brace">}</span>
        <span class="ActionScriptBracket/Brace">}</span>

        <span class="ActionScriptReserved">private</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">wk_work_matrixPCA</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">FLARMat</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">null</span>;

        <span class="ActionScriptASDoc">/**
         * int arMatrixPCA( ARMat *input, ARMat *evec, ARVec *ev, ARVec *mean );
         * 関数の置き換え。input引数がthisになる。 Optimize:2008.04.19
         * 
         * @param o_evec
         * @param o_ev
         * 
         * @param mean
         * @throws FLARException
         */</span>
        <span class="ActionScriptReserved">public</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">matrixPCA</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">o_evec</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">FLARMat</span>, <span class="ActionScriptDefault_Text">o_ev</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">FLARVec</span>, <span class="ActionScriptDefault_Text">mean</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">FLARVec</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">:</span><span class="ActionScriptReserved">void</span> <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">srow</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">Number</span>;
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">sum</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">Number</span>;
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">l_row</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">int</span>;
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">l_clm</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">int</span>;
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">check</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">int</span>;

            <span class="ActionScriptDefault_Text">l_row</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">this</span>.<span class="ActionScriptDefault_Text">row</span>;
            <span class="ActionScriptComment">// row = input-&gt;row;
</span>            <span class="ActionScriptDefault_Text">l_clm</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">this</span>.<span class="ActionScriptDefault_Text">clm</span>;
            <span class="ActionScriptComment">// clm = input-&gt;clm;
</span>            <span class="ActionScriptDefault_Text">check</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">l_row</span> <span class="ActionScriptOperator">&lt;</span> <span class="ActionScriptDefault_Text">l_clm</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptOperator">?</span> <span class="ActionScriptDefault_Text">l_row</span> <span class="ActionScriptOperator">:</span> <span class="ActionScriptDefault_Text">l_clm</span>;
            <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">l_row</span> <span class="ActionScriptOperator">&lt;</span> 2 <span class="ActionScriptOperator">||</span> <span class="ActionScriptDefault_Text">l_clm</span> <span class="ActionScriptOperator">&lt;</span> 2<span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptBracket/Brace">{</span>
                <span class="ActionScriptReserved">throw</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">FLARException</span><span class="ActionScriptBracket/Brace">()</span>;
            <span class="ActionScriptBracket/Brace">}</span>
            <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">o_evec</span>.<span class="ActionScriptDefault_Text">clm</span> <span class="ActionScriptOperator">!=</span> <span class="ActionScriptDefault_Text">l_clm</span> <span class="ActionScriptOperator">||</span> <span class="ActionScriptDefault_Text">o_evec</span>.<span class="ActionScriptDefault_Text">row</span> <span class="ActionScriptOperator">!=</span> <span class="ActionScriptDefault_Text">check</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptBracket/Brace">{</span>
                <span class="ActionScriptComment">// if( evec-&gt;clm !=
</span>                <span class="ActionScriptComment">// input-&gt;clm ||
</span>                <span class="ActionScriptComment">// evec-&gt;row !=
</span>                <span class="ActionScriptComment">// check ){
</span>                <span class="ActionScriptReserved">throw</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">FLARException</span><span class="ActionScriptBracket/Brace">()</span>;
            <span class="ActionScriptBracket/Brace">}</span>
            <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">o_ev</span>.<span class="ActionScriptDefault_Text">getClm</span><span class="ActionScriptBracket/Brace">()</span> <span class="ActionScriptOperator">!=</span> <span class="ActionScriptDefault_Text">check</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptBracket/Brace">{</span>
                <span class="ActionScriptComment">// if( ev-&gt;clm != check ){
</span>                <span class="ActionScriptReserved">throw</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">FLARException</span><span class="ActionScriptBracket/Brace">()</span>;
            <span class="ActionScriptBracket/Brace">}</span>
            <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">mean</span>.<span class="ActionScriptDefault_Text">getClm</span><span class="ActionScriptBracket/Brace">()</span> <span class="ActionScriptOperator">!=</span> <span class="ActionScriptDefault_Text">l_clm</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptBracket/Brace">{</span>
                <span class="ActionScriptComment">// if( mean-&gt;clm != input-&gt;clm ){
</span>                <span class="ActionScriptReserved">throw</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">FLARException</span><span class="ActionScriptBracket/Brace">()</span>;
            <span class="ActionScriptBracket/Brace">}</span>

            <span class="ActionScriptComment">// 自分の内容をワークにコピー(高速化の為に、1度作ったインスタンスは使いまわす)
</span>            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">work</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">FLARMat</span>;
            <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptReserved">this</span>.<span class="ActionScriptDefault_Text">wk_work_matrixPCA</span> <span class="ActionScriptOperator">==</span> <span class="ActionScriptReserved">null</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptBracket/Brace">{</span>
                <span class="ActionScriptDefault_Text">work</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">this</span>.<span class="ActionScriptDefault_Text">matrixAllocDup</span><span class="ActionScriptBracket/Brace">()</span>;
                <span class="ActionScriptReserved">this</span>.<span class="ActionScriptDefault_Text">wk_work_matrixPCA</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">work</span>;
            <span class="ActionScriptBracket/Brace">}</span> <span class="ActionScriptReserved">else</span> <span class="ActionScriptBracket/Brace">{</span>
                <span class="ActionScriptDefault_Text">work</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">this</span>.<span class="ActionScriptDefault_Text">wk_work_matrixPCA</span>;
                <span class="ActionScriptDefault_Text">work</span>.<span class="ActionScriptDefault_Text">matrixDup</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptReserved">this</span><span class="ActionScriptBracket/Brace">)</span>;<span class="ActionScriptComment">// arMatrixAllocDup( input );work =
</span>                                    <span class="ActionScriptComment">// arMatrixAllocDup( input );
</span>            <span class="ActionScriptBracket/Brace">}</span>

            <span class="ActionScriptDefault_Text">srow</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">Math</span>.<span class="ActionScriptDefault_Text">sqrt</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">l_row</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptDefault_Text">work</span>.<span class="ActionScriptDefault_Text">PCA_EX</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">mean</span><span class="ActionScriptBracket/Brace">)</span>;

            <span class="ActionScriptDefault_Text">PCA_CENTER</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">work</span>, <span class="ActionScriptDefault_Text">mean</span><span class="ActionScriptBracket/Brace">)</span>;

            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">i</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">int</span>;
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">j</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">int</span>;
            <span class="ActionScriptComment">// For順変更OK
</span>            <span class="ActionScriptReserved">for</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">i</span> <span class="ActionScriptOperator">=</span> 0;<span class="ActionScriptDefault_Text">i</span> <span class="ActionScriptOperator">&lt;</span> <span class="ActionScriptDefault_Text">l_row</span>; <span class="ActionScriptDefault_Text">i</span><span class="ActionScriptOperator">++</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptBracket/Brace">{</span>
                <span class="ActionScriptReserved">for</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">j</span> <span class="ActionScriptOperator">=</span> 0;<span class="ActionScriptDefault_Text">j</span> <span class="ActionScriptOperator">&lt;</span> <span class="ActionScriptDefault_Text">l_clm</span>; <span class="ActionScriptDefault_Text">j</span><span class="ActionScriptOperator">++</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptBracket/Brace">{</span>
                    <span class="ActionScriptDefault_Text">work</span>.<span class="ActionScriptDefault_Text">m</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">i</span><span class="ActionScriptBracket/Brace">][</span><span class="ActionScriptDefault_Text">j</span><span class="ActionScriptBracket/Brace">]</span> <span class="ActionScriptOperator">/=</span> <span class="ActionScriptDefault_Text">srow</span>;<span class="ActionScriptComment">// work-&gt;m[i] /= srow;
</span>                <span class="ActionScriptBracket/Brace">}</span>
            <span class="ActionScriptBracket/Brace">}</span>

            <span class="ActionScriptDefault_Text">work</span>.<span class="ActionScriptDefault_Text">PCA_PCA</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">o_evec</span>, <span class="ActionScriptDefault_Text">o_ev</span><span class="ActionScriptBracket/Brace">)</span>;

            <span class="ActionScriptDefault_Text">sum</span> <span class="ActionScriptOperator">=</span> 0.0;
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">ev_array</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">Array</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">o_ev</span>.<span class="ActionScriptDefault_Text">getArray</span><span class="ActionScriptBracket/Brace">()</span>;
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">ev_clm</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">int</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">o_ev</span>.<span class="ActionScriptDefault_Text">getClm</span><span class="ActionScriptBracket/Brace">()</span>;
            <span class="ActionScriptComment">// For順変更禁止
</span>            <span class="ActionScriptReserved">for</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">i</span> <span class="ActionScriptOperator">=</span> 0;<span class="ActionScriptDefault_Text">i</span> <span class="ActionScriptOperator">&lt;</span> <span class="ActionScriptDefault_Text">ev_clm</span>; <span class="ActionScriptDefault_Text">i</span><span class="ActionScriptOperator">++</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptBracket/Brace">{</span>
                <span class="ActionScriptComment">// for(int i = 0; i &lt; ev-&gt;clm; i++ ){
</span>                <span class="ActionScriptDefault_Text">sum</span> <span class="ActionScriptOperator">+=</span> <span class="ActionScriptDefault_Text">ev_array</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">i</span><span class="ActionScriptBracket/Brace">]</span>;<span class="ActionScriptComment">// sum += ev-&gt;v[i];
</span>            <span class="ActionScriptBracket/Brace">}</span>
            <span class="ActionScriptComment">// For順変更禁止
</span>            <span class="ActionScriptReserved">for</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">i</span> <span class="ActionScriptOperator">=</span> 0;<span class="ActionScriptDefault_Text">i</span> <span class="ActionScriptOperator">&lt;</span> <span class="ActionScriptDefault_Text">ev_clm</span>; <span class="ActionScriptDefault_Text">i</span><span class="ActionScriptOperator">++</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptBracket/Brace">{</span>
                <span class="ActionScriptComment">// for(int i = 0; i &lt; ev-&gt;clm; i++ ){
</span>                <span class="ActionScriptDefault_Text">ev_array</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">i</span><span class="ActionScriptBracket/Brace">]</span> <span class="ActionScriptOperator">/=</span> <span class="ActionScriptDefault_Text">sum</span>;<span class="ActionScriptComment">// ev-&gt;v[i] /= sum;
</span>            <span class="ActionScriptBracket/Brace">}</span>
        <span class="ActionScriptBracket/Brace">}</span>

        <span class="ActionScriptComment">/* int arMatrixPCA2( ARMat *input, ARMat *evec, ARVec *ev ); */</span>
        <span class="ActionScriptReserved">public</span> <span class="ActionScriptReserved">static</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">arMatrixPCA2</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">input</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">FLARMat</span>, <span class="ActionScriptDefault_Text">evec</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">FLARMat</span>, <span class="ActionScriptDefault_Text">ev</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">FLARVec</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">:</span><span class="ActionScriptReserved">void</span> <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptDefault_Text">FLARException</span>.<span class="ActionScriptDefault_Text">trap</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">&quot;未チェックのパス&quot;</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">work</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">FLARMat</span>;
            <span class="ActionScriptComment">// double srow; // unreferenced
</span>            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">sum</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">Number</span>;
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">row</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">int</span>;
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">clm</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">int</span>;
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">check</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">int</span>;

            <span class="ActionScriptDefault_Text">row</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">input</span>.<span class="ActionScriptDefault_Text">row</span>;
            <span class="ActionScriptComment">// row = input-&gt;row;
</span>            <span class="ActionScriptDefault_Text">clm</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">input</span>.<span class="ActionScriptDefault_Text">clm</span>;
            <span class="ActionScriptComment">// clm = input-&gt;clm;
</span>            <span class="ActionScriptDefault_Text">check</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">row</span> <span class="ActionScriptOperator">&lt;</span> <span class="ActionScriptDefault_Text">clm</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptOperator">?</span> <span class="ActionScriptDefault_Text">row</span> <span class="ActionScriptOperator">:</span> <span class="ActionScriptDefault_Text">clm</span>;
            <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">row</span> <span class="ActionScriptOperator">&lt;</span> 2 <span class="ActionScriptOperator">||</span> <span class="ActionScriptDefault_Text">clm</span> <span class="ActionScriptOperator">&lt;</span> 2<span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptBracket/Brace">{</span>
                <span class="ActionScriptReserved">throw</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">FLARException</span><span class="ActionScriptBracket/Brace">()</span>;
            <span class="ActionScriptBracket/Brace">}</span>
            <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">evec</span>.<span class="ActionScriptDefault_Text">getClm</span><span class="ActionScriptBracket/Brace">()</span> <span class="ActionScriptOperator">!=</span> <span class="ActionScriptDefault_Text">input</span>.<span class="ActionScriptDefault_Text">clm</span> <span class="ActionScriptOperator">||</span> <span class="ActionScriptDefault_Text">evec</span>.<span class="ActionScriptDefault_Text">row</span> <span class="ActionScriptOperator">!=</span> <span class="ActionScriptDefault_Text">check</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptBracket/Brace">{</span>
                <span class="ActionScriptComment">// if( evec-&gt;clm!= input-&gt;clm|| evec-&gt;row!= check ){
</span>                <span class="ActionScriptReserved">throw</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">FLARException</span><span class="ActionScriptBracket/Brace">()</span>;
            <span class="ActionScriptBracket/Brace">}</span>
            <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">ev</span>.<span class="ActionScriptDefault_Text">getClm</span><span class="ActionScriptBracket/Brace">()</span> <span class="ActionScriptOperator">!=</span> <span class="ActionScriptDefault_Text">check</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptBracket/Brace">{</span>
                <span class="ActionScriptComment">// if( ev-&gt;clm != check ){
</span>                <span class="ActionScriptReserved">throw</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">FLARException</span><span class="ActionScriptBracket/Brace">()</span>;
            <span class="ActionScriptBracket/Brace">}</span>

            <span class="ActionScriptDefault_Text">FLARException</span>.<span class="ActionScriptDefault_Text">trap</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">&quot;未チェックのパス&quot;</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptDefault_Text">work</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">input</span>.<span class="ActionScriptDefault_Text">matrixAllocDup</span><span class="ActionScriptBracket/Brace">()</span>;

            <span class="ActionScriptDefault_Text">FLARException</span>.<span class="ActionScriptDefault_Text">trap</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">&quot;未チェックパス&quot;</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptDefault_Text">work</span>.<span class="ActionScriptDefault_Text">PCA_PCA</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">evec</span>, <span class="ActionScriptDefault_Text">ev</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptComment">// rval = PCA( work, evec, ev );
</span>            <span class="ActionScriptDefault_Text">sum</span> <span class="ActionScriptOperator">=</span> 0.0;
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">ev_array</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">Array</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">ev</span>.<span class="ActionScriptDefault_Text">getArray</span><span class="ActionScriptBracket/Brace">()</span>;
            
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">i</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">int</span>;
            <span class="ActionScriptReserved">for</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">i</span> <span class="ActionScriptOperator">=</span> 0;<span class="ActionScriptDefault_Text">i</span> <span class="ActionScriptOperator">&lt;</span> <span class="ActionScriptDefault_Text">ev</span>.<span class="ActionScriptDefault_Text">getClm</span><span class="ActionScriptBracket/Brace">()</span>; <span class="ActionScriptDefault_Text">i</span><span class="ActionScriptOperator">++</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptBracket/Brace">{</span>
                <span class="ActionScriptComment">// for( i = 0; i &lt; ev-&gt;clm; i++
</span>                <span class="ActionScriptComment">// ){
</span>                <span class="ActionScriptDefault_Text">FLARException</span>.<span class="ActionScriptDefault_Text">trap</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">&quot;未チェックパス&quot;</span><span class="ActionScriptBracket/Brace">)</span>;
                <span class="ActionScriptDefault_Text">sum</span> <span class="ActionScriptOperator">+=</span> <span class="ActionScriptDefault_Text">ev_array</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">i</span><span class="ActionScriptBracket/Brace">]</span>;<span class="ActionScriptComment">// sum += ev-&gt;v[i];
</span>            <span class="ActionScriptBracket/Brace">}</span>
            <span class="ActionScriptReserved">for</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">i</span> <span class="ActionScriptOperator">=</span> 0;<span class="ActionScriptDefault_Text">i</span> <span class="ActionScriptOperator">&lt;</span> <span class="ActionScriptDefault_Text">ev</span>.<span class="ActionScriptDefault_Text">getClm</span><span class="ActionScriptBracket/Brace">()</span>; <span class="ActionScriptDefault_Text">i</span><span class="ActionScriptOperator">++</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptBracket/Brace">{</span>
                <span class="ActionScriptComment">// for(int i = 0; i &lt; ev-&gt;clm;i++ ){
</span>                <span class="ActionScriptDefault_Text">FLARException</span>.<span class="ActionScriptDefault_Text">trap</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">&quot;未チェックパス&quot;</span><span class="ActionScriptBracket/Brace">)</span>;
                <span class="ActionScriptDefault_Text">ev_array</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">i</span><span class="ActionScriptBracket/Brace">]</span> <span class="ActionScriptOperator">/=</span> <span class="ActionScriptDefault_Text">sum</span>;<span class="ActionScriptComment">// ev-&gt;v[i] /= sum;
</span>            <span class="ActionScriptBracket/Brace">}</span>
            <span class="ActionScriptReserved">return</span>;
        <span class="ActionScriptBracket/Brace">}</span>

        <span class="ActionScriptReserved">public</span> <span class="ActionScriptReserved">static</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">matrixAllocMul</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">a</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">FLARMat</span>, <span class="ActionScriptDefault_Text">b</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">FLARMat</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">FLARMat</span> <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptDefault_Text">FLARException</span>.<span class="ActionScriptDefault_Text">trap</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">&quot;未チェックのパス&quot;</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">dest</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">FLARMat</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">FLARMat</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">a</span>.<span class="ActionScriptDefault_Text">row</span>, <span class="ActionScriptDefault_Text">b</span>.<span class="ActionScriptDefault_Text">clm</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptDefault_Text">FLARException</span>.<span class="ActionScriptDefault_Text">trap</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">&quot;未チェックのパス&quot;</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptDefault_Text">dest</span>.<span class="ActionScriptDefault_Text">matrixMul</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">a</span>, <span class="ActionScriptDefault_Text">b</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptReserved">return</span> <span class="ActionScriptDefault_Text">dest</span>;
        <span class="ActionScriptBracket/Brace">}</span>

        <span class="ActionScriptComment">/* static double mdet(double *ap, int dimen, int rowa) */</span>
        <span class="ActionScriptReserved">private</span> <span class="ActionScriptReserved">static</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">Det_mdet</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">ap</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">Array</span>, <span class="ActionScriptDefault_Text">dimen</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">int</span>, <span class="ActionScriptDefault_Text">rowa</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">int</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">Number</span> <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptDefault_Text">FLARException</span>.<span class="ActionScriptDefault_Text">trap</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">&quot;動作未チェック/配列化未チェック&quot;</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">det</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">Number</span> <span class="ActionScriptOperator">=</span> 1.0;
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">work</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">Number</span>;
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">is_</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">int</span> <span class="ActionScriptOperator">=</span> 0;
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">mmax</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">int</span>;

            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">k</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">int</span>;
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">i</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">int</span>;
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">j</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">int</span>;
            <span class="ActionScriptReserved">for</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">k</span> <span class="ActionScriptOperator">=</span> 0;<span class="ActionScriptDefault_Text">k</span> <span class="ActionScriptOperator">&lt;</span> <span class="ActionScriptDefault_Text">dimen</span> <span class="ActionScriptOperator">-</span> 1; <span class="ActionScriptDefault_Text">k</span><span class="ActionScriptOperator">++</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptBracket/Brace">{</span>
                <span class="ActionScriptDefault_Text">mmax</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">k</span>;
                <span class="ActionScriptReserved">for</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">i</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">k</span> <span class="ActionScriptOperator">+</span> 1;<span class="ActionScriptDefault_Text">i</span> <span class="ActionScriptOperator">&lt;</span> <span class="ActionScriptDefault_Text">dimen</span>; <span class="ActionScriptDefault_Text">i</span><span class="ActionScriptOperator">++</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptBracket/Brace">{</span>
                    <span class="ActionScriptComment">// if (Math.abs(arMatrixDet_MATRIX_get(ap, i, k, rowa)) &gt;
</span>                    <span class="ActionScriptComment">// Math.abs(arMatrixDet_MATRIX_get(ap, mmax, k, rowa))){
</span>                    <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">Math</span>.<span class="ActionScriptDefault_Text">abs</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">ap</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">i</span><span class="ActionScriptBracket/Brace">][</span><span class="ActionScriptDefault_Text">k</span><span class="ActionScriptBracket/Brace">])</span> <span class="ActionScriptOperator">&gt;</span> <span class="ActionScriptDefault_Text">Math</span>.<span class="ActionScriptDefault_Text">abs</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">ap</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">mmax</span><span class="ActionScriptBracket/Brace">][</span><span class="ActionScriptDefault_Text">k</span><span class="ActionScriptBracket/Brace">]))</span> <span class="ActionScriptBracket/Brace">{</span>
                        <span class="ActionScriptDefault_Text">mmax</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">i</span>;
                    <span class="ActionScriptBracket/Brace">}</span>
                <span class="ActionScriptBracket/Brace">}</span>
                <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">mmax</span> <span class="ActionScriptOperator">!=</span> <span class="ActionScriptDefault_Text">k</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptBracket/Brace">{</span>
                    <span class="ActionScriptReserved">for</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">j</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">k</span>;<span class="ActionScriptDefault_Text">j</span> <span class="ActionScriptOperator">&lt;</span> <span class="ActionScriptDefault_Text">dimen</span>; <span class="ActionScriptDefault_Text">j</span><span class="ActionScriptOperator">++</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptBracket/Brace">{</span>
                        <span class="ActionScriptDefault_Text">work</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">ap</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">k</span><span class="ActionScriptBracket/Brace">][</span><span class="ActionScriptDefault_Text">j</span><span class="ActionScriptBracket/Brace">]</span>;
                        <span class="ActionScriptComment">// work = MATRIX(ap, k, j, rowa);
</span>                        <span class="ActionScriptDefault_Text">ap</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">k</span><span class="ActionScriptBracket/Brace">][</span><span class="ActionScriptDefault_Text">j</span><span class="ActionScriptBracket/Brace">]</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">ap</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">mmax</span><span class="ActionScriptBracket/Brace">][</span><span class="ActionScriptDefault_Text">j</span><span class="ActionScriptBracket/Brace">]</span>;
                        <span class="ActionScriptComment">// MATRIX(ap, k, j, rowa) =MATRIX(ap, mmax, j, rowa);
</span>                        <span class="ActionScriptDefault_Text">ap</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">mmax</span><span class="ActionScriptBracket/Brace">][</span><span class="ActionScriptDefault_Text">j</span><span class="ActionScriptBracket/Brace">]</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">work</span>;<span class="ActionScriptComment">// MATRIX(ap, mmax, j, rowa) = work;
</span>                    <span class="ActionScriptBracket/Brace">}</span>
                    <span class="ActionScriptDefault_Text">is_</span><span class="ActionScriptOperator">++</span>;
                <span class="ActionScriptBracket/Brace">}</span>
                <span class="ActionScriptReserved">for</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">i</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">k</span> <span class="ActionScriptOperator">+</span> 1;<span class="ActionScriptDefault_Text">i</span> <span class="ActionScriptOperator">&lt;</span> <span class="ActionScriptDefault_Text">dimen</span>; <span class="ActionScriptDefault_Text">i</span><span class="ActionScriptOperator">++</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptBracket/Brace">{</span>
                    <span class="ActionScriptDefault_Text">work</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">ap</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">i</span><span class="ActionScriptBracket/Brace">][</span><span class="ActionScriptDefault_Text">k</span><span class="ActionScriptBracket/Brace">]</span> <span class="ActionScriptOperator">/</span> <span class="ActionScriptDefault_Text">ap</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">k</span><span class="ActionScriptBracket/Brace">][</span><span class="ActionScriptDefault_Text">k</span><span class="ActionScriptBracket/Brace">]</span>;
                    <span class="ActionScriptComment">// work = arMatrixDet_MATRIX_get(ap,i, k, rowa) /arMatrixDet_MATRIX_get(ap, k, k,rowa);
</span>                    <span class="ActionScriptReserved">for</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">j</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">k</span> <span class="ActionScriptOperator">+</span> 1;<span class="ActionScriptDefault_Text">j</span> <span class="ActionScriptOperator">&lt;</span> <span class="ActionScriptDefault_Text">dimen</span>; <span class="ActionScriptDefault_Text">j</span><span class="ActionScriptOperator">++</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptBracket/Brace">{</span>
                        <span class="ActionScriptComment">// MATRIX(ap, i, j, rowa) -= work * MATRIX(ap, k, j, rowa);
</span>                        <span class="ActionScriptDefault_Text">ap</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">i</span><span class="ActionScriptBracket/Brace">][</span><span class="ActionScriptDefault_Text">j</span><span class="ActionScriptBracket/Brace">]</span> <span class="ActionScriptOperator">-=</span> <span class="ActionScriptDefault_Text">work</span> <span class="ActionScriptOperator">*</span> <span class="ActionScriptDefault_Text">ap</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">k</span><span class="ActionScriptBracket/Brace">][</span><span class="ActionScriptDefault_Text">j</span><span class="ActionScriptBracket/Brace">]</span>;
                    <span class="ActionScriptBracket/Brace">}</span>
                <span class="ActionScriptBracket/Brace">}</span>
            <span class="ActionScriptBracket/Brace">}</span>
            <span class="ActionScriptReserved">for</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">i</span> <span class="ActionScriptOperator">=</span> 0;<span class="ActionScriptDefault_Text">i</span> <span class="ActionScriptOperator">&lt;</span> <span class="ActionScriptDefault_Text">dimen</span>; <span class="ActionScriptDefault_Text">i</span><span class="ActionScriptOperator">++</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptBracket/Brace">{</span>
                <span class="ActionScriptDefault_Text">det</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">ap</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">i</span><span class="ActionScriptBracket/Brace">][</span><span class="ActionScriptDefault_Text">i</span><span class="ActionScriptBracket/Brace">]</span>;<span class="ActionScriptComment">// det *= MATRIX(ap, i, i, rowa);
</span>            <span class="ActionScriptBracket/Brace">}</span>
            <span class="ActionScriptReserved">for</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">i</span> <span class="ActionScriptOperator">=</span> 0;<span class="ActionScriptDefault_Text">i</span> <span class="ActionScriptOperator">&lt;</span> <span class="ActionScriptDefault_Text">is_</span>; <span class="ActionScriptDefault_Text">i</span><span class="ActionScriptOperator">++</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptBracket/Brace">{</span>
                <span class="ActionScriptDefault_Text">det</span> <span class="ActionScriptOperator">*=</span> <span class="ActionScriptOperator">-</span>1.0;
            <span class="ActionScriptBracket/Brace">}</span>
            <span class="ActionScriptReserved">return</span> <span class="ActionScriptDefault_Text">det</span>;
        <span class="ActionScriptBracket/Brace">}</span>

        <span class="ActionScriptComment">/* double arMatrixDet(ARMat *m); */</span>
        <span class="ActionScriptReserved">public</span> <span class="ActionScriptReserved">static</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">arMatrixDet</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">m</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">FLARMat</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">Number</span> <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptDefault_Text">FLARException</span>.<span class="ActionScriptDefault_Text">trap</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">&quot;動作未チェック/配列化未チェック&quot;</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">m</span>.<span class="ActionScriptDefault_Text">row</span> <span class="ActionScriptOperator">!=</span> <span class="ActionScriptDefault_Text">m</span>.<span class="ActionScriptDefault_Text">clm</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptBracket/Brace">{</span>
                <span class="ActionScriptReserved">return</span> 0.0;
            <span class="ActionScriptBracket/Brace">}</span>
            <span class="ActionScriptReserved">return</span> <span class="ActionScriptDefault_Text">Det_mdet</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">m</span>.<span class="ActionScriptDefault_Text">getArray</span><span class="ActionScriptBracket/Brace">()</span>, <span class="ActionScriptDefault_Text">m</span>.<span class="ActionScriptDefault_Text">row</span>, <span class="ActionScriptDefault_Text">m</span>.<span class="ActionScriptDefault_Text">clm</span><span class="ActionScriptBracket/Brace">)</span>;<span class="ActionScriptComment">// return mdet(m-&gt;m, m-&gt;row,m-&gt;row);
</span>        <span class="ActionScriptBracket/Brace">}</span>

        <span class="ActionScriptReserved">private</span> <span class="ActionScriptReserved">const</span> <span class="ActionScriptDefault_Text">wk_vecTridiagonalize_vec</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">FLARVec</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">FLARVec</span><span class="ActionScriptBracket/Brace">(</span>0<span class="ActionScriptBracket/Brace">)</span>;

        <span class="ActionScriptReserved">private</span> <span class="ActionScriptReserved">const</span> <span class="ActionScriptDefault_Text">wk_vecTridiagonalize_vec2</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">FLARVec</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">FLARVec</span><span class="ActionScriptBracket/Brace">(</span>0<span class="ActionScriptBracket/Brace">)</span>;

        <span class="ActionScriptASDoc">/**
         * arVecTridiagonalize関数の代替品 a,d,e間で演算をしてる。何をどうしているかはさっぱりさっぱり
         * 
         * @param a
         * @param d
         * @param e
         * @param i_e_start
         *            演算開始列(よくわからないけどarVecTridiagonalizeの呼び出し元でなんかしてる)
         * @return
         * @throws FLARException
         */</span>
        <span class="ActionScriptReserved">private</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">vecTridiagonalize</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">d</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">FLARVec</span>, <span class="ActionScriptDefault_Text">e</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">FLARVec</span>, <span class="ActionScriptDefault_Text">i_e_start</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">int</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">:</span><span class="ActionScriptReserved">void</span> <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">vec</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">FLARVec</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">wk_vecTridiagonalize_vec</span>;
            <span class="ActionScriptComment">// double[][] a_array=a.getArray();
</span>            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">s</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">Number</span>;
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">t</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">Number</span>;
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">p</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">Number</span>;
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">q</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">Number</span>;
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">dim</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">int</span>;

            <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptReserved">this</span>.<span class="ActionScriptDefault_Text">clm</span> <span class="ActionScriptOperator">!=</span> <span class="ActionScriptReserved">this</span>.<span class="ActionScriptDefault_Text">row</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptBracket/Brace">{</span>
                <span class="ActionScriptComment">// if(a.getClm()!=a.getRow()){
</span>                <span class="ActionScriptReserved">throw</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">FLARException</span><span class="ActionScriptBracket/Brace">()</span>;
            <span class="ActionScriptBracket/Brace">}</span>
            <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptReserved">this</span>.<span class="ActionScriptDefault_Text">clm</span> <span class="ActionScriptOperator">!=</span> <span class="ActionScriptDefault_Text">d</span>.<span class="ActionScriptDefault_Text">getClm</span><span class="ActionScriptBracket/Brace">())</span> <span class="ActionScriptBracket/Brace">{</span>
                <span class="ActionScriptComment">// if(a.getClm() != d.clm){
</span>                <span class="ActionScriptReserved">throw</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">FLARException</span><span class="ActionScriptBracket/Brace">()</span>;
            <span class="ActionScriptBracket/Brace">}</span>
            <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptReserved">this</span>.<span class="ActionScriptDefault_Text">clm</span> <span class="ActionScriptOperator">!=</span> <span class="ActionScriptDefault_Text">e</span>.<span class="ActionScriptDefault_Text">getClm</span><span class="ActionScriptBracket/Brace">())</span> <span class="ActionScriptBracket/Brace">{</span>
                <span class="ActionScriptComment">// if(a.getClm() != e.clm){
</span>                <span class="ActionScriptReserved">throw</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">FLARException</span><span class="ActionScriptBracket/Brace">()</span>;
            <span class="ActionScriptBracket/Brace">}</span>
            <span class="ActionScriptDefault_Text">dim</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">this</span>.<span class="ActionScriptDefault_Text">getClm</span><span class="ActionScriptBracket/Brace">()</span>;

            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">d_vec</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">Array</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">d</span>.<span class="ActionScriptDefault_Text">getArray</span><span class="ActionScriptBracket/Brace">()</span>;
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">e_vec</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">Array</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">e</span>.<span class="ActionScriptDefault_Text">getArray</span><span class="ActionScriptBracket/Brace">()</span>;
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">a_vec_k</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">Array</span>;

            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">k</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">int</span>;
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">i</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">int</span>;
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">j</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">int</span>;
            <span class="ActionScriptReserved">for</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">k</span> <span class="ActionScriptOperator">=</span> 0;<span class="ActionScriptDefault_Text">k</span> <span class="ActionScriptOperator">&lt;</span> <span class="ActionScriptDefault_Text">dim</span> <span class="ActionScriptOperator">-</span> 2; <span class="ActionScriptDefault_Text">k</span><span class="ActionScriptOperator">++</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptBracket/Brace">{</span>

                <span class="ActionScriptDefault_Text">a_vec_k</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">this</span>.<span class="ActionScriptDefault_Text">m</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">k</span><span class="ActionScriptBracket/Brace">]</span>;
                <span class="ActionScriptDefault_Text">vec</span>.<span class="ActionScriptDefault_Text">setNewArray</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">a_vec_k</span>, <span class="ActionScriptDefault_Text">clm</span><span class="ActionScriptBracket/Brace">)</span>;
                <span class="ActionScriptComment">// vec=this.getRowVec(k);//double[]
</span>                <span class="ActionScriptComment">// vec_array=vec.getArray();
</span>                <span class="ActionScriptDefault_Text">FLARException</span>.<span class="ActionScriptDefault_Text">trap</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">&quot;未チェックパス&quot;</span><span class="ActionScriptBracket/Brace">)</span>;
                <span class="ActionScriptDefault_Text">d_vec</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">k</span><span class="ActionScriptBracket/Brace">]</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">a_vec_k</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">k</span><span class="ActionScriptBracket/Brace">]</span>;
                <span class="ActionScriptComment">// d.v[k]=vec.v[k];//d.set(k,v.get(k));
</span>                <span class="ActionScriptComment">// //d-&gt;v[k] = v[k];
</span>
                <span class="ActionScriptComment">// wv1.clm = dim-k-1;
</span>                <span class="ActionScriptComment">// wv1.v = &amp;(v[k+1]);
</span>                <span class="ActionScriptDefault_Text">FLARException</span>.<span class="ActionScriptDefault_Text">trap</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">&quot;未チェックパス&quot;</span><span class="ActionScriptBracket/Brace">)</span>;
                <span class="ActionScriptDefault_Text">e_vec</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">k</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptDefault_Text">i_e_start</span><span class="ActionScriptBracket/Brace">]</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">vec</span>.<span class="ActionScriptDefault_Text">vecHousehold</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">k</span> <span class="ActionScriptOperator">+</span> 1<span class="ActionScriptBracket/Brace">)</span>;
                <span class="ActionScriptComment">// e.v[k+i_e_start]=vec.vecHousehold(k+1);//e-&gt;v[k]= arVecHousehold(&amp;wv1);
</span>                <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">e_vec</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">k</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptDefault_Text">i_e_start</span><span class="ActionScriptBracket/Brace">]</span> <span class="ActionScriptOperator">==</span> 0.0<span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptBracket/Brace">{</span>
                    <span class="ActionScriptComment">// if(e.v[k+i_e_start]== 0.0){//if(e.v[k+i_e_start]== 0.0){
</span>                    <span class="ActionScriptReserved">continue</span>;
                <span class="ActionScriptBracket/Brace">}</span>

                <span class="ActionScriptReserved">for</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">i</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">k</span> <span class="ActionScriptOperator">+</span> 1;<span class="ActionScriptDefault_Text">i</span> <span class="ActionScriptOperator">&lt;</span> <span class="ActionScriptDefault_Text">dim</span>; <span class="ActionScriptDefault_Text">i</span><span class="ActionScriptOperator">++</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptBracket/Brace">{</span>
                    <span class="ActionScriptDefault_Text">s</span> <span class="ActionScriptOperator">=</span> 0.0;
                    <span class="ActionScriptReserved">for</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">j</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">k</span> <span class="ActionScriptOperator">+</span> 1;<span class="ActionScriptDefault_Text">j</span> <span class="ActionScriptOperator">&lt;</span> <span class="ActionScriptDefault_Text">i</span>; <span class="ActionScriptDefault_Text">j</span><span class="ActionScriptOperator">++</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptBracket/Brace">{</span>
                        <span class="ActionScriptDefault_Text">FLARException</span>.<span class="ActionScriptDefault_Text">trap</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">&quot;未チェックのパス&quot;</span><span class="ActionScriptBracket/Brace">)</span>;
                        <span class="ActionScriptDefault_Text">s</span> <span class="ActionScriptOperator">+=</span> <span class="ActionScriptReserved">this</span>.<span class="ActionScriptDefault_Text">m</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">j</span><span class="ActionScriptBracket/Brace">][</span><span class="ActionScriptDefault_Text">i</span><span class="ActionScriptBracket/Brace">]</span> <span class="ActionScriptOperator">*</span> <span class="ActionScriptDefault_Text">a_vec_k</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">j</span><span class="ActionScriptBracket/Brace">]</span>;<span class="ActionScriptComment">// s += a_array[j][i] *vec.v[j];//s +=a.get(j*dim+i) *v.get(j);//s +=a-&gt;m[j*dim+i] * v[j];
</span>                    <span class="ActionScriptBracket/Brace">}</span>
                    <span class="ActionScriptReserved">for</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">j</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">i</span>;<span class="ActionScriptDefault_Text">j</span> <span class="ActionScriptOperator">&lt;</span> <span class="ActionScriptDefault_Text">dim</span>; <span class="ActionScriptDefault_Text">j</span><span class="ActionScriptOperator">++</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptBracket/Brace">{</span>
                        <span class="ActionScriptDefault_Text">FLARException</span>.<span class="ActionScriptDefault_Text">trap</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">&quot;未チェックのパス&quot;</span><span class="ActionScriptBracket/Brace">)</span>;
                        <span class="ActionScriptDefault_Text">s</span> <span class="ActionScriptOperator">+=</span> <span class="ActionScriptReserved">this</span>.<span class="ActionScriptDefault_Text">m</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">i</span><span class="ActionScriptBracket/Brace">][</span><span class="ActionScriptDefault_Text">j</span><span class="ActionScriptBracket/Brace">]</span> <span class="ActionScriptOperator">*</span> <span class="ActionScriptDefault_Text">a_vec_k</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">j</span><span class="ActionScriptBracket/Brace">]</span>;<span class="ActionScriptComment">// s += a_array[i][j] *vec.v[j];//s +=a.get(i*dim+j) *v.get(j);//s +=a-&gt;m[i*dim+j] * v[j];
</span>                    <span class="ActionScriptBracket/Brace">}</span>
                    <span class="ActionScriptDefault_Text">FLARException</span>.<span class="ActionScriptDefault_Text">trap</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">&quot;未チェックのパス&quot;</span><span class="ActionScriptBracket/Brace">)</span>;
                    <span class="ActionScriptDefault_Text">d_vec</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">i</span><span class="ActionScriptBracket/Brace">]</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">s</span>;<span class="ActionScriptComment">// d.v[i]=s;//d-&gt;v[i] = s;
</span>                <span class="ActionScriptBracket/Brace">}</span>

                <span class="ActionScriptComment">// wv1.clm = wv2.clm = dim-k-1;
</span>                <span class="ActionScriptComment">// wv1.v = &amp;(v[k+1]);
</span>                <span class="ActionScriptComment">// wv2.v = &amp;(d-&gt;v[k+1]);
</span>                <span class="ActionScriptDefault_Text">a_vec_k</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">this</span>.<span class="ActionScriptDefault_Text">m</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">k</span><span class="ActionScriptBracket/Brace">]</span>;
                <span class="ActionScriptDefault_Text">vec</span>.<span class="ActionScriptDefault_Text">setNewArray</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">a_vec_k</span>, <span class="ActionScriptDefault_Text">clm</span><span class="ActionScriptBracket/Brace">)</span>;
                <span class="ActionScriptComment">// vec=this.getRowVec(k);
</span>                <span class="ActionScriptComment">// vec_array=vec.getArray();
</span>                <span class="ActionScriptDefault_Text">FLARException</span>.<span class="ActionScriptDefault_Text">trap</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">&quot;未チェックパス&quot;</span><span class="ActionScriptBracket/Brace">)</span>;
                <span class="ActionScriptDefault_Text">t</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">vec</span>.<span class="ActionScriptDefault_Text">vecInnerproduct</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">d</span>, <span class="ActionScriptDefault_Text">k</span> <span class="ActionScriptOperator">+</span> 1<span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptOperator">/</span> 2;
                <span class="ActionScriptReserved">for</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">i</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">dim</span> <span class="ActionScriptOperator">-</span> 1;<span class="ActionScriptDefault_Text">i</span> <span class="ActionScriptOperator">&gt;</span> <span class="ActionScriptDefault_Text">k</span>; <span class="ActionScriptDefault_Text">i</span><span class="ActionScriptOperator">--</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptBracket/Brace">{</span>
                    <span class="ActionScriptDefault_Text">FLARException</span>.<span class="ActionScriptDefault_Text">trap</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">&quot;未チェックパス&quot;</span><span class="ActionScriptBracket/Brace">)</span>;
                    <span class="ActionScriptDefault_Text">p</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">a_vec_k</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">i</span><span class="ActionScriptBracket/Brace">]</span>;
                    <span class="ActionScriptComment">// p = v.get(i);//p = v[i];
</span>                    <span class="ActionScriptDefault_Text">d_vec</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">i</span><span class="ActionScriptBracket/Brace">]</span> <span class="ActionScriptOperator">-=</span> <span class="ActionScriptDefault_Text">t</span> <span class="ActionScriptOperator">*</span> <span class="ActionScriptDefault_Text">p</span>;
                    <span class="ActionScriptDefault_Text">q</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">d_vec</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">i</span><span class="ActionScriptBracket/Brace">]</span>;
                    <span class="ActionScriptComment">// d.v[i]-=t*p;q=d.v[i];//q = d-&gt;v[i] -= t*p；
</span>                    <span class="ActionScriptReserved">for</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">j</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">i</span>;<span class="ActionScriptDefault_Text">j</span> <span class="ActionScriptOperator">&lt;</span> <span class="ActionScriptDefault_Text">dim</span>; <span class="ActionScriptDefault_Text">j</span><span class="ActionScriptOperator">++</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptBracket/Brace">{</span>
                        <span class="ActionScriptDefault_Text">FLARException</span>.<span class="ActionScriptDefault_Text">trap</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">&quot;未チェックパス&quot;</span><span class="ActionScriptBracket/Brace">)</span>;
                        <span class="ActionScriptReserved">this</span>.<span class="ActionScriptDefault_Text">m</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">i</span><span class="ActionScriptBracket/Brace">][</span><span class="ActionScriptDefault_Text">j</span><span class="ActionScriptBracket/Brace">]</span> <span class="ActionScriptOperator">-=</span> <span class="ActionScriptDefault_Text">p</span> <span class="ActionScriptOperator">*</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">d_vec</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">j</span><span class="ActionScriptBracket/Brace">]</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptDefault_Text">q</span> <span class="ActionScriptOperator">*</span> <span class="ActionScriptDefault_Text">a_vec_k</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">j</span><span class="ActionScriptBracket/Brace">])</span>;<span class="ActionScriptComment">// a.m[i][j]-=p*(d.v[j] +q*vec.v[j]);//a-&gt;m[i*dim+j] -=p*(d-&gt;v[j]) + q*v[j];
</span>                    <span class="ActionScriptBracket/Brace">}</span>
                <span class="ActionScriptBracket/Brace">}</span>
            <span class="ActionScriptBracket/Brace">}</span>

            <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">dim</span> <span class="ActionScriptOperator">&gt;=</span> 2<span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptBracket/Brace">{</span>
                <span class="ActionScriptDefault_Text">d_vec</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">dim</span> <span class="ActionScriptOperator">-</span> 2<span class="ActionScriptBracket/Brace">]</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">this</span>.<span class="ActionScriptDefault_Text">m</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">dim</span> <span class="ActionScriptOperator">-</span> 2<span class="ActionScriptBracket/Brace">][</span><span class="ActionScriptDefault_Text">dim</span> <span class="ActionScriptOperator">-</span> 2<span class="ActionScriptBracket/Brace">]</span>;
                <span class="ActionScriptComment">// d.v[dim-2]=a.m[dim-2][dim-2];//d-&gt;v[dim-2]=a-&gt;m[(dim-2)*dim+(dim-2)];
</span>                <span class="ActionScriptDefault_Text">e_vec</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">dim</span> <span class="ActionScriptOperator">-</span> 2 <span class="ActionScriptOperator">+</span> <span class="ActionScriptDefault_Text">i_e_start</span><span class="ActionScriptBracket/Brace">]</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">this</span>.<span class="ActionScriptDefault_Text">m</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">dim</span> <span class="ActionScriptOperator">-</span> 2<span class="ActionScriptBracket/Brace">][</span><span class="ActionScriptDefault_Text">dim</span> <span class="ActionScriptOperator">-</span> 1<span class="ActionScriptBracket/Brace">]</span>;<span class="ActionScriptComment">// e.v[dim-2+i_e_start]=a.m[dim-2][dim-1];//e-&gt;v[dim-2] = a-&gt;m[(dim-2)*dim+(dim-1)];
</span>            <span class="ActionScriptBracket/Brace">}</span>

            <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">dim</span> <span class="ActionScriptOperator">&gt;=</span> 1<span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptBracket/Brace">{</span>
                <span class="ActionScriptDefault_Text">d_vec</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">dim</span> <span class="ActionScriptOperator">-</span> 1<span class="ActionScriptBracket/Brace">]</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">this</span>.<span class="ActionScriptDefault_Text">m</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">dim</span> <span class="ActionScriptOperator">-</span> 1<span class="ActionScriptBracket/Brace">][</span><span class="ActionScriptDefault_Text">dim</span> <span class="ActionScriptOperator">-</span> 1<span class="ActionScriptBracket/Brace">]</span>;<span class="ActionScriptComment">// d.v[dim-1]=a_array[dim-1][dim-1];//d-&gt;v[dim-1] =a-&gt;m[(dim-1)*dim+(dim-1)];
</span>            <span class="ActionScriptBracket/Brace">}</span>
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">vec2</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">FLARVec</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">this</span>.<span class="ActionScriptDefault_Text">wk_vecTridiagonalize_vec2</span>;
            <span class="ActionScriptReserved">for</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">k</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">dim</span> <span class="ActionScriptOperator">-</span> 1;<span class="ActionScriptDefault_Text">k</span> <span class="ActionScriptOperator">&gt;=</span> 0; <span class="ActionScriptDefault_Text">k</span><span class="ActionScriptOperator">--</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptBracket/Brace">{</span>
                <span class="ActionScriptDefault_Text">a_vec_k</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">this</span>.<span class="ActionScriptDefault_Text">m</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">k</span><span class="ActionScriptBracket/Brace">]</span>;
                <span class="ActionScriptDefault_Text">vec</span>.<span class="ActionScriptDefault_Text">setNewArray</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">a_vec_k</span>, <span class="ActionScriptDefault_Text">clm</span><span class="ActionScriptBracket/Brace">)</span>;
                <span class="ActionScriptComment">// vec=this.getRowVec(k);//v =a.getPointer(k*dim);//v = &amp;(a-&gt;m[k*dim]);
</span>                <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">k</span> <span class="ActionScriptOperator">&lt;</span> <span class="ActionScriptDefault_Text">dim</span> <span class="ActionScriptOperator">-</span> 2<span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptBracket/Brace">{</span>
                    <span class="ActionScriptReserved">for</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">i</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">k</span> <span class="ActionScriptOperator">+</span> 1;<span class="ActionScriptDefault_Text">i</span> <span class="ActionScriptOperator">&lt;</span> <span class="ActionScriptDefault_Text">dim</span>; <span class="ActionScriptDefault_Text">i</span><span class="ActionScriptOperator">++</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptBracket/Brace">{</span>
                        <span class="ActionScriptComment">// wv1.clm = wv2.clm = dim-k-1;
</span>                        <span class="ActionScriptComment">// wv1.v = &amp;(v[k+1]);
</span>                        <span class="ActionScriptComment">// wv2.v = &amp;(a-&gt;m[i*dim+k+1]);
</span>                        <span class="ActionScriptDefault_Text">vec2</span>.<span class="ActionScriptDefault_Text">setNewArray</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptReserved">this</span>.<span class="ActionScriptDefault_Text">m</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">i</span><span class="ActionScriptBracket/Brace">]</span>, <span class="ActionScriptDefault_Text">clm</span><span class="ActionScriptBracket/Brace">)</span>;
                        <span class="ActionScriptComment">// vec2=this.getRowVec(i);
</span>
                        <span class="ActionScriptDefault_Text">t</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">vec</span>.<span class="ActionScriptDefault_Text">vecInnerproduct</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">vec2</span>, <span class="ActionScriptDefault_Text">k</span> <span class="ActionScriptOperator">+</span> 1<span class="ActionScriptBracket/Brace">)</span>;
                        <span class="ActionScriptReserved">for</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">j</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">k</span> <span class="ActionScriptOperator">+</span> 1;<span class="ActionScriptDefault_Text">j</span> <span class="ActionScriptOperator">&lt;</span> <span class="ActionScriptDefault_Text">dim</span>; <span class="ActionScriptDefault_Text">j</span><span class="ActionScriptOperator">++</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptBracket/Brace">{</span>
                            <span class="ActionScriptDefault_Text">FLARException</span>.<span class="ActionScriptDefault_Text">trap</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">&quot;未チェックパス&quot;</span><span class="ActionScriptBracket/Brace">)</span>;
                            <span class="ActionScriptReserved">this</span>.<span class="ActionScriptDefault_Text">m</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">i</span><span class="ActionScriptBracket/Brace">][</span><span class="ActionScriptDefault_Text">j</span><span class="ActionScriptBracket/Brace">]</span> <span class="ActionScriptOperator">-=</span> <span class="ActionScriptDefault_Text">t</span> <span class="ActionScriptOperator">*</span> <span class="ActionScriptDefault_Text">a_vec_k</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">j</span><span class="ActionScriptBracket/Brace">]</span>;<span class="ActionScriptComment">// a_array[i][j]-=t*vec.v[j];//a.subValue(i*dim+j,t*v.get(j));//a-&gt;m[i*dim+j]-= t * v[j];
</span>                        <span class="ActionScriptBracket/Brace">}</span>
                    <span class="ActionScriptBracket/Brace">}</span>
                <span class="ActionScriptBracket/Brace">}</span>
                <span class="ActionScriptReserved">for</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">i</span> <span class="ActionScriptOperator">=</span> 0;<span class="ActionScriptDefault_Text">i</span> <span class="ActionScriptOperator">&lt;</span> <span class="ActionScriptDefault_Text">dim</span>; <span class="ActionScriptDefault_Text">i</span><span class="ActionScriptOperator">++</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptBracket/Brace">{</span>
                    <span class="ActionScriptDefault_Text">a_vec_k</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">i</span><span class="ActionScriptBracket/Brace">]</span> <span class="ActionScriptOperator">=</span> 0.0;<span class="ActionScriptComment">// v.set(i,0.0);//v[i] = 0.0;
</span>                <span class="ActionScriptBracket/Brace">}</span>
                <span class="ActionScriptDefault_Text">a_vec_k</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">k</span><span class="ActionScriptBracket/Brace">]</span> <span class="ActionScriptOperator">=</span> 1;<span class="ActionScriptComment">// v.set(k,1);//v[k] = 1;
</span>            <span class="ActionScriptBracket/Brace">}</span>
            <span class="ActionScriptReserved">return</span>;
        <span class="ActionScriptBracket/Brace">}</span>
    <span class="ActionScriptBracket/Brace">}</span>
<span class="ActionScriptBracket/Brace">}</span></pre></body>
</html>
